(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39329,e=>{"use strict";e.s(["default",()=>ey],39329);var t=e.i(43476),l=e.i(71645),n=e.i(35492),a=e.i(87940),i=e.i(88274);let s=[{key:"auth",label:"Login / Logout",icon:"/icons/login.png"},{key:"project",label:"Project",icon:"/icons/files.png"},{key:"trusses",label:"Trusses",icon:"/icons/roof.png"},{key:"wallpanels",label:"Wall Panels",icon:"/icons/wood.png"},{key:"loose",label:"Loose Material",icon:"/icons/loose.png"},{key:"labor",label:"Labor",icon:"/icons/worker.png"},{key:"summary",label:"Summary",icon:"/icons/search.png"},{key:"takeoff",label:"Takeoff list",icon:"/icons/list.png"},{key:"quote",label:"Quote (QuickBooks)",icon:"/icons/dollar.png"},{key:"export",label:"Export",icon:"/icons/download.png"},{key:"items",label:"Material List",icon:"/icons/trolley.png"},{key:"save",label:"Save",icon:"/icons/save.png"},{key:"mode",label:"Light Mode",icon:"/icons/brightness.png"}];function r(e){let{active:n="wallpanels",collapsed:r=!1,onChange:o,onCollapsedChange:u}=e,{saveProject:c,isSaving:d,projectData:m,projectId:h}=(0,a.useProject)(),{user:p,signIn:x,signOutUser:b}=(0,i.useAuth)(),g=(0,l.useMemo)(()=>s,[]);g.filter(e=>!["save","mode","auth"].includes(e.key)).findIndex(e=>e.key===n);let v=g.findIndex(e=>e.key===n),N=!!p&&!!h&&!!m&&!d;return(0,t.jsxs)("aside",{className:"sidebar ".concat(r?"open":""),children:[(0,t.jsx)("header",{children:(0,t.jsx)("button",{type:"button",className:"sidebar-burger",onClick:()=>null==u?void 0:u(!r),title:r?"Expand":"Collapse",children:(0,t.jsx)("img",{src:"/icons/menu.png",alt:r?"Expand sidebar":"Collapse sidebar",width:24,height:24,"aria-hidden":!0})})}),(0,t.jsx)("nav",{className:"menu",style:{"--top":"".concat(6+(v>=0?56*v:0),"px")},role:"navigation","aria-label":"Main",children:g.map((e,l)=>{let a=e.key===n&&!["save","mode","auth"].includes(e.key),i=!1;"save"===e.key?i=!N:["project","wallpanels","summary"].includes(e.key)?i=!p:["auth","mode"].includes(e.key)||(i=!0);let s=!p&&!["project","auth","mode"].includes(e.key),r="save"===e.key&&!N||i||s,u=e.label;return"save"===e.key&&d&&(u="Saving..."),"auth"===e.key&&(u=p?"Logout":"Login"),(0,t.jsxs)("button",{type:"button",className:"menu-item ".concat(a?" active":""," ").concat(i?" disabled":""),onClick:()=>!i&&(e=>{if("save"===e.key){N&&c();return}return"mode"===e.key?void console.log("Toggle theme clicked"):"auth"===e.key?void(p?b():x()):void(null==o||o(e.key))})(e),title:e.label,"aria-current":a?"page":void 0,"aria-disabled":!!r||void 0,children:[(0,t.jsx)("img",{src:e.icon,alt:"",width:20,height:20,className:"menu-ico","aria-hidden":!0}),(0,t.jsx)("p",{className:"menu-label",children:u})]},e.key)})}),(0,t.jsx)("div",{className:"side-foot",style:{marginTop:"auto",textAlign:r?"center":"left",padding:r?"10px 0":"10px"},children:p&&(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:r?"center":"flex-start",gap:"8px",padding:"0 10px"},children:!r&&(0,t.jsx)("span",{className:"ew-subtle",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:p.displayName||p.email,children:p.displayName||p.email})})})]})}var o=e.i(19439);function u(e){let{onClick:l,size:n=20,title:a="Add",label:i="Add",src:s="/icons/plus.png",className:r="",disabled:o=!1}=e;return(0,t.jsx)("button",{type:"button",className:"ew-btn ew-icon-btn ".concat(r),onClick:l,"aria-label":i,title:a,disabled:o,children:(0,t.jsx)("img",{src:s,width:n,height:n,alt:""})})}function c(){return"ex-"+Math.random().toString(36).slice(2,8)+"-"+Date.now().toString(36)}let d=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function m(e){let{onTotalsChange:a,title:i="Exterior walls",levelId:s="default",onLengthLFChange:r,onPanelLenFtChange:m,isLevelOne:h=!1}=e,[p,x]=(0,n.useLocalStorageJson)("inv:v1:ex:sections:".concat(s),[{id:c()}]),[b,g]=(0,l.useState)({}),v=()=>x(e=>[...e,{id:c()}]),N=(0,l.useCallback)(e=>{e&&e.id&&g(t=>{let l=t[e.id];return l&&l.lengthLF===e.lengthLF&&l.zipSheetsFinal===e.zipSheetsFinal&&l.platePieces===e.platePieces&&l.ptLF===e.ptLF&&l.groupSubtotal===e.groupSubtotal&&l.bottomBoardLenFt===e.bottomBoardLenFt?t:{...t,[e.id]:e}})},[]),y=(0,l.useMemo)(()=>{let e=Object.values(b),t=e.reduce((e,t)=>e+(Number(t.lengthLF)||0),0),l=e.reduce((e,t)=>e+(Number(t.zipSheetsFinal)||0),0),n=e.reduce((e,t)=>e+(Number(t.panelSheets)||0),0),a=e.reduce((e,t)=>e+(Number(t.platePieces)||0),0),i=e.reduce((e,t)=>e+(Number(t.bottomPlatePiecesPanel)||0),0),s=e.reduce((e,t)=>e+(Number(t.ptLF)||0),0),r=e.reduce((e,t)=>e+(Number(t.groupSubtotal)||0),0);return{extLengthSum:t,extZipSheetsSum:l,extPanelSheets:n,extZipSheetsFinal:l,extPlatePieces:a,extBottomPlatePiecesPanel:i,extPTLFSum:s,extMoneySum:r,panelsSubtotal:e.reduce((e,t)=>e+(Number(t.groupSubtotal)||0),0),extPanelPtBoards:e.reduce((e,t)=>e+(Number(t.panelPtBoards)||0),0)}},[b]),w=(0,l.useMemo)(()=>{let e=Object.values(b).map(e=>Number(e.bottomBoardLenFt)||0).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[b]),j=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e;let t={...y,panelLenFtExterior:w};t===(e=j.current)||t&&e&&t.extLengthSum===e.extLengthSum&&t.extZipSheetsSum===e.extZipSheetsSum&&t.extPanelSheets===e.extPanelSheets&&t.extPlatePieces===e.extPlatePieces&&t.extBottomPlatePiecesPanel===e.extBottomPlatePiecesPanel&&t.extPTLFSum===e.extPTLFSum&&t.extMoneySum===e.extMoneySum&&t.panelsSubtotal===e.panelsSubtotal&&t.panelLenFtExterior===e.panelLenFtExterior&&t.extPanelPtBoards===e.extPanelPtBoards||(j.current=t,null==a||a(t),null==r||r(y.extLengthSum),null==m||m(w))},[y,w,a,r,m]);let f=y.panelsSubtotal,P={fontFamily:"'Nova Mono', monospace"};return(0,t.jsxs)("section",{className:"ew-stack",children:[(0,t.jsxs)("div",{className:"ew-card",style:{marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem"},children:[(0,t.jsx)("h2",{className:"ew-h2",style:{...P,margin:0,flexShrink:0},children:i}),(0,t.jsxs)("div",{className:"ew-right",title:"Sum of all exterior wall section subtotals for this level",style:{...P,fontWeight:700},children:["Total: ",Number.isFinite(Number(f))?d.format(Number(f)):"—"]})]}),0===p.length&&(0,t.jsxs)("div",{className:"ew-card",children:[(0,t.jsx)("div",{className:"ew-subtle",children:"No exterior wall sections yet."}),(0,t.jsx)("div",{style:{marginTop:8},children:(0,t.jsx)("button",{className:"ew-btn ew-btn--turq",onClick:v,children:"+ Add exterior wall section"})})]}),p.map((e,l)=>(0,t.jsx)(o.default,{persistKey:"exterior:".concat(e.id),title:"Exterior walls — section ".concat(l+1),onRemove:()=>{var t;return t=e.id,void(x(e=>e.filter(e=>e.id!==t)),g(e=>{let l={...e};return delete l[t],l}))},onStatsChange:N,bottomDefaultFamily:h?"PT":"SPF#2"},e.id)),(0,t.jsxs)("div",{className:"ew-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"1rem"},children:[(0,t.jsx)("div",{className:"ew-subtle",children:"Add another exterior wall section to this level."}),(0,t.jsx)(u,{onClick:v,title:"Add Section",label:"Add Section"})]})]})}var h=e.i(6279),p=e.i(34336),x=e.i(64688);e.i(74469);var b=e.i(84959),g=e.i(40290),v=e.i(4071),N=e.i(18736),y=e.i(67340),w=e.i(53576),j=e.i(38873),f=e.i(21586),P=e.i(58057);let S=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),L=e=>Number.isFinite(Number(e))?S.format(Number(e)):"—",F=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,l=String(e).trim().split(/\s+/),n=l.slice(0,t).join(" ");return l.length>t?"".concat(n,"…"):n||""},k=e=>e&&e.item?k(e.item):e,B=e=>k(e),C=e=>{var t,l,n;return(null==(t=k(e))?void 0:t.unit)||(null==(n=k(e))||null==(l=n.raw)?void 0:l.unit)||"pcs"},M=e=>{var t,l,n,a;return(null==(t=k(e))?void 0:t.sizeDisplay)||(null==(l=k(e))?void 0:l.sizeLabel)||(null==(a=k(e))||null==(n=a.raw)?void 0:n.sizeDisplay)||""},T=e=>{var t,l,n,a,i;return(null==(l=k(e))||null==(t=l.raw)?void 0:t.familyDisplay)||(null==(n=k(e))?void 0:n.familyDisplay)||(null==(i=k(e))||null==(a=i.raw)?void 0:a.family)||(null==e?void 0:e.familyLabel)||""};function I(e){var a,i,s,r,o,u,c,d,m;let{onStatsChange:S,title:k="Interior walls",onRemove:I,persistKey:q="interior-0",bottomDefaultFamily:W="SPF#2"}=e,[E,D]=(0,l.useState)("partition"),[A,R]=(0,l.useState)(0),[O,z]=(0,l.useState)(String(A)),[U,V]=(0,l.useState)(12),[H,K]=(0,l.useState)(16),[G,Q]=(0,l.useState)(1),[_,Z]=(0,l.useState)({bottomPlate:10,topPlate:10,studs:60,blocking:10,sheathing:20}),[J,$]=(0,l.useState)({bottomPlate:null,topPlate:null,studs:null,blocking:null,sheathing:null}),[X,Y]=(0,n.useLocalStorageJson)("inv:v1:notes:".concat(q),{}),ee=e=>X[e]||{plan:"",comment:"",open:!1},et=(e,t)=>Y(l=>({...l,[e]:{...ee(e),...t}})),el=e=>et(e,{open:!ee(e).open}),en=null!=(o=(0,f.parseBoardLengthFt)(M(J.bottomPlate)))?o:0,ea=Number.isFinite(en)?en:0,ei=null!=(u=(0,f.parseBoardLengthFt)(M(J.topPlate)))?u:12,es=null!=(c=(0,f.parseBoardLengthFt)(M(J.blocking)))?c:12,er="bearing"===E,eo="shear"===E;(0,l.useEffect)(()=>{z(String(A))},[A]);let eu=()=>{R(Number(O)||0)},ec=(0,l.useMemo)(()=>{var e,t,l,n,a,i,s,r,o,u;let c=[];{let l=(0,b.calcPlates)({lengthLF:A,boardLenFt:en,wastePct:null!=(e=_.bottomPlate)?e:0,item:B(J.bottomPlate),unit:C(J.bottomPlate)});c.push({key:"bottomPlate",label:"Bottom plate",item:B(J.bottomPlate),unit:l.unit,qtyRaw:l.qtyRaw,qtyFinal:l.qtyFinal,unitPrice:l.unitPrice,subtotal:l.subtotal,wastePct:null!=(t=_.bottomPlate)?t:0,boardLenFt:l.boardLenFt})}{let e=(0,b.calcPlates)({lengthLF:A,boardLenFt:ei,wastePct:null!=(l=_.topPlate)?l:0,item:B(J.topPlate),unit:C(J.topPlate)});c.push({key:"topPlate",label:"Top plate",item:B(J.topPlate),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(n=_.topPlate)?n:0})}{let e=(0,g.calcStuds)({lengthLF:A,spacingIn:H,multiplier:G,wastePct:null!=(a=_.studs)?a:0,item:B(J.studs),unit:C(J.studs)});c.push({key:"studs",label:"Studs",item:B(J.studs),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(i=_.studs)?i:0})}if(er){let e=(0,v.calcBlocking)({lengthLF:A,heightFt:U,boardLenFt:es,wastePct:null!=(s=_.blocking)?s:0,item:B(J.blocking),unit:C(J.blocking)});c.push({key:"blocking",label:"Blocking",item:B(J.blocking),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(r=_.blocking)?r:0})}if(eo){let e=(0,N.calcSheathing)({lengthLF:A,heightFt:U,wastePct:null!=(o=_.sheathing)?o:0,item:B(J.sheathing),unit:C(J.sheathing)||"sheet"});c.push({key:"sheathing",label:"Sheathing (4x8)",item:B(J.sheathing),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(u=_.sheathing)?u:0})}return c},[J,_,er,eo,A,U,H,G,en,ei,es]),ed=(0,l.useMemo)(()=>Object.fromEntries((ec||[]).map(e=>[e.key,e])),[ec]),em=(0,l.useMemo)(()=>{if(!eo)return 0;let e=ec.find(e=>"sheathing"===e.key);return Math.ceil(Number((null==e?void 0:e.qtyFinal)||0))},[ec,eo]),eh=(0,l.useMemo)(()=>{var e;let t,l=(t=T(J.bottomPlate),/(^|\b)pt(\b|$)|pressure/i.test(String(t||""))),n=Math.ceil(Number((null==(e=ed.bottomPlate)?void 0:e.qtyFinal)||0));return l?n:0},[J.bottomPlate,null==(a=ed.bottomPlate)?void 0:a.qtyFinal]),ep=(null!=(d=null==(i=ed.bottomPlate)?void 0:i.qtyFinal)?d:0)+(null!=(m=null==(s=ed.topPlate)?void 0:s.qtyFinal)?m:0),ex=Number(A||0),eb=M(J.studs)||M(J.bottomPlate)||"",eg=/(^|\D)2\s*[x×]\s*6(\D|$)/i.test(eb)?"int-2x6":"int-2x4",[ev,eN]=(0,l.useState)([]),ey=(0,l.useRef)(1),ew=e=>eN(t=>[...t,{id:"x".concat(ey.current++),type:e,item:null,wastePct:5,inputs:{}}]),ej=(e,t)=>eN(l=>l.map(l=>l.id===e?{...l,...t}:l));(0,l.useEffect)(()=>{let e=ev.filter(e=>"Header"===e.type&&(0,P.isInfillFamily)(T(e))).reduce((e,t)=>e+Number(t.inputs.headerLF||0),0),t=ev.some(e=>"Headers infill"===e.type);e>0&&!t&&eN(e=>[...e,{id:"infill",type:"Headers infill",item:null,wastePct:5,inputs:{}}]),0===e&&t&&eN(e=>e.filter(e=>"Headers infill"!==e.type))},[JSON.stringify(ev.map(e=>({t:e.type,f:T(e),lf:e.inputs.headerLF||0})))]);let ef=(0,l.useMemo)(()=>{let e=ev.filter(e=>"Header"===e.type&&(0,P.isInfillFamily)(T(e))).reduce((e,t)=>{var l;return e+Number((null==t||null==(l=t.inputs)?void 0:l.headerLF)||0)},0);return ev.map(t=>{var l,n,a,i,s,r,o,u,c,d,m,h,p,x,g;let v=T(t),S=null!=(l=(0,f.parseBoardLengthFt)(M(t)))?l:0;if("Header"===t.type){let e=(0,y.calcHeader)({isLVL:(0,P.isLVL)(v),headerLF:Number((null==t||null==(n=t.inputs)?void 0:n.headerLF)||0),lvlPieces:Number((null==t||null==(a=t.inputs)?void 0:a.lvlPieces)||0),lvlLength:Number((null==t||null==(i=t.inputs)?void 0:i.lvlLength)||0),boardLenFt:S,wastePct:null!=(s=t.wastePct)?s:5,item:B(t)});return{...t,unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,boardLenFt:S}}if("Extra blocking"===t.type){let e=Math.max(1,Number((null==t||null==(r=t.inputs)?void 0:r.rows)||1)),l=(0,b.calcPlates)({lengthLF:Number(A||0)*e,boardLenFt:S,wastePct:null!=(o=t.wastePct)?o:10,item:B(t),unit:C(t)});return{...t,unit:l.unit,qtyRaw:l.qtyRaw,qtyFinal:l.qtyFinal,unitPrice:l.unitPrice,subtotal:l.subtotal,boardLenFt:S}}if("Extra sheathing"===t.type){let e=(0,N.calcSheathing)({lengthLF:A,heightFt:U,wastePct:null!=(u=t.wastePct)?u:5,item:B(t),unit:C(t)||"sheet"});return{...t,unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,boardLenFt:null}}if("Post"===t.type){let e=(0,w.calcPost)({isLinearLF:(0,P.isLVL)(v)||(0,P.isVersaColumn)(v),pieces:Number((null==t||null==(c=t.inputs)?void 0:c.pieces)||0),heightFt:Number(null!=(p=null==t||null==(d=t.inputs)?void 0:d.heightFt)?p:U),piecesPerPost:Number((null==t||null==(m=t.inputs)?void 0:m.piecesPerPost)||0),numPosts:Number((null==t||null==(h=t.inputs)?void 0:h.numPosts)||0),wastePct:null!=(x=t.wastePct)?x:5,item:B(t)});return{...t,unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,boardLenFt:S}}if("Headers infill"===t.type){let l=(0,j.calcHeadersInfill)({headerLFPool:e,wastePct:null!=(g=t.wastePct)?g:5,item:B(t)});return{...t,unit:l.unit,qtyRaw:l.qtyRaw,qtyFinal:l.qtyFinal,unitPrice:l.unitPrice,subtotal:l.subtotal,boardLenFt:null}}return t})},[ev,U,A]),eP=(0,l.useMemo)(()=>ec.reduce((e,t)=>e+(t.subtotal||0),0)+ef.reduce((e,t)=>e+(t.subtotal||0),0),[ec,ef]),eS=(0,l.useRef)("");(0,l.useEffect)(()=>{var e;let t={id:q,kind:eg,lengthLF:Number(A||0),platePieces:Math.ceil(ep),bottomPlatePiecesPanel:Math.ceil((null==(e=ed.bottomPlate)?void 0:e.qtyFinal)||0),ptLF:ex,groupSubtotal:eP,isShear:"shear"===E,isBearing:"bearing"===E,isPartition:"partition"===E,isKnee:"knee"===E,bottomBoardLenFt:ea,panelPtBoards:eh,panelSheets:em},l=JSON.stringify(t);l!==eS.current&&(eS.current=l,null==S||S(t))},[q,E,eg,eh,em,A,ep,null==(r=ed.bottomPlate)?void 0:r.qtyFinal,ex,eP,ea,S]);let eL="minmax(180px,1.1fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr";return(0,t.jsx)("div",{className:"ew-card",children:(0,t.jsxs)(p.default,{title:k,defaultOpen:!0,summary:(0,t.jsxs)("div",{style:{textAlign:"right",fontWeight:700,color:"#f18d5b"},children:["Subtotal: ",L(eP)]}),actions:I?(0,t.jsx)(x.default,{onClick:I,title:"Remove section",label:"Remove section"}):null,children:[(0,t.jsxs)("div",{className:"controls4",style:{marginBottom:8},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Length (LF)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:O,onChange:e=>z(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(eu(),e.target.blur())},onBlur:eu})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Height (ft)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:U,onChange:e=>V(Number(e.target.value))})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Stud spacing (in)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:H,onChange:e=>K(Number(e.target.value))})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Studs per location"}),(0,t.jsxs)("select",{className:"ew-select focus-anim",value:G,onChange:e=>Q(Number(e.target.value)),children:[(0,t.jsx)("option",{value:1,children:"Single"}),(0,t.jsx)("option",{value:2,children:"Double"}),(0,t.jsx)("option",{value:3,children:"Triple"}),(0,t.jsx)("option",{value:4,children:"Quad"})]})]})]}),(0,t.jsx)("div",{className:"controls2",style:{marginBottom:12},children:(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Wall kind"}),(0,t.jsxs)("select",{className:"ew-select focus-anim",value:E,onChange:e=>D(e.target.value),children:[(0,t.jsx)("option",{value:"partition",children:"Partition"}),(0,t.jsx)("option",{value:"bearing",children:"Bearing (adds blocking)"}),(0,t.jsx)("option",{value:"shear",children:"Shear (adds sheathing)"}),(0,t.jsx)("option",{value:"knee",children:"Knee"})]})]})}),(0,t.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":eL},children:[(0,t.jsx)("div",{children:"Item"}),(0,t.jsx)("div",{children:"Vendor · Family · Size"}),(0,t.jsx)("div",{className:"ew-right",children:"Qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,t.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,t.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,t.jsx)("div",{children:"Notes"}),(0,t.jsx)("div",{})]}),(0,t.jsx)("div",{className:"ew-rows",children:ec.map(e=>{let n,a="base:".concat(e.key),i=ee(a);return(0,t.jsxs)(l.Fragment,{children:[(0,t.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":eL},children:[(0,t.jsx)("div",{children:e.label}),(0,t.jsx)("div",{children:(0,t.jsx)(h.default,{compact:!0,onSelect:(n=e.key,e=>$(t=>({...t,[n]:e}))),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"sheathing"===e.key?"CDX SE":"bottomPlate"===e.key?W:"SPF#2",defaultSizeLabel:"sheathing"===e.key?"4x8'-1/2\"":void 0,preferredSeries:"sheathing"===e.key?void 0:"2x6"})}),(0,t.jsx)("div",{className:"ew-right",children:Math.ceil(e.qtyRaw)}),(0,t.jsx)("div",{className:"ew-right",children:(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:e.wastePct,onChange:t=>Z(l=>({...l,[e.key]:Number(t.target.value)})),style:{width:80,padding:6,textAlign:"right"}})}),(0,t.jsx)("div",{className:"ew-right",children:e.qtyFinal}),(0,t.jsx)("div",{className:"ew-right",children:e.unit}),(0,t.jsx)("div",{className:"ew-right ew-money",children:e.unitPrice?L(e.unitPrice):"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:e.subtotal?L(e.subtotal):"—"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"ew-subtle",style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[(0,t.jsx)("span",{className:"ew-chip",title:i.plan||"",children:i.plan||"—"}),(0,t.jsx)("button",{className:"ew-btn",style:{padding:"4px 8px"},onClick:()=>el(a),children:i.open?"Hide":"Notes"})]}),i.comment&&(0,t.jsx)("div",{className:"ew-subtle",title:i.comment,children:F(i.comment)})]}),(0,t.jsx)("div",{})]}),i.open&&(0,t.jsx)("div",{className:"ew-row",style:{padding:12},children:(0,t.jsxs)("div",{className:"controls2",style:{width:"100%"},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Plan label"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"text",placeholder:"e.g., A2.4 / S5 – Detail 03",value:ee(a).plan,onChange:e=>et(a,{plan:e.target.value})})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Comment"}),(0,t.jsx)("textarea",{className:"ew-input focus-anim",rows:3,placeholder:"Add any notes for this item…",value:ee(a).comment,onChange:e=>et(a,{comment:e.target.value})})]})]})})]},e.key)})}),(0,t.jsx)("h3",{className:"ew-h3",style:{marginTop:12,marginBottom:6},children:"Extras"}),(0,t.jsx)("div",{className:"ew-rows",children:ef.map(e=>{var n,a,i,s,r,o,u,c,d,m,p,b;let g="extra:".concat(e.id);return(0,t.jsxs)(l.Fragment,{children:[(0,t.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":eL},children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontWeight:600},children:e.type}),"Headers infill"!==e.type&&(0,t.jsx)(x.default,{onClick:()=>{let t;return t=e.id,eN(e=>e.filter(e=>e.id!==t))},title:"Remove ".concat(e.type),label:"Remove ".concat(e.type)})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.default,{compact:!0,onSelect:t=>ej(e.id,{item:t}),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"Headers infill"===e.type||"Extra sheathing"===e.type?"CDX SE":"SPF#2",defaultSizeLabel:"Extra sheathing"===e.type?"4x8'-1/2\"":void 0}),"Header"===e.type&&((0,P.isLVL)(T(e))?(0,t.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end"},children:[(0,t.jsxs)("label",{style:{minWidth:120},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Pieces"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(n=e.inputs)?void 0:n.lvlPieces)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,lvlPieces:Number(t.target.value)}})})]}),(0,t.jsxs)("label",{style:{minWidth:140},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Length (lf)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(a=e.inputs)?void 0:a.lvlLength)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,lvlLength:Number(t.target.value)}})})]})]}):(0,t.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end"},children:[(0,t.jsxs)("label",{style:{minWidth:160},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Total header LF"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(i=e.inputs)?void 0:i.headerLF)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,headerLF:Number(t.target.value)}})})]}),(0,t.jsxs)("div",{className:"ew-hint",children:["Board length from size: ",e.boardLenFt||(0,f.parseBoardLengthFt)(M(e))||"—"," ft"]})]})),"Post"===e.type&&((0,P.isLVL)(T(e))||(0,P.isVersaColumn)(T(e))?(0,t.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end"},children:[(0,t.jsxs)("label",{style:{minWidth:120},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Pieces"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(s=e.inputs)?void 0:s.pieces)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,pieces:Number(t.target.value)}})})]}),(0,t.jsxs)("label",{style:{minWidth:140},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Height (ft)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:null!=(d=null==(r=e.inputs)?void 0:r.heightFt)?d:U,onChange:t=>ej(e.id,{inputs:{...e.inputs,heightFt:Number(t.target.value)}})})]})]}):(0,P.isLumberFamily)(T(e))?(0,t.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end"},children:[(0,t.jsxs)("label",{style:{minWidth:160},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Pieces per post"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(o=e.inputs)?void 0:o.piecesPerPost)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,piecesPerPost:Number(t.target.value)}})})]}),(0,t.jsxs)("label",{style:{minWidth:140},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Posts (#)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(u=e.inputs)?void 0:u.numPosts)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,numPosts:Number(t.target.value)}})})]})]}):null),"Headers infill"===e.type&&(0,t.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:"QTY = Σ Header LF ÷ 3 ÷ 32 × 2 (then waste)"}),"Extra sheathing"===e.type&&(0,t.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:"Same math as regular sheathing (length × height ÷ 32), then waste."}),"Extra blocking"===e.type&&(0,t.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end",gap:12},children:[(0,t.jsxs)("label",{style:{minWidth:140},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Rows (#)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",min:1,step:1,value:(null==(c=e.inputs)?void 0:c.rows)||1,onChange:t=>ej(e.id,{inputs:{...e.inputs||{},rows:Math.max(1,Number(t.target.value||1))}})})]}),(0,t.jsxs)("div",{className:"ew-hint",children:["Same math as plates × rows (then waste). Board length from size: ",e.boardLenFt||(0,f.parseBoardLengthFt)(M(e))||"—"," ft"]})]})]}),(0,t.jsx)("div",{className:"ew-right",children:Math.ceil(null!=(m=e.qtyRaw)?m:0)}),(0,t.jsx)("div",{className:"ew-right",children:(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=(p=e.wastePct)?p:0,onChange:t=>ej(e.id,{wastePct:Number(t.target.value)}),style:{width:80,textAlign:"right"}})}),(0,t.jsx)("div",{className:"ew-right",children:null!=(b=e.qtyFinal)?b:"—"}),(0,t.jsx)("div",{className:"ew-right",children:e.unit}),(0,t.jsx)("div",{className:"ew-right ew-money",children:e.unitPrice?L(e.unitPrice):"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:e.subtotal?L(e.subtotal):"—"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"ew-subtle",style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[(0,t.jsx)("span",{className:"ew-chip",title:ee(g).plan||"",children:ee(g).plan||"—"}),(0,t.jsx)("button",{className:"ew-btn",style:{padding:"4px 8px"},onClick:()=>el(g),children:ee(g).open?"Hide":"Notes"})]}),ee(g).comment&&(0,t.jsx)("div",{className:"ew-subtle",title:ee(g).comment,children:F(ee(g).comment)})]}),(0,t.jsx)("div",{})]}),ee(g).open&&(0,t.jsx)("div",{className:"ew-row",style:{padding:12},children:(0,t.jsxs)("div",{className:"controls2",style:{width:"100%"},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Plan label"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"text",value:ee(g).plan,onChange:e=>et(g,{plan:e.target.value})})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Comment"}),(0,t.jsx)("textarea",{className:"ew-input focus-anim",rows:3,value:ee(g).comment,onChange:e=>et(g,{comment:e.target.value})})]})]})})]},e.id)})}),(0,t.jsxs)("div",{className:"ew-footer",children:[(0,t.jsx)("button",{className:"ew-btn",onClick:()=>ew("Header"),children:"➕ Header"}),(0,t.jsx)("button",{className:"ew-btn",onClick:()=>ew("Post"),children:"➕ Post"}),(0,t.jsx)("button",{className:"ew-btn",onClick:()=>ew("Extra blocking"),children:"➕ Blocking"}),eo&&(0,t.jsx)("button",{className:"ew-btn",onClick:()=>ew("Extra sheathing"),children:"➕ Extra Sheathing"}),(0,t.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",color:"#f18d5b"},children:["Group subtotal: ",L(eP)]})]})]})})}let q=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),W=()=>"int-"+Math.random().toString(36).slice(2,9);function E(e){let{title:a="Interior walls",levelId:i="default",onTotalsChange:s,isLevelOne:r=!1,onBearingLFChange:o,onPartitionLFChange:c,onKneeLFChange:d}=e,[m,h]=(0,n.useLocalStorageJson)("inv:v1:int:sections:".concat(i),[{id:W()}]),[p,x]=(0,l.useState)({}),b=(0,l.useCallback)((e,t)=>{x(l=>({...l,[e]:t}))},[]),g=(0,l.useCallback)(()=>{h(e=>[...e,{id:W()}])},[h]),v=(0,l.useCallback)(e=>{h(t=>t.filter(t=>t.id!==e)),x(t=>{let l={...t};return delete l[e],l})},[h]),N=(0,l.useMemo)(()=>{let e=Object.values(p),t=e.filter(e=>(null==e?void 0:e.kind)==="int-2x6").reduce((e,t)=>e+(Number(null==t?void 0:t.lengthLF)||0),0),l=e.filter(e=>(null==e?void 0:e.kind)==="int-2x4").reduce((e,t)=>e+(Number(null==t?void 0:t.lengthLF)||0),0),n=e.reduce((e,t)=>e+(Number(null==t?void 0:t.platePieces)||0),0),a=e.reduce((e,t)=>e+(Number(null==t?void 0:t.bottomPlatePiecesPanel)||0),0),i=e.reduce((e,t)=>e+(Number(null==t?void 0:t.ptLF)||0),0),s=e.reduce((e,t)=>e+(Number(null==t?void 0:t.panelSheets)||0),0),r=e.reduce((e,t)=>e+(Number(null==t?void 0:t.groupSubtotal)||0),0),o=e.filter(e=>!!(null==e?void 0:e.isShear)),u=o.reduce((e,t)=>e+(Number(null==t?void 0:t.lengthLF)||0),0),c=e.reduce((e,t)=>e+(Number(null==t?void 0:t.panelPtBoards)||0),0),d=8;{let e=o.map(e=>Number(null==e?void 0:e.bottomBoardLenFt)||0).filter(Boolean);if(e.length){let t={};for(let l of e)t[l]=(t[l]||0)+1;d=Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])}}let m=e.filter(e=>!!(null==e?void 0:e.isPartition)).reduce((e,t)=>e+(Number(t.lengthLF)||0),0),h=e.filter(e=>!!(null==e?void 0:e.isKnee)).reduce((e,t)=>e+(Number(t.lengthLF)||0),0),x=e.filter(e=>!!(null==e?void 0:e.isBearing));return{int2x6LF:t,int2x4LF:l,intPlatePieces:n,intPTLFSum:i,panelsSubtotal:r,intPanelSheets:s,shearLengthSum:u,shearPanelLenFt:d,bearingLengthSum:x.reduce((e,t)=>e+(Number(t.lengthLF)||0),0),bearingPanelLenFt:(e=>{let t=e.filter(Boolean);if(!t.length)return 8;let l={};for(let e of t)l[e]=(l[e]||0)+1;return Number(Object.keys(l).sort((e,t)=>l[t]-l[e]||t-e)[0])})(x.map(e=>Number(e.bottomBoardLenFt)||0)),intBottomPlatePiecesPanel:a,partitionLengthSum:m,kneeLengthSum:h,intPanelPtBoards:c,intPanelSheets:s}},[p]),y=(0,l.useRef)("");(0,l.useEffect)(()=>{let e={int2x6LF:N.int2x6LF,int2x4LF:N.int2x4LF,intPlatePieces:N.intPlatePieces,intBottomPlatePiecesPanel:N.intBottomPlatePiecesPanel,intPTLFSum:N.intPTLFSum,intPanelSheets:N.intPanelSheets,panelsSubtotal:N.panelsSubtotal,shearLengthSum:N.shearLengthSum,shearPanelLenFt:N.shearPanelLenFt,bearingLengthSum:N.bearingLengthSum,bearingPanelLenFt:N.bearingPanelLenFt,partitionLengthSum:N.partitionLengthSum,kneeLengthSum:N.kneeLengthSum,intPanelPtBoards:N.intPanelPtBoards},t=JSON.stringify(e);t!==y.current&&(y.current=t,null==s||s(e),null==o||o(e.bearingLengthSum),null==c||c(e.partitionLengthSum),null==d||d(e.kneeLengthSum))},[N,s,o,c,d]);let w=N.panelsSubtotal;return(0,t.jsxs)("section",{className:"ew-stack",children:[(0,t.jsxs)("div",{className:"ew-card",style:{marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem"},children:[(0,t.jsx)("h2",{className:"ew-h2",style:{margin:0},children:a}),(0,t.jsxs)("div",{className:"ew-right",title:"Sum of all interior wall section subtotals for this level",style:{fontWeight:700},children:["Total: ",Number.isFinite(Number(w))?q.format(Number(w)):"—"]})]}),0===m.length&&(0,t.jsxs)("div",{className:"ew-card",children:[(0,t.jsx)("div",{className:"ew-subtle",children:"No interior wall sections yet."}),(0,t.jsx)("div",{style:{marginTop:8},children:(0,t.jsx)("button",{className:"ew-btn ew-btn--turq",onClick:g,children:"+ Add interior wall section"})})]}),m.map((e,l)=>(0,t.jsx)(I,{title:"".concat(a," — Section ").concat(l+1),persistKey:"int:".concat(i,":").concat(e.id),onRemove:()=>v(e.id),onStatsChange:t=>b(e.id,t),bottomDefaultFamily:r?"PT":"SPF#2"},e.id)),(0,t.jsxs)("div",{className:"ew-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"1rem"},children:[(0,t.jsx)("div",{className:"ew-subtle",children:"Add another interior wall section to this level."}),(0,t.jsx)(u,{onClick:g,title:"Add Section",label:"Add Section"})]})]})}var D=e.i(4862);let A=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),R=e=>Number.isFinite(Number(e))?A.format(Number(e)):"—",O=e=>e&&e.item?O(e.item):e,z=e=>O(e),U=e=>{var t,l,n;return(null==(t=O(e))?void 0:t.unit)||(null==(n=O(e))||null==(l=n.raw)?void 0:l.unit)||"pcs"},V=e=>{var t,l,n,a;return(null==(t=O(e))?void 0:t.sizeDisplay)||(null==(l=O(e))?void 0:l.sizeLabel)||(null==(a=O(e))||null==(n=a.raw)?void 0:n.sizeDisplay)||""},H=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,l=String(e).trim().split(/\s+/),n=l.slice(0,t).join(" ");return l.length>t?"".concat(n,"…"):n||""};function K(e){var a,i,s,r,o;let{title:u="Loose materials — Wall Panels",persistKey:c="loose-panels-0",onRemove:d,extLengthLF:m,extZipSheetsFinal:x,extZipSheetsSum:b,int2x6LF:g,int2x4LF:v,ptLFTotal:N,onTotalChange:y,onSubtotalChange:w,levelId:j,platePiecesTotal:P,onGeneralChange:S}=e,L=(0,l.useMemo)(()=>{var e;return Number(null!=(e=null!=x?x:b)?e:0)},[x,b]),F=L>0,[k,B]=(0,n.useLocalStorageJson)("inv:v1:notes:".concat(c),{}),C=e=>k[e]||{plan:"",comment:"",open:!1},M=(e,t)=>B(l=>({...l,[e]:{...C(e),...t}})),T=e=>M(e,{open:!C(e).open}),[I,q]=(0,l.useState)({lengthLF:Number(null!=m?m:0),panelBandLF:Number(null!=m?m:0),panelBandHeightFt:4,lfPerZipSheet:12,tapeRollLenFt:75,openingsBlockingLF:0}),[W,E]=(0,l.useState)(!1),[A,O]=(0,l.useState)({int2x6LF:null!=g?g:0,int2x4LF:null!=v?v:0,blockingLF:0}),[H,K]=(0,l.useState)({secondBottom:!1,extraSheathing:!1}),[Q,_]=(0,l.useState)({extBottomPT:null,extTopPlate:null,panelBandSheathing:null,zipTape:null,openingsBlocking:null,secondBottom:null,extraSheathing:null,int2x6PT:null,int2x6Plate:null,int2x4PT:null,int2x4Plate:null,intCabinetBlocking:null}),Z=e=>t=>_(l=>({...l,[e]:t})),J=Number(null!=(s=null!=m?m:I.lengthLF)?s:0),$=Number(null!=(r=null!=g?g:A.int2x6LF)?r:0),X=Number(null!=(o=null!=v?v:A.int2x4LF)?o:0);(0,l.useEffect)(()=>{if(!W){var e;let t=Number(null!=(e=null!=m?m:I.lengthLF)?e:0);q(e=>({...e,panelBandLF:t}))}},[m,W]);let Y=(0,f.parseBoardLengthFt)(V(Q.extBottomPT))||16,ee=(0,f.parseBoardLengthFt)(V(Q.extTopPlate))||16,et=(0,f.parseBoardLengthFt)(V(Q.openingsBlocking))||10,el=(0,f.parseBoardLengthFt)(V(Q.secondBottom))||16,en=(0,f.parseBoardLengthFt)(V(Q.int2x6PT))||16,ea=(0,f.parseBoardLengthFt)(V(Q.int2x6Plate))||16,ei=(0,f.parseBoardLengthFt)(V(Q.int2x4PT))||16,es=(0,f.parseBoardLengthFt)(V(Q.int2x4Plate))||16,er=(0,l.useMemo)(()=>{let e=[];{let t=(0,D.looseExtBottomPlates)({lengthLF:Number(J)||0,boardLenFt:Math.max(Number(Y)||0,1),item:z(Q.extBottomPT),unit:U(Q.extBottomPT)});e.push({key:"extBottomPT",label:"PT Bottom Plates – Loose",...t,item:z(Q.extBottomPT),wastePct:5})}{let t=(0,D.looseExtTopPlates)({lengthLF:Number(J)||0,boardLenFt:Math.max(Number(ee)||0,1),item:z(Q.extTopPlate),unit:U(Q.extTopPlate)});e.push({key:"extTopPlate",label:"Top Plates – Loose",...t,item:z(Q.extTopPlate),wastePct:5})}{let t=(0,D.loosePanelBandSheathing)({panelBandLF:Number(I.panelBandLF||0),bandHeightFt:4,item:z(Q.panelBandSheathing),unit:U(Q.panelBandSheathing)||"sheet",wastePct:20});e.push({key:"panelBandSheathing",label:"Panel band sheathing",...t,item:z(Q.panelBandSheathing),wastePct:20})}if(H.extraSheathing){let t=(0,D.looseExtraSheathing)({extLengthLF:Number(J)||0,bandHeightFt:Number(I.panelBandHeightFt||4),item:z(Q.extraSheathing),unit:U(Q.extraSheathing)||"sheet"});e.push({key:"extraSheathing",label:"Extra sheathing (optional)",...t,item:z(Q.extraSheathing),wastePct:10})}if(F){var t,l;let n=Number((null==(t=e.find(e=>"panelBandSheathing"===e.key))?void 0:t.qtyFinal)||0),a=H.extraSheathing?Number((null==(l=e.find(e=>"extraSheathing"===e.key))?void 0:l.qtyFinal)||0):0,i=(Number(L)+n+a)/6,s=Math.ceil(i),r=U(Q.zipTape)||"roll",o=z(Q.zipTape),u=(0,f.unitPriceFrom)(o),c=s*(Number(u)||0);e.push({key:"zipTape",label:"Tape – ZIP system",unit:r,qtyRaw:i,qtyFinal:s,unitPrice:u,subtotal:c,item:o,wastePct:0})}{let t=(0,D.looseOpeningsBlocking)({openingsLF:Number(I.openingsBlockingLF||0),boardLenFt:Math.max(Number(et)||0,1),item:z(Q.openingsBlocking),unit:U(Q.openingsBlocking)});e.push({key:"openingsBlocking",label:"Blocking at openings",...t,item:z(Q.openingsBlocking),wastePct:10})}if(H.secondBottom){let t=(0,D.looseSecondBottomPlate)({lengthLF:Number(J)||0,boardLenFt:Math.max(Number(el)||0,1),item:z(Q.secondBottom),unit:U(Q.secondBottom)});e.push({key:"secondBottom",label:"Second bottom plate (optional)",...t,item:z(Q.secondBottom),wastePct:5})}return e},[Q,H,J,L,I.panelBandLF,I.panelBandHeightFt,I.lfPerZipSheet,I.tapeRollLenFt,I.openingsBlockingLF,Y,ee,et,el,F]),eo=(0,l.useMemo)(()=>Object.fromEntries(er.map(e=>[e.key,e])),[er]),eu=Math.ceil((null==(a=eo.panelBandSheathing)?void 0:a.qtyFinal)||0),ec=H.extraSheathing?Math.ceil((null==(i=eo.extraSheathing)?void 0:i.qtyFinal)||0):0,ed=(0,l.useMemo)(()=>{var e;return Number((null==(e=er.find(e=>"panelBandSheathing"===e.key))?void 0:e.qtyFinal)||0)},[er]),em=(0,l.useMemo)(()=>{var e;return Number((null==(e=er.find(e=>"extraSheathing"===e.key))?void 0:e.qtyFinal)||0)},[er]),eh=(0,l.useMemo)(()=>Number(x||b||0),[x,b]),ep=(0,l.useMemo)(()=>{let e=[];{let t=(0,D.looseInt2x6PTPlates)({lengthLF:Number($)||0,boardLenFt:Math.max(Number(en)||0,1),item:z(Q.int2x6PT),unit:U(Q.int2x6PT),wastePct:5});e.push({key:"int2x6PT",label:"Interior 2×6 — PT Plates – Loose",...t,item:z(Q.int2x6PT),wastePct:5})}{let t=(0,D.looseInt2x6Plates)({lengthLF:Number($)||0,boardLenFt:Math.max(Number(ea)||0,1),item:z(Q.int2x6Plate),unit:U(Q.int2x6Plate),wastePct:5});e.push({key:"int2x6Plate",label:"Interior 2×6 — Plates – Loose",...t,item:z(Q.int2x6Plate),wastePct:5})}{let t=(0,D.looseInt2x4PTPlates)({lengthLF:Number(X)||0,boardLenFt:Math.max(Number(ei)||0,1),item:z(Q.int2x4PT),unit:U(Q.int2x4PT),wastePct:5});e.push({key:"int2x4PT",label:"Interior 2×4 — PT Plates – Loose",...t,item:z(Q.int2x4PT),wastePct:5})}{let t=(0,D.looseInt2x4Plates)({lengthLF:Number(X)||0,boardLenFt:Math.max(Number(es)||0,1),item:z(Q.int2x4Plate),unit:U(Q.int2x4Plate),wastePct:5});e.push({key:"int2x4Plate",label:"Interior 2×4 — Plates – Loose",...t,item:z(Q.int2x4Plate),wastePct:5})}{let t=(0,f.parseBoardLengthFt)(V(Q.intCabinetBlocking))||8,l=(0,D.looseCabinetBlocking)({blockingLF:Number(A.blockingLF||0),boardLenFt:Math.max(t,1),item:z(Q.intCabinetBlocking),unit:U(Q.intCabinetBlocking)});e.push({key:"intCabinetBlocking",label:"Walls (general) — Blocking for Bathroom & Kitchen",...l,item:z(Q.intCabinetBlocking),wastePct:10})}return e},[Q,$,X,en,ea,ei,es,A.blockingLF]),ex=(0,l.useMemo)(()=>{var e,t,l,n;let a=Math.ceil((null==(e=er.find(e=>"extTopPlate"===e.key))?void 0:e.qtyFinal)||0),i=Math.ceil((null==(t=er.find(e=>"secondBottom"===e.key))?void 0:t.qtyFinal)||0);return a+i+Math.ceil((null==(l=ep.find(e=>"int2x6Plate"===e.key))?void 0:l.qtyFinal)||0)+Math.ceil((null==(n=ep.find(e=>"int2x4Plate"===e.key))?void 0:n.qtyFinal)||0)},[er,ep]),eb=(0,l.useMemo)(()=>[{lf:Number(J)||0,len:Math.max(Number(Y)||0,1)},{lf:Number($)||0,len:Math.max(Number(en)||0,1)},{lf:Number(X)||0,len:Math.max(Number(ei)||0,1)}].reduce((e,t)=>{let{lf:l,len:n}=t;return e+Math.ceil(1.05*l/n)},0),[J,$,X,Y,en,ei]),eg=(0,l.useRef)(""),ev=(0,l.useRef)(S);(0,l.useEffect)(()=>{ev.current=S},[S]),(0,l.useEffect)(()=>{let e=[Number(eh)||0,Number(ed)||0,Number(em)||0,Number(ex)||0,String(j||""),Number(eb)||0].join("|");if(e!==eg.current){var t;eg.current=e,null==(t=ev.current)||t.call(ev,{id:j,sheetsExt:Number(eh)||0,sheetsBand:Number(ed)||0,sheetsExtra:Number(em)||0,platePiecesTotal:Number(ex)||0,ptPieces:Number(eb)||0})}},[eh,ed,em,ex,eb,j]);let eN=(0,l.useMemo)(()=>er.reduce((e,t)=>e+(t.subtotal||0),0)+ep.reduce((e,t)=>e+(t.subtotal||0),0),[er,ep]),ey="minmax(220px,1.3fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr",ew={fontFamily:"'Nova Flat', cursive",color:"#f18d5b",fontWeight:700,marginLeft:"auto"};return(0,l.useEffect)(()=>{"function"==typeof w&&w({subtotal:Number(eN)||0}),"function"==typeof y&&y(Number(eN)||0)},[eN,w,y]),(0,t.jsx)("div",{className:"ew-card",children:(0,t.jsxs)(p.default,{title:u,defaultOpen:!0,actions:d?(0,t.jsx)("button",{className:"ew-btn",onClick:d,children:"Remove section"}):null,bar:e=>{let{open:l,toggle:n}=e;return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,width:"100%"},children:[(0,t.jsx)("button",{type:"button",className:"acc__button",onClick:n,"aria-expanded":l,title:l?"Collapse":"Expand",children:(0,t.jsx)("img",{src:l?"/icons/minimize.png":"/icons/down.png",alt:l?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}})}),(0,t.jsx)("span",{className:"ew-head",children:u}),(0,t.jsxs)("div",{style:ew,children:["Subtotal: ",R(eN)]}),d&&(0,t.jsx)("div",{style:{marginLeft:"8px"},children:(0,t.jsx)("button",{className:"ew-btn",onClick:d,children:"Remove section"})})]})},children:[(0,t.jsx)("h3",{className:"ew-h3",style:{marginTop:0,marginBottom:6},children:"Exterior walls"}),(0,t.jsxs)("div",{className:"controls4",style:{marginBottom:12},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Exterior wall length (LF)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=m?m:I.lengthLF,onChange:e=>q(t=>({...t,lengthLF:Number(e.target.value)})),disabled:"number"==typeof m,title:"number"==typeof m?"Provided by context":"Manual"})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Panel band LF"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:I.panelBandLF,onChange:e=>{let t=Number(e.target.value);E(!0),q(e=>({...e,panelBandLF:Number.isFinite(t)?t:0}))},style:{width:140,textAlign:"right"}}),(0,t.jsx)("button",{type:"button",className:"ew-btn-secondary",onClick:()=>{E(!1),q(e=>{var t;return{...e,panelBandLF:Number(null!=(t=null!=m?m:e.lengthLF)?t:0)}})},title:"Use Exterior LF",children:"↺ use exterior LF"})]})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Band height (ft)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:I.panelBandHeightFt,onChange:e=>q(t=>({...t,panelBandHeightFt:Number(e.target.value)}))})]})]}),(0,t.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":ey},children:[(0,t.jsx)("div",{children:"Item"}),(0,t.jsx)("div",{children:"Vendor · Family · Size"}),(0,t.jsx)("div",{className:"ew-right",children:"Qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,t.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,t.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,t.jsx)("div",{children:"Notes"}),(0,t.jsx)("div",{})]}),(0,t.jsxs)("div",{className:"ew-rows",children:[(0,t.jsx)(G,{gridCols:ey,label:"PT Bottom Plates – Loose",noteKey:"loose:extBottomPT",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsx)(h.default,{compact:!0,onSelect:Z("extBottomPT"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"PT",defaultSizeLabel:"2x6\"-16'"}),row:er.find(e=>"extBottomPT"===e.key)}),(0,t.jsx)(G,{gridCols:ey,label:"Top Plates – Loose",noteKey:"loose:extTopPlate",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsx)(h.default,{compact:!0,onSelect:Z("extTopPlate"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x6\"-16'"}),row:er.find(e=>"extTopPlate"===e.key)}),(0,t.jsx)(G,{gridCols:ey,label:"Panel band sheathing",noteKey:"loose:panelBandSheathing",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsxs)("div",{className:"ew-inline",style:{alignItems:"end"},children:[(0,t.jsx)(h.default,{compact:!0,onSelect:Z("panelBandSheathing"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"Green Zip"}),(0,t.jsx)("div",{className:"ew-hint",children:"Here: 4′ band ⇒ sheets ≈ (Exterior LF ÷ 8) + waste"})]}),row:er.find(e=>"panelBandSheathing"===e.key)}),F&&(0,t.jsx)(G,{gridCols:ey,label:"Tape – ZIP system",noteKey:"loose:zipTape",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsxs)("div",{className:"ew-inline",style:{alignItems:"end"},children:[(0,t.jsx)(h.default,{compact:!0,onSelect:Z("zipTape"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"ZIP Flashing Tape"}),(0,t.jsxs)("div",{className:"ew-hint",children:["ZIP sheets = (ext: ",L,") + (band: ",eu,")",H.extraSheathing?" + (extra: ".concat(ec,")"):""]})]}),row:er.find(e=>"zipTape"===e.key)}),(0,t.jsx)(G,{gridCols:ey,label:"Blocking at openings",noteKey:"loose:openingsBlocking",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsxs)("div",{className:"ew-inline",style:{alignItems:"end"},children:[(0,t.jsx)(h.default,{compact:!0,onSelect:Z("openingsBlocking"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2"}),(0,t.jsxs)("label",{style:{minWidth:170},children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Openings blocking (LF)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:I.openingsBlockingLF,onChange:e=>q(t=>({...t,openingsBlockingLF:Number(e.target.value)}))})]})]}),row:er.find(e=>"openingsBlocking"===e.key)}),H.extraSheathing&&(0,t.jsx)(G,{gridCols:ey,label:"Extra sheathing (optional)",noteKey:"loose:extraSheathing",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsxs)("div",{className:"ew-inline",style:{alignItems:"end",gap:8},children:[(0,t.jsx)(h.default,{compact:!0,onSelect:Z("extraSheathing"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"CDX SE"}),(0,t.jsx)("button",{type:"button",className:"ew-btn",onClick:()=>K(e=>({...e,extraSheathing:!1})),title:"Remove this row",children:"Remove"})]}),row:er.find(e=>"extraSheathing"===e.key)}),H.secondBottom&&(0,t.jsx)(G,{gridCols:ey,label:"Second bottom plate (optional)",noteKey:"loose:secondBottom",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsxs)("div",{className:"ew-inline",style:{alignItems:"end",gap:8},children:[(0,t.jsx)(h.default,{compact:!0,onSelect:Z("secondBottom"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2"}),(0,t.jsx)("button",{type:"button",className:"ew-btn",onClick:()=>K(e=>({...e,secondBottom:!1})),title:"Remove this row",children:"Remove"})]}),row:er.find(e=>"secondBottom"===e.key)})]}),(0,t.jsxs)("div",{className:"ew-footer",style:{display:"flex",alignItems:"center",gap:12},children:[(0,t.jsx)("button",{className:"ew-btn",onClick:()=>K(e=>({...e,extraSheathing:!0})),disabled:H.extraSheathing,title:H.extraSheathing?"Already added":"Add extra sheathing row",children:"➕ Extra sheathing"}),(0,t.jsx)("button",{className:"ew-btn",onClick:()=>K(e=>({...e,secondBottom:!0})),disabled:H.secondBottom,title:H.secondBottom?"Already added":"Add second bottom plate row",children:"➕ Second bottom plate"}),(0,t.jsx)("div",{style:{flex:1}})]}),(0,t.jsx)("h3",{className:"ew-h3",style:{marginTop:16,marginBottom:6},children:"Interior walls"}),(0,t.jsxs)("div",{className:"controls4",style:{marginBottom:12},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Interior 2×6 LF"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=g?g:A.int2x6LF,onChange:e=>O(t=>({...t,int2x6LF:Number(e.target.value)})),disabled:"number"==typeof g,title:"number"==typeof g?"Provided by context":"Manual"})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Interior 2×4 LF"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=v?v:A.int2x4LF,onChange:e=>O(t=>({...t,int2x4LF:Number(e.target.value)})),disabled:"number"==typeof v,title:"number"==typeof v?"Provided by context":"Manual"})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Blocking LF (bath/kitchen)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:A.blockingLF||0,onChange:e=>O(t=>({...t,blockingLF:Number(e.target.value)}))})]}),(0,t.jsx)("div",{})]}),(0,t.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":ey},children:[(0,t.jsx)("div",{children:"Item"}),(0,t.jsx)("div",{children:"Vendor · Family · Size"}),(0,t.jsx)("div",{className:"ew-right",children:"Qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,t.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,t.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,t.jsx)("div",{children:"Notes"}),(0,t.jsx)("div",{})]}),(0,t.jsxs)("div",{className:"ew-rows",children:[(0,t.jsx)(G,{gridCols:ey,label:"Interior 2×6 — PT Plates – Loose",noteKey:"loose:int2x6PT",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsx)(h.default,{compact:!0,onSelect:Z("int2x6PT"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"PT",defaultSizeLabel:"2x6\"-16'"}),row:ep.find(e=>"int2x6PT"===e.key)}),(0,t.jsx)(G,{gridCols:ey,label:"Interior 2×6 — Plates – Loose",noteKey:"loose:int2x6Plate",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsx)(h.default,{compact:!0,onSelect:Z("int2x6Plate"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x6\"-16'"}),row:ep.find(e=>"int2x6Plate"===e.key)}),(0,t.jsx)(G,{gridCols:ey,label:"Interior 2×4 — PT Plates – Loose",noteKey:"loose:int2x4PT",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsx)(h.default,{compact:!0,onSelect:Z("int2x4PT"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"PT",defaultSizeLabel:"2x4\"-16'"}),row:ep.find(e=>"int2x4PT"===e.key)}),(0,t.jsx)(G,{gridCols:ey,label:"Interior 2×4 — Plates – Loose",noteKey:"loose:int2x4Plate",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsx)(h.default,{compact:!0,onSelect:Z("int2x4Plate"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x4\"-16'"}),row:ep.find(e=>"int2x4Plate"===e.key)}),(0,t.jsx)(G,{gridCols:ey,label:"Walls (general) — Blocking for Bathroom & Kitchen",noteKey:"loose:intCabinetBlocking",noteApi:{getNote:C,toggleOpen:T,setNote:M},picker:(0,t.jsx)(h.default,{compact:!0,onSelect:Z("intCabinetBlocking"),defaultVendor:"Fairway Lumber",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x10\"-16'"}),row:ep.find(e=>"intCabinetBlocking"===e.key)})]})]})})}function G(e){var n,a,i;let{gridCols:s,label:r,picker:o,row:u,noteKey:c,noteApi:d,includeControl:m}=e,{getNote:h,toggleOpen:p,setNote:x}=d,b=h(c);return(0,t.jsxs)(l.Fragment,{children:[(0,t.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":s},children:[(0,t.jsx)("div",{children:r}),(0,t.jsxs)("div",{children:[o,m&&(0,t.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",gap:8},children:(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,t.jsx)("input",{type:"checkbox",checked:m.checked,onChange:e=>m.onChange(e.target.checked)}),m.label]})})]}),(0,t.jsx)("div",{className:"ew-right",children:u?Math.ceil(u.qtyRaw||0):"—"}),(0,t.jsx)("div",{className:"ew-right",children:u?null!=(n=u.wastePct)?n:0:"—"}),(0,t.jsx)("div",{className:"ew-right",children:null!=(a=null==u?void 0:u.qtyFinal)?a:"—"}),(0,t.jsx)("div",{className:"ew-right",children:null!=(i=null==u?void 0:u.unit)?i:"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:(null==u?void 0:u.unitPrice)?R(u.unitPrice):"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:(null==u?void 0:u.subtotal)?R(u.subtotal):"—"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"ew-subtle",style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[(0,t.jsx)("span",{className:"ew-chip",title:b.plan||"",children:b.plan||"—"}),(0,t.jsx)("button",{className:"ew-btn",style:{padding:"4px 8px"},onClick:()=>p(c),children:b.open?"Hide":"Notes"})]}),b.comment&&(0,t.jsx)("div",{className:"ew-subtle",title:b.comment,children:H(b.comment)})]}),(0,t.jsx)("div",{})]}),b.open&&(0,t.jsx)("div",{className:"ew-row",style:{padding:12},children:(0,t.jsxs)("div",{className:"controls2",style:{width:"100%"},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Plan label"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"text",value:h(c).plan,onChange:e=>x(c,{plan:e.target.value})})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Comment"}),(0,t.jsx)("textarea",{className:"ew-input focus-anim",rows:3,value:h(c).comment,onChange:e=>x(c,{comment:e.target.value})})]})]})})]})}let Q=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),_=e=>Q.format(Number(e)||0),Z=e=>e&&e.item?Z(e.item):e,J=e=>Z(e),$=e=>{var t,l,n;return(null==(t=Z(e))?void 0:t.unit)||(null==(n=Z(e))||null==(l=n.raw)?void 0:l.unit)||"box"},X=(0,l.memo)(function(e){var n;let{label:a,picker:i,row:s,hint:r,wasteEditor:o}=e;return(0,t.jsx)(l.Fragment,{children:(0,t.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":"minmax(220px,1.3fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr"},children:[(0,t.jsx)("div",{children:a}),(0,t.jsxs)("div",{children:[i,r?(0,t.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:r}):null]}),(0,t.jsx)("div",{className:"ew-right",children:Math.ceil(s.qtyRaw||0)}),(0,t.jsx)("div",{className:"ew-right",children:null!=o?o:s.wastePct}),(0,t.jsx)("div",{className:"ew-right",children:null!=(n=s.qtyFinal)?n:"—"}),(0,t.jsx)("div",{className:"ew-right",children:s.unit||"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:s.unitPrice?_(s.unitPrice):"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:s.subtotal?_(s.subtotal):"—"}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{})]})})},(e,t)=>{let l=e.row||{},n=t.row||{};return e.label===t.label&&e.hint===t.hint&&e.picker===t.picker&&l.qtyRaw===n.qtyRaw&&l.qtyFinal===n.qtyFinal&&l.unit===n.unit&&l.unitPrice===n.unitPrice&&l.subtotal===n.subtotal&&l.wastePct===n.wastePct}),Y=(0,l.memo)(function(e){let{title:a="Panels — Nails (this level)",persistKey:i="panel-nails-default",totalPanelSheets:s=0,totalBottomPlatePiecesPanel:r=0,ptPlatePiecesPanels:o,panelPtBoards:u,onTotalChange:c}=e,[d,m]=(0,n.useLocalStorageJson)("inv:v1:".concat(i,":ui"),{collapsed:!0}),x=!!d.collapsed,b=(0,l.useCallback)(e=>{m(t=>({...t,collapsed:!!e}))},[m]),g=(0,l.useMemo)(()=>{var e;return Number(null!=(e=null!=o?o:u)?e:0)},[o,u]),[v,N]=(0,l.useState)({nailsSheath:null,nailsFrame8d:null,nailsFrame12d:null}),y=(0,l.useCallback)(e=>t=>{N(l=>l[e]===t?l:{...l,[e]:t})},[]),[w,j]=(0,l.useState)({sheath:40,frame8d:40,frame12d:40});(0,l.useMemo)(()=>Number(s||0),[s]);let P=(0,l.useMemo)(()=>{var e;let t=80*(Number(s)||0)/2700,l=Number(null!=(e=w.sheath)?e:40),n=Math.ceil(t*(1+l/100)),a=$(v.nailsSheath),i=J(v.nailsSheath),r=(0,f.unitPriceFrom)(i),o=n*(Number(r)||0);return{qtyRaw:t,qtyFinal:n,unit:a,item:i,unitPrice:r,subtotal:o,wastePct:l}},[s,v.nailsSheath,w.sheath]),S=(0,l.useMemo)(()=>{var e;let t=25*g/2700,l=Number(null!=(e=w.frame8d)?e:40),n=Math.ceil(t*(1+l/100)),a=$(v.nailsFrame8d),i=J(v.nailsFrame8d),s=(0,f.unitPriceFrom)(i),r=n*(Number(s)||0);return{boards:g,qtyRaw:t,qtyFinal:n,unit:a,item:i,unitPrice:s,subtotal:r,wastePct:l}},[g,v.nailsFrame8d,w.frame8d]),L=(0,l.useMemo)(()=>{var e;let t=Number(r)||0,l=80*t/2500,n=Number(null!=(e=w.frame12d)?e:40),a=Math.ceil(l*(1+n/100)),i=$(v.nailsFrame12d),s=J(v.nailsFrame12d),o=(0,f.unitPriceFrom)(s),u=a*(Number(o)||0);return{boards:t,qtyRaw:l,qtyFinal:a,unit:i,item:s,unitPrice:o,subtotal:u,wastePct:n}},[r,v.nailsFrame12d,w.frame12d]),F=(0,l.useMemo)(()=>(P.subtotal||0)+(S.subtotal||0)+(L.subtotal||0),[P.subtotal,S.subtotal,L.subtotal]),k=(0,l.useRef)(c);(0,l.useEffect)(()=>{k.current=c},[c]);let B=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=Number(F)||0;if(e!==B.current){var t;B.current=e,null==(t=k.current)||t.call(k,{total:e})}},[F]);let C=(0,l.useMemo)(()=>(0,t.jsx)(h.default,{compact:!0,onSelect:y("nailsSheath"),defaultVendor:"Concord",defaultFamilyLabel:"Bright Ring Coil",defaultSizeLabel:"8D-2-3/8x.113-2.7M"}),[y]),M=(0,l.useMemo)(()=>(0,t.jsx)(h.default,{compact:!0,onSelect:y("nailsFrame8d"),defaultVendor:"Concord",defaultFamilyLabel:"Galvanized Ring Coil",defaultSizeLabel:'8D-2-3/8"'}),[y]),T=(0,l.useMemo)(()=>(0,t.jsx)(h.default,{compact:!0,onSelect:y("nailsFrame12d"),defaultVendor:"Concord",defaultFamilyLabel:"Bright Common Coil",defaultSizeLabel:"12D-3-1/4x.120-2.5M"}),[y]),I=(0,l.useMemo)(()=>"Panel sheets (Ext + Int Shear): ".concat(s," → boxes = ceil(((sheets × 80) / 2700) × (1 + waste%))"),[s]),q=(0,l.useMemo)(()=>"PT plate boards (panels): ".concat(g," → boxes = ceil(((boards × 25) / 2700) × (1 + waste%))"),[g]),W=(0,l.useMemo)(()=>"Bottom plate boards (panels): ".concat(r," → boxes = ceil(((boards × 80) / 2500) × (1 + waste%))"),[r]);return(0,t.jsx)("div",{className:"ew-card",children:(0,t.jsxs)(p.default,{open:!x,onOpenChange:e=>b(!e),bar:e=>{let{open:l,toggle:n}=e;return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,width:"100%"},children:[(0,t.jsx)("button",{type:"button",className:"acc__button",onClick:n,"aria-expanded":l,title:l?"Collapse":"Expand",children:(0,t.jsx)("img",{src:l?"/icons/minimize.png":"/icons/down.png",alt:l?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}})}),(0,t.jsx)("span",{className:"ew-head",children:a})," ",(0,t.jsx)("div",{style:{marginLeft:"auto"}}),(0,t.jsxs)("div",{className:"ew-right",style:{color:"#f18d5b",fontWeight:700},children:[" ","Subtotal: ",_(F)]})]})},children:[(0,t.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":"minmax(220px,1.3fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr"},children:[(0,t.jsx)("div",{children:"Item"}),(0,t.jsx)("div",{children:"Vendor · Family · Size"}),(0,t.jsx)("div",{className:"ew-right",children:"Qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,t.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,t.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{})]}),(0,t.jsxs)("div",{className:"ew-rows",children:[(0,t.jsx)(X,{label:"Framing nails (8D)",row:S,picker:M,hint:q,wasteEditor:(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:w.frame8d,onChange:e=>j(t=>({...t,frame8d:Number(e.target.value)||0})),style:{width:80,padding:6,textAlign:"right"},title:"Waste %"})}),(0,t.jsx)(X,{label:"Sheathing nails",row:P,picker:C,hint:I,wasteEditor:(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:w.sheath,onChange:e=>j(t=>({...t,sheath:Number(e.target.value)||0})),style:{width:80,padding:6,textAlign:"right"},title:"Waste %"})}),(0,t.jsx)(X,{label:"Framing nails (12D)",row:L,picker:T,hint:W,wasteEditor:(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:w.frame12d,onChange:e=>j(t=>({...t,frame12d:Number(e.target.value)||0})),style:{width:80,padding:6,textAlign:"right"},title:"Waste %"})})]})]})})},(e,t)=>{var l,n,a,i;return e.totalPanelSheets===t.totalPanelSheets&&e.totalBottomPlatePiecesPanel===t.totalBottomPlatePiecesPanel&&(null!=(n=null!=(l=e.ptPlatePiecesPanels)?l:e.panelPtBoards)?n:0)===(null!=(i=null!=(a=t.ptPlatePiecesPanels)?a:t.panelPtBoards)?i:0)&&e.title===t.title&&e.persistKey===t.persistKey});function ee(e){var a,i;let{id:s,name:r,onRemove:o,onLooseTotal:u=()=>{},onLevelTotal:c=()=>{},onExteriorPanelLenChange:d,onExteriorLF:h,onInteriorShearLF:b,onInteriorShearPanelLenChange:g,onInteriorBearingLF:v,onInteriorNonLoadLF:N,onKneeWallLF:y,levelsCount:w,panelsTotalAllSections:j,onLooseGeneralChange:f}=e,[P,S]=(0,n.useLocalStorageJson)("inv:v1:level-ui:".concat(s),{collapsed:!1}),L=!!P.collapsed,[F,k]=(0,l.useState)(null),[B,C]=(0,l.useState)({int2x6LF:0,int2x4LF:0,intPlatePieces:0,intPTLFSum:0,panelsSubtotal:0}),[M,T]=(0,l.useState)(0),I=(0,l.useMemo)(()=>Math.ceil(Number((null==F?void 0:F.extPanelPtBoards)||0))+Math.ceil(Number((null==B?void 0:B.intPanelPtBoards)||0)),[null==F?void 0:F.extPanelPtBoards,null==B?void 0:B.intPanelPtBoards]),q=(0,l.useMemo)(()=>Math.ceil(Number((null==F?void 0:F.extBottomPlatePiecesPanel)||0))+Math.ceil(Number((null==B?void 0:B.intBottomPlatePiecesPanel)||0)),[null==F?void 0:F.extBottomPlatePiecesPanel,null==B?void 0:B.intBottomPlatePiecesPanel]),[W,D]=(0,l.useState)(0),[A,R]=(0,l.useState)(0),O=(0,l.useCallback)(e=>{let t=Number(e)||16;R(t),null==d||d({id:s,len:t})},[s,d]),z=(0,l.useCallback)(e=>{C(e||null),e&&(null==b||b({id:s,lf:Number(e.shearLengthSum)||0}),null==g||g({id:s,len:Number(e.shearPanelLenFt)||8}),null==v||v({id:s,lf:Number(e.bearingLengthSum)||0}),null==N||N({id:s,lf:Number(e.partitionLengthSum)||0}),null==y||y({id:s,lf:Number(e.kneeLengthSum)||0}))},[s,b,g,v,N,y]),U=(0,l.useCallback)(e=>{let t=Number(null==e?void 0:e.subtotal)||0;D(t),null==u||u({id:s,subtotal:t})},[s,u]),V=(0,l.useCallback)(e=>{T(Number(null==e?void 0:e.total)||0)},[]),H=(0,l.useMemo)(()=>{let e=Number(null==F?void 0:F.panelsSubtotal)||0,t=Number(null==B?void 0:B.panelsSubtotal)||0;return e+t+(Number(W)||0)+(Number(M)||0)},[null==F?void 0:F.panelsSubtotal,null==B?void 0:B.panelsSubtotal,W,M]),G=(0,l.useMemo)(()=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),[]);(0,l.useEffect)(()=>{null==c||c({id:s,total:H})},[s,H,c]),null==F||F.extPlatePieces,null==B||B.intPlatePieces;let Q=(0,l.useMemo)(()=>Number((null==F?void 0:F.extPanelSheets)||0)+Number((null==B?void 0:B.intPanelSheets)||0),[null==F?void 0:F.extPanelSheets,null==B?void 0:B.intPanelSheets]),_={fontFamily:"'Nova Mono', monospace"};return(0,t.jsx)("section",{className:"ew-stack",children:(0,t.jsxs)(p.default,{open:!L,onOpenChange:e=>{let t;return t=!e,S(e=>({...e,collapsed:!!t}))},bar:e=>{let{open:l,toggle:n}=e;return(0,t.jsxs)("div",{style:{..._,display:"flex",alignItems:"center",gap:8},children:[(0,t.jsxs)("button",{type:"button",className:"acc__button",onClick:n,title:l?"Collapse":"Expand","aria-label":"".concat(l?"Collapse":"Expand"," ").concat(r),children:[(0,t.jsx)("img",{src:l?"/icons/down.png":"/icons/minimize.png",alt:l?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}}),(0,t.jsx)("span",{className:"ew-head",children:r})]}),(0,t.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",fontWeight:800,fontSize:16,color:"#f18d5b"},title:"Level total (Panels + Loose)",children:["Level total: ",G.format(Number(H)||0)]}),o?(0,t.jsx)(x.default,{onClick:o,title:"Remove level",label:"Remove level"}):null]})},children:[(0,t.jsx)(m,{levelId:s,onTotalsChange:e=>k(e),title:"".concat(r," — Exterior walls"),onLengthLFChange:e=>null==h?void 0:h({id:s,lf:e}),onPanelLenFtChange:O,isLevelOne:/(\b|^)level\s*1(\b|$)/i.test(String(r||""))}),(0,t.jsx)(E,{levelId:s,onTotalsChange:z,title:"".concat(r," — Interior walls"),isLevelOne:/(\b|^)level\s*1(\b|$)/i.test(String(r||"")),onInteriorBearingLF:v,onBearingLFChange:e=>null==v?void 0:v({id:s,lf:Number(e)||0}),onPartitionLFChange:e=>null==N?void 0:N({id:s,lf:Number(e)||0}),onKneeLFChange:e=>null==y?void 0:y({id:s,lf:Number(e)||0})}),(0,t.jsx)(Y,{title:"".concat(r," — Panel nails"),persistKey:"panel-nails:".concat(s),platePiecesPanels:Number(((null==F?void 0:F.extPlatePieces)||0)+((null==B?void 0:B.intPlatePieces)||0))-q,ptPlatePiecesPanels:I,totalPanelSheets:Q,totalBottomPlatePiecesPanel:q,onTotalChange:V}),(0,t.jsx)(K,{title:"".concat(r," — Loose materials (wall panels)"),persistKey:"loose:".concat(s),onSubtotalChange:U,extLengthLF:Number((null==F?void 0:F.extLengthSum)||0),extZipSheetsFinal:Number(null!=(i=null!=(a=null==F?void 0:F.extZipSheetsFinal)?a:null==F?void 0:F.extZipSheetsSum)?i:0),extZipSheetsSum:null==F?void 0:F.extZipSheetsSum,int2x6LF:Number((null==B?void 0:B.int2x6LF)||0),int2x4LF:Number((null==B?void 0:B.int2x4LF)||0),ptLFTotal:Number((null==F?void 0:F.extPTLFSum)||0)+Number((null==B?void 0:B.intPTLFSum)||0),platePiecesTotal:Number((null==F?void 0:F.extPlatePieces)||0)+Number((null==B?void 0:B.intPlatePieces)||0),totalPanelsAllLevels:Number(j||0),levelsCount:Number(w||1),levelId:s,onGeneralChange:f})]})})}let et={exteriorWalls:{ratePerLF:10.5,ratePerPanel:84},interiorShear:{ratePerLF:10.25,ratePerPanel:82},interiorBlocking:{ratePerLF:6.5,ratePerPanel:52},interiorNonLoad:{ratePerLF:6,ratePerPanel:48},kneeWall:{ratePerLF:4.5,ratePerPanel:36},windows:{each:20.05},exteriorDoors:{each:15.19},blocking2x10:{each:.6}},el=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),en=e=>el.format(Number(e||0)),ea=e=>Number(e||0).toLocaleString("en-US");function ei(e){let{rows:a={},panelLenFt:i=8,panelLenFtInterior:s=8,panelLenFtExterior:r,panelLenFtInteriorBlocking:o=8,rates:u=et,persistKey:c="inv:v1:pme:ui",onTotalChange:d,exteriorLF:m=0,interiorShearLF:h=0,interiorBlockingLF:x=0,interiorNonLoadLF:b,kneeWallLF:g}=e,[v,N]=(0,n.useLocalStorageJson)(c,{collapsed:!1}),y=!!v.collapsed,w=(0,l.useCallback)(e=>{N(t=>({...t,collapsed:!!e}))},[N]),j=(0,l.useMemo)(()=>({exteriorWalls:a.exteriorWalls||{lf:0,panels:0},interiorShear:a.interiorShear||{lf:0,panels:0},interiorBlockingOnly:a.interiorBlockingOnly||{lf:0,panels:0},interiorNonLoad:a.interiorNonLoad||{lf:0,panels:0},kneeWall:a.kneeWall||{lf:0,panels:0},windows:a.windows||{qty:0},exteriorDoors:a.exteriorDoors||{qty:0},blocking2x10:a.blocking2x10||{rows:0}}),[a]),[f,P]=(0,l.useState)(()=>{var e,t,l,n,a,i,s,r,o,c,d,m,h,p,x,b;return{exteriorWalls:null!=(o=null==(e=u.exteriorWalls)?void 0:e.ratePerLF)?o:0,interiorShear:null!=(c=null==(t=u.interiorShear)?void 0:t.ratePerLF)?c:0,interiorBlockingOnly:null!=(d=null==(l=u.interiorBlocking)?void 0:l.ratePerLF)?d:0,interiorNonLoad:null!=(m=null==(n=u.interiorNonLoad)?void 0:n.ratePerLF)?m:0,kneeWall:null!=(h=null==(a=u.kneeWall)?void 0:a.ratePerLF)?h:0,windows:null!=(p=null==(i=u.windows)?void 0:i.each)?p:0,exteriorDoors:null!=(x=null==(s=u.exteriorDoors)?void 0:s.each)?x:0,blocking2x10:null!=(b=null==(r=u.blocking2x10)?void 0:r.each)?b:0}}),[S,L]=(0,l.useState)({});(0,l.useEffect)(()=>{P(e=>{var t,l,n,a,i,s,r,o,c,d,m,h,p,x,b,g,v,N,y,w,j,f,P,L;return{exteriorWalls:S.exteriorWalls?e.exteriorWalls:null!=(d=null!=(c=null==(t=u.exteriorWalls)?void 0:t.ratePerLF)?c:e.exteriorWalls)?d:0,interiorShear:S.interiorShear?e.interiorShear:null!=(h=null!=(m=null==(l=u.interiorShear)?void 0:l.ratePerLF)?m:e.interiorShear)?h:0,interiorBlockingOnly:S.interiorBlockingOnly?e.interiorBlockingOnly:null!=(x=null!=(p=null==(n=u.interiorBlocking)?void 0:n.ratePerLF)?p:e.interiorBlockingOnly)?x:0,interiorNonLoad:S.interiorNonLoad?e.interiorNonLoad:null!=(g=null!=(b=null==(a=u.interiorNonLoad)?void 0:a.ratePerLF)?b:e.interiorNonLoad)?g:0,kneeWall:S.kneeWall?e.kneeWall:null!=(N=null!=(v=null==(i=u.kneeWall)?void 0:i.ratePerLF)?v:e.kneeWall)?N:0,windows:S.windows?e.windows:null!=(w=null!=(y=null==(s=u.windows)?void 0:s.each)?y:e.windows)?w:0,exteriorDoors:S.exteriorDoors?e.exteriorDoors:null!=(f=null!=(j=null==(r=u.exteriorDoors)?void 0:r.each)?j:e.exteriorDoors)?f:0,blocking2x10:S.blocking2x10?e.blocking2x10:null!=(L=null!=(P=null==(o=u.blocking2x10)?void 0:o.each)?P:e.blocking2x10)?L:0}})},[u,S]);let[F,k]=(0,l.useState)(()=>({exteriorWalls:Number(null!=r?r:i)||8,interiorShear:Number(null!=s?s:8)||8,interiorBlockingOnly:Number(null!=o?o:8)||8,interiorNonLoad:Number(null!=s?s:8)||8,kneeWall:Number(null!=s?s:8)||8})),[B,C]=(0,l.useState)({});(0,l.useEffect)(()=>{k(e=>({exteriorWalls:B.exteriorWalls?e.exteriorWalls:Number(null!=r?r:i)||8,interiorShear:B.interiorShear?e.interiorShear:Number(s)||8,interiorBlockingOnly:B.interiorBlockingOnly?e.interiorBlockingOnly:Number(o)||8,interiorNonLoad:B.interiorNonLoad?e.interiorNonLoad:Number(s)||8,kneeWall:B.kneeWall?e.kneeWall:Number(s)||8}))},[r,s,o,i,B]),(0,l.useMemo)(()=>new Set(["windows","exteriorDoors","blocking2x10"]),[]);let[M,T]=(0,l.useState)(()=>{var e,t,l,n,a,i;return{windows:null!=(n=null==(e=j.windows)?void 0:e.qty)?n:0,exteriorDoors:null!=(a=null==(t=j.exteriorDoors)?void 0:t.qty)?a:0,blocking2x10:null!=(i=null==(l=j.blocking2x10)?void 0:l.rows)?i:0}}),[I,q]=(0,l.useState)({});(0,l.useEffect)(()=>{T(e=>{var t,l,n,a,i,s;return{windows:I.windows?e.windows:null!=(a=null==(t=j.windows)?void 0:t.qty)?a:0,exteriorDoors:I.exteriorDoors?e.exteriorDoors:null!=(i=null==(l=j.exteriorDoors)?void 0:l.qty)?i:0,blocking2x10:I.blocking2x10?e.blocking2x10:null!=(s=null==(n=j.blocking2x10)?void 0:n.rows)?s:0}})},[j,I]);let W=(0,l.useMemo)(()=>{let e=[],t=(t,l,n)=>{var a,i,s;let r="exteriorWalls"===l?Number(m||0):"interiorShear"===l?Number(h||0):"interiorBlockingOnly"===l?Number(x||0):"interiorNonLoad"===l?Number(b||0):"kneeWall"===l?Number(g||0):0,o=Number(F[l])||8,u=Math.ceil(r/Math.max(1,o)*1.1),c=Number(null!=(i=null!=(a=f[l])?a:null==n?void 0:n.ratePerLF)?i:0),d=Number(null!=(s=null==n?void 0:n.ratePerPanel)?s:0);e.push({label:t,key:l,lf:r,panelLenFt:o,panels:u,ratePerLF:c,ratePerPanel:d,total:r*c,isQtyBased:!1})},l=(t,l,n)=>{var a,i,s;let r=Number(null!=(a=M[l])?a:0),o=Number(null!=(s=null!=(i=f[l])?i:null==n?void 0:n.each)?s:0);e.push({label:t,key:l,qty:r,lf:0,panelLenFt:"—",panels:"—",ratePerLF:o,ratePerPanel:"n/a",total:r*o,isQtyBased:!0})};return t("Exterior Walls","exteriorWalls",u.exteriorWalls),t("Interior Shear walls","interiorShear",u.interiorShear),t("Interior wall with blocking only","interiorBlockingOnly",u.interiorBlocking),t("Interior Non-load bearing walls","interiorNonLoad",u.interiorNonLoad),t("Knee wall","kneeWall",u.kneeWall),l("Windows","windows",u.windows),l("Exterior Doors","exteriorDoors",u.exteriorDoors),l("2x10 blocking rows","blocking2x10",u.blocking2x10),e},[u,F,f,M,m,h,x,b,g]),E=(0,l.useMemo)(()=>{let e=W.reduce((e,t)=>e+(Number(t.lf)||0),0);return{lf:e,panels:W.filter(e=>!e.isQtyBased).reduce((e,t)=>e+(Number(t.panels)||0),0),total:W.reduce((e,t)=>e+(Number(t.total)||0),0)}},[W]);(0,l.useEffect)(()=>{null==d||d({total:E.total,panels:E.panels})},[E.total,E.panels,d]);let D=(0,l.useCallback)(e=>t=>{let l=Number(t.target.value)||0;k(t=>({...t,[e]:Math.max(1,l)})),C(t=>({...t,[e]:!0}))},[]),A=(0,l.useCallback)(e=>t=>{let l=t.target.value;P(t=>({...t,[e]:l}))},[]),R=(0,l.useCallback)(e=>t=>{let l=parseFloat(t.target.value),n=Number.isFinite(l)?l:0;P(t=>({...t,[e]:n})),L(t=>({...t,[e]:!0}))},[]),O=(0,l.useCallback)(e=>t=>{let l=t.target.value;T(t=>({...t,[e]:l}))},[]),z=(0,l.useCallback)(e=>t=>{let l=parseInt(t.target.value,10),n=Number.isFinite(l)&&l>=0?l:0;T(t=>({...t,[e]:n})),q(t=>({...t,[e]:!0}))},[]);return(0,t.jsx)(p.default,{open:!y,onOpenChange:e=>w(!e),bar:e=>{let{open:l,toggle:n}=e;return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,width:"100%"},children:[(0,t.jsx)("button",{type:"button",className:"acc__button",onClick:n,"aria-expanded":l,title:l?"Collapse":"Expand",children:(0,t.jsx)("img",{src:l?"/icons/minimize.png":"/icons/down.png",alt:l?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}})}),(0,t.jsx)("h2",{className:"ew-h2",style:{margin:0},children:"Panels Manufacture Estimate"}),(0,t.jsx)("div",{style:{marginLeft:"auto"}}),(0,t.jsx)("div",{className:"ew-right",title:"Panels manufacture subtotal",style:{fontWeight:800},children:en(E.total)})]})},children:(0,t.jsx)("div",{className:"table-wrap",children:(0,t.jsxs)("table",{className:"tbl",style:{width:"100%",tableLayout:"fixed"},children:[(0,t.jsxs)("colgroup",{children:[(0,t.jsx)("col",{style:{width:"26%"}}),(0,t.jsx)("col",{style:{width:"13%"}}),(0,t.jsx)("col",{style:{width:"13%"}}),(0,t.jsx)("col",{style:{width:"13%"}}),(0,t.jsx)("col",{style:{width:"12%"}}),(0,t.jsx)("col",{style:{width:"12%"}}),(0,t.jsx)("col",{style:{width:"11%"}})]}),(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Wall type"}),(0,t.jsx)("th",{className:"num",children:"LF / Qty"}),(0,t.jsx)("th",{className:"num",children:"Panel Length (ft)"}),(0,t.jsx)("th",{className:"num",children:"# Panels"}),(0,t.jsx)("th",{className:"num",children:"Rate per LF / $ Each"}),(0,t.jsx)("th",{className:"num",children:"Rate per Panel $"}),(0,t.jsx)("th",{className:"num",children:"Subtotal"})]})}),(0,t.jsx)("tbody",{children:W.map(e=>{var l,n,a;let i="exteriorWalls"===e.key||"interiorShear"===e.key||"interiorBlockingOnly"===e.key||"interiorNonLoad"===e.key||"kneeWall"===e.key;return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.label}),(0,t.jsx)("td",{className:"num",children:e.isQtyBased?(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",min:"0",step:"1",value:null!=(l=M[e.key])?l:"",onChange:O(e.key),onBlur:z(e.key),style:{width:110,textAlign:"right",padding:"4px 8px"}}):(0,t.jsx)("span",{children:Number(e.lf||0).toLocaleString()})}),(0,t.jsx)("td",{className:"num",children:e.isQtyBased?"—":i?(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",min:"1",step:"0.01",value:null!=(n=F[e.key])?n:"",onChange:D(e.key),style:{width:90,textAlign:"right",padding:"4px 8px"}}):e.panelLenFt}),(0,t.jsx)("td",{className:"num",children:e.isQtyBased?"—":ea(e.panels)}),(0,t.jsx)("td",{className:"num",children:(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",step:"0.01",min:"0",value:null!=(a=f[e.key])?a:"",onChange:A(e.key),onBlur:R(e.key),style:{width:110,textAlign:"right",padding:"4px 8px"}})}),(0,t.jsx)("td",{className:"num",children:"n/a"===e.ratePerPanel?"n/a":en(e.ratePerPanel)}),(0,t.jsx)("td",{className:"num ew-money",children:en(e.total)})]},e.key)})}),(0,t.jsx)("tfoot",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{colSpan:3,style:{textAlign:"right"},children:"TOTALS"}),(0,t.jsx)("th",{className:"num ew-total-panels",children:ea(E.panels)}),(0,t.jsx)("th",{colSpan:2}),(0,t.jsx)("th",{className:"num ew-total-panels",children:en(E.total)})]})})]})})})}let es=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),er=e=>es.format(Number(e)||0),eo=e=>e&&e.item?eo(e.item):e,eu=e=>eo(e),ec=e=>{var t,l,n;return(null==(t=eo(e))?void 0:t.unit)||(null==(n=eo(e))||null==(l=n.raw)?void 0:l.unit)||"box"},ed="minmax(220px,1.3fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr",em=(0,l.memo)(function(e){var n,a;let{label:i,picker:s,row:r,hint:o}=e;return(0,t.jsx)(l.Fragment,{children:(0,t.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":ed},children:[(0,t.jsx)("div",{children:i}),(0,t.jsxs)("div",{children:[s,o?(0,t.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:o}):null]}),(0,t.jsx)("div",{className:"ew-right",children:Math.ceil(r.qtyRaw||0)}),(0,t.jsx)("div",{className:"ew-right",children:null!=(n=r.wastePct)?n:0}),(0,t.jsx)("div",{className:"ew-right",children:null!=(a=r.qtyFinal)?a:"—"}),(0,t.jsx)("div",{className:"ew-right",children:r.unit||"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:r.unitPrice?er(r.unitPrice):"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:r.subtotal?er(r.subtotal):"—"}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{})]})})},(e,t)=>{let l=e.row||{},n=t.row||{};return e.label===t.label&&e.hint===t.hint&&e.picker===t.picker&&l.qtyRaw===n.qtyRaw&&l.qtyFinal===n.qtyFinal&&l.unit===n.unit&&l.unitPrice===n.unitPrice&&l.subtotal===n.subtotal&&l.wastePct===n.wastePct});function eh(e){let{title:n="General — Nails & bracing (all levels)",totals:a={},onTotalChange:i}=e,{panelsAll:s=0,platePiecesAll:r=0,ptPiecesAll:o=null,sheetsExtAll:u=0,sheetsBandAll:c=0,sheetsExtraAll:d=0}=a,[m,x]=(0,l.useState)({nailsConcrete:null,nailsSheathing:null,nailsFraming:null,tempBracing:null}),b=(0,l.useCallback)(e=>x(t=>t.nailsConcrete===e?t:{...t,nailsConcrete:e}),[]),g=(0,l.useCallback)(e=>x(t=>t.nailsSheathing===e?t:{...t,nailsSheathing:e}),[]),v=(0,l.useCallback)(e=>x(t=>t.nailsFraming===e?t:{...t,nailsFraming:e}),[]),N=(0,l.useCallback)(e=>x(t=>t.tempBracing===e?t:{...t,tempBracing:e}),[]),y=(0,l.useMemo)(()=>Number(c)+Number(d),[u,c,d]),w=(0,l.useMemo)(()=>{let e=25*(Number(o)||0)/100,t=Math.ceil(1.4*e),l=ec(m.nailsConcrete)||"box",n=eu(m.nailsConcrete),a=(0,f.unitPriceFrom)(n),i=t*(Number(a)||0);return{qtyRaw:e,qtyFinal:t,unit:l,item:n,unitPrice:a,subtotal:i,wastePct:40}},[o,m.nailsConcrete]),j=(0,l.useMemo)(()=>{let e=80*(Number(y)||0)/2700,t=Math.ceil(1.4*e),l=ec(m.nailsSheathing)||"box",n=eu(m.nailsSheathing),a=(0,f.unitPriceFrom)(n),i=t*(Number(a)||0);return{qtyRaw:e,qtyFinal:t,unit:l,item:n,unitPrice:a,subtotal:i,wastePct:40}},[y,m.nailsSheathing]),P=(0,l.useMemo)(()=>{let e=25*(Number(r)||0)/2500,t=Math.ceil(1.4*e),l=ec(m.nailsFraming)||"box",n=eu(m.nailsFraming),a=(0,f.unitPriceFrom)(n),i=t*(Number(a)||0);return{qtyRaw:e,qtyFinal:t,unit:l,item:n,unitPrice:a,subtotal:i,wastePct:40}},[r,m.nailsFraming]),S=(0,l.useMemo)(()=>{let e=3*Math.max(0,Number(s)||0),t=Math.ceil(e),l=ec(m.tempBracing)||"pcs",n=eu(m.tempBracing),a=(0,f.unitPriceFrom)(n),i=t*(Number(a)||0);return{qtyRaw:e,qtyFinal:t,unit:l,item:n,unitPrice:a,subtotal:i,wastePct:0}},[s,m.tempBracing]),L=(0,l.useMemo)(()=>(w.subtotal||0)+(j.subtotal||0)+(P.subtotal||0)+(S.subtotal||0),[w.subtotal,j.subtotal,P.subtotal,S.subtotal]),F=(0,l.useRef)(i);(0,l.useEffect)(()=>{F.current=i},[i]);let k=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=Number(L)||0;if(e!==k.current){var t;k.current=e,null==(t=F.current)||t.call(F,{total:e})}},[L]);let B=(0,l.useMemo)(()=>(0,t.jsx)(h.default,{compact:!0,onSelect:b,defaultVendor:"Home Depot",defaultFamilyLabel:"Drive Pins with Washers (HD)",defaultSizeLabel:'3"-100s'}),[b]),C=(0,l.useMemo)(()=>(0,t.jsx)(h.default,{compact:!0,onSelect:g,defaultVendor:"Concord",defaultFamilyLabel:"Bright Ring Coil",defaultSizeLabel:"8D-2-3/8x.113-2.7M"}),[g]),M=(0,l.useMemo)(()=>(0,t.jsx)(h.default,{compact:!0,onSelect:v,defaultVendor:"Concord",defaultFamilyLabel:"Bright Common Coil",defaultSizeLabel:"12D-3-1/4x.120-2.5M"}),[v]),T=(0,l.useMemo)(()=>(0,t.jsx)(h.default,{compact:!0,onSelect:N,defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x4\"-16'"}),[N]),I=(0,l.useMemo)(()=>{let e=Number(o)||0,t=new Intl.NumberFormat("en-US").format(e);return"PT pieces: ".concat(t," → boxes = pt pieces × 25 / 100 + 40% waste")},[o]),q=(0,l.useMemo)(()=>"Loose sheets = (band: ".concat(c,")")+(d?" + (extra: ".concat(d,")"):""),[c,d]),W=(0,l.useMemo)(()=>"Loose non-PT boards = ".concat(r," → boxes = ceil((boards × 25 / 2500) × 1.4)"),[r]),E=(0,l.useMemo)(()=>"Bracing pieces = panels × 3 (panels: ".concat(s,")"),[r]);return(0,t.jsx)("div",{className:"ew-card",children:(0,t.jsxs)(p.default,{title:n,defaultOpen:!0,summary:(0,t.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",color:"#f18d5b"},children:["Nails & Bracing subtotal: ",er(L)]}),children:[(0,t.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":ed},children:[(0,t.jsx)("div",{children:"Item"}),(0,t.jsx)("div",{children:"Vendor · Family · Size"}),(0,t.jsx)("div",{className:"ew-right",children:"Qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,t.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,t.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{})]}),(0,t.jsxs)("div",{className:"ew-rows",children:[(0,t.jsx)(em,{label:"Concrete nails",row:w,picker:B,hint:I}),(0,t.jsx)(em,{label:"Sheathing nails",row:j,picker:C,hint:q}),(0,t.jsx)(em,{label:"Framing nails",row:P,picker:M,hint:W}),(0,t.jsx)(em,{label:"Temporary Bracing",row:S,picker:T,hint:E})]}),(0,t.jsx)("div",{className:"ew-footer",children:(0,t.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",color:"#f18d5b"},children:["Section subtotal: ",er(L)]})})]})})}function ep(){var e,t;return{id:(null==(t=crypto)||null==(e=t.randomUUID)?void 0:e.call(t))||"lvl-"+Math.random().toString(36).slice(2,8),name:""}}function ex(e){let{onGrandTotal:a}=e,[i,s]=(0,l.useState)({}),r=(0,l.useCallback)(e=>{let{id:t,sheetsExt:l=0,sheetsBand:n=0,sheetsExtra:a=0,platePiecesTotal:i=0,ptPieces:r=0}=e,o={sheetsExt:Number(l)||0,sheetsBand:Number(n)||0,sheetsExtra:Number(a)||0,platePiecesTotal:Number(i)||0,ptPieces:Number(r)||0};s(e=>{let l=e[t];return l&&l.sheetsExt===o.sheetsExt&&l.sheetsBand===o.sheetsBand&&l.sheetsExtra===o.sheetsExtra&&l.platePiecesTotal===o.platePiecesTotal&&l.ptPieces===o.ptPieces?e:{...e,[t]:o}})},[]),[o,c]=(0,l.useState)(0),[d,m]=(0,l.useState)(0),[h,p]=(0,l.useState)({}),x=(0,l.useCallback)(e=>{let{id:t,lf:l}=e;p(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),b=(0,l.useMemo)(()=>Object.values(h).reduce((e,t)=>e+(Number(t)||0),0),[h]),[g,v]=(0,l.useState)({}),N=(0,l.useCallback)(e=>{let{id:t,len:l}=e;v(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),y=(0,l.useMemo)(()=>{let e=Object.values(g).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[g]),[w,j]=(0,n.useLocalStorageJson)("inv:v1:levels",[{id:"level-1",name:"Level 1"}]);(0,l.useEffect)(()=>{if(!Array.isArray(w)||0===w.length)return void j([{id:ep().id,name:"Level 1"}]);let e=new Set,t=w.map(e=>({id:(null==e?void 0:e.id)||ep().id,name:(null==e?void 0:e.name)||""})).filter(t=>!e.has(t.id)&&(e.add(t.id),!0)).map((e,t)=>({...e,name:e.name||"Level ".concat(t+1)}));t.length===w.length&&t.every((e,t)=>e.id===w[t].id&&e.name===w[t].name)||j(t)},[]);let[f,P]=(0,l.useState)({}),[S,L]=(0,l.useState)({}),F=(0,l.useCallback)(()=>{let e=w.length+1,t=ep();t.name="Level ".concat(e),j(e=>[...e,t])},[w,j]),k=(0,l.useCallback)(e=>{j(t=>t.filter(t=>t.id!==e)),s(t=>{let l={...t};return delete l[e],l}),L(t=>{let l={...t};return delete l[e],l}),P(t=>{let l={...t};return delete l[e],l}),p(t=>{let l={...t};return delete l[e],l}),v(t=>{let l={...t};return delete l[e],l}),R(t=>{let l={...t};return delete l[e],l}),V(t=>{let l={...t};return delete l[e],l}),$(t=>{let l={...t};return delete l[e],l})},[j]),B=(0,l.useCallback)(e=>{let{id:t,subtotal:l}=e;L(e=>e[t]===l?e:{...e,[t]:l})},[]),C=(0,l.useCallback)(e=>{let{id:t,total:l}=e;P(e=>e[t]===l?e:{...e,[t]:l})},[]),M=(0,l.useMemo)(()=>Object.values(S).reduce((e,t)=>e+(Number(t)||0),0),[S]),T=(0,l.useMemo)(()=>Object.values(f).reduce((e,t)=>e+(Number(t)||0),0)+M+Number(o||0),[f,M,o]);(0,l.useEffect)(()=>{"function"==typeof a&&a(T)},[T,a]);let I=(0,l.useMemo)(()=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),[]),[q,W]=(0,l.useState)({exteriorWalls:{lf:0,panels:0},interiorShear:{lf:0,panels:0},interiorBlockingOnly:{lf:0,panels:0},interiorNonLoad:{lf:0,panels:0},kneeWall:{lf:0,panels:0},windows:{qty:0},exteriorDoors:{qty:0},blocking2x10:{rows:0}}),[E,D]=(0,l.useState)({}),[A,R]=(0,l.useState)({}),O=(0,l.useCallback)(e=>{let{id:t,lf:l}=e;R(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),z=(0,l.useMemo)(()=>Object.values(A).reduce((e,t)=>e+(Number(t)||0),0),[A]),[U,V]=(0,l.useState)({}),H=(0,l.useCallback)(e=>{let{id:t,len:l}=e;V(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),K=(0,l.useMemo)(()=>{let e=Object.values(U).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[U]);(0,l.useMemo)(()=>{let e=Object.values(E).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[E]);let[G,Q]=(0,l.useState)({}),_=(0,l.useCallback)(e=>{let{id:t,len:l}=e;Q(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),Z=(0,l.useMemo)(()=>{let e=Object.values(G).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[G]),[J,$]=(0,l.useState)({}),X=(0,l.useCallback)(e=>{let{id:t,lf:l}=e;$(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),Y=(0,l.useMemo)(()=>Object.values(J).reduce((e,t)=>e+(Number(t)||0),0),[J]),[et,el]=(0,l.useState)({}),en=(0,l.useCallback)(e=>{let{id:t,lf:l}=e;el(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),ea=(0,l.useMemo)(()=>Object.values(et).reduce((e,t)=>e+(Number(t)||0),0),[et]),[es,er]=(0,l.useState)({}),eo=(0,l.useCallback)(e=>{let{id:t,lf:l}=e;er(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),eu=(0,l.useMemo)(()=>Object.values(es).reduce((e,t)=>e+(Number(t)||0),0),[es]),ec=(0,l.useMemo)(()=>Object.values(i).reduce((e,t)=>e+(Number(null==t?void 0:t.sheetsExt)||0),0),[i]),ed=(0,l.useMemo)(()=>Object.values(i).reduce((e,t)=>e+(Number(null==t?void 0:t.sheetsBand)||0),0),[i]),em=(0,l.useMemo)(()=>Object.values(i).reduce((e,t)=>e+(Number(null==t?void 0:t.sheetsExtra)||0),0),[i]),ex=(0,l.useMemo)(()=>Object.values(i).reduce((e,t)=>e+(Number(null==t?void 0:t.platePiecesTotal)||0),0),[i]),eb=(0,l.useMemo)(()=>Object.values(i).reduce((e,t)=>e+(Number(null==t?void 0:t.ptPieces)||0),0),[i]),eg=(0,l.useMemo)(()=>({panelsAll:Number(d||0),platePiecesAll:ex,ptPiecesAll:eb,sheetsExtAll:ec,sheetsBandAll:ed,sheetsExtraAll:em}),[d,ex,ec,ed,em,eb]);return(0,t.jsxs)("div",{className:"app-content",children:[(0,t.jsxs)("div",{className:"ew-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsx)("h1",{className:"ew-h2 nova-flat-turquoise",style:{margin:0,flexShrink:0},children:"Wall Panels"}),(0,t.jsxs)("div",{className:"ew-right nova-flat-turquoise",style:{fontSize:"1.25rem"},title:"Sum of all levels (panels + loose)",children:["Grand total: ",I.format(Number(T)||0)]})]}),w.map((e,l)=>(0,t.jsx)(ee,{id:e.id,name:e.name||"Level ".concat(l+1),onRemove:w.length>1?()=>k(e.id):void 0,onLooseTotal:B,onLevelTotal:C,onExteriorLF:x,onExteriorPanelLenChange:N,onInteriorShearLF:O,onInteriorShearPanelLenChange:H,onInteriorBearingLF:X,onInteriorBearingPanelLenChange:_,onInteriorNonLoadLF:en,onKneeWallLF:eo,levelsCount:w.length,panelsTotalAllSections:d,onLooseGeneralChange:r},e.id)),(0,t.jsxs)("div",{className:"ew-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsx)("div",{className:"ew-subtle",children:"Add another floor (mirrors functionality; you can input different quantities)"}),(0,t.jsx)(u,{onClick:F,title:"Add wall",label:"Add wall"})]}),(0,t.jsx)("div",{children:(0,t.jsx)(eh,{title:"General — Nails & Bracing (all levels)",totals:eg})}),(0,t.jsx)(ei,{rows:q,panelLenFt:8,panelLenFtExterior:y,panelLenFtInterior:K,exteriorLF:b,interiorShearLF:z,onInteriorBearingLF:X,interiorBlockingLF:Y,interiorNonLoadLF:ea,kneeWallLF:eu,onTotalChange:e=>{let{total:t,panels:l}=e;c(Number(t)||0),m(Number(l)||0)},panelLenFtInteriorBlocking:Z})]})}let eb="summary:project";function eg(e){let{grandTotal:n=0}=e,[a,i]=(0,l.useState)({projectName:"",address:"",drawingsDate:"",estimateDate:""});(0,l.useEffect)(()=>{try{let e=localStorage.getItem(eb);e&&i(JSON.parse(e))}catch(e){}},[]),(0,l.useEffect)(()=>{if(!a.estimateDate){let e=new Date,t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())).toISOString().slice(0,10);i(e=>({...e,estimateDate:t}))}},[a.estimateDate]),(0,l.useEffect)(()=>{try{localStorage.setItem(eb,JSON.stringify(a))}catch(e){}},[a]);let s=(0,l.useMemo)(()=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",currencyDisplay:"narrowSymbol"}),[]),r=e=>i(t=>({...t,[e.target.name]:e.target.value}));return(0,t.jsxs)("section",{className:"card",children:[(0,t.jsx)("h2",{className:"card-title",children:"Summary"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsxs)("label",{className:"fld",children:[(0,t.jsx)("span",{children:"Project name"}),(0,t.jsx)("input",{name:"projectName",value:a.projectName,onChange:r})]}),(0,t.jsxs)("label",{className:"fld",children:[(0,t.jsx)("span",{children:"Address"}),(0,t.jsx)("input",{name:"address",value:a.address,onChange:r})]}),(0,t.jsxs)("label",{className:"fld",children:[(0,t.jsx)("span",{children:"Drawings date"}),(0,t.jsx)("input",{type:"date",name:"drawingsDate",value:a.drawingsDate,onChange:r})]}),(0,t.jsxs)("label",{className:"fld",children:[(0,t.jsx)("span",{children:"Estimate date"}),(0,t.jsx)("input",{type:"date",name:"estimateDate",value:a.estimateDate,onChange:r})]})]}),(0,t.jsxs)("div",{className:"sum-row",children:[(0,t.jsx)("div",{className:"sum-label",children:"Wall panels grand total"}),(0,t.jsx)("div",{className:"sum-value",children:s.format(Number(n||0))})]})]})}function ev(){let{projectsList:e,fetchProjectsList:n,createNewProject:i,loadProject:s,isListLoading:r,isSaving:o,appId:u,projectId:c}=(0,a.useProject)(),[d,m]=(0,l.useState)(""),h=u&&"default-app-id"!==u;(0,l.useEffect)(()=>{},[n,r,h]);let p=async e=>{if(e.preventDefault(),!d.trim()||o||!h)return;let t=await i(d);t?(m(""),s(t),console.log("Created and loading project:",t)):console.error("Failed to create project")},x=e=>{e!==c&&h&&(console.log("Load project clicked:",e),s(e))};return(0,t.jsxs)("div",{className:"app-content",children:[(0,t.jsx)("div",{className:"ew-card",children:(0,t.jsx)("h2",{className:"ew-h2 nova-flat-turquoise",style:{margin:0},children:"Projects Management"})}),(0,t.jsxs)("div",{className:"ew-card",children:[(0,t.jsx)("h3",{className:"ew-h3",children:"Create New Project"}),(0,t.jsxs)("form",{onSubmit:p,className:"ew-inline",style:{alignItems:"stretch",gap:"8px"},children:[(0,t.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"New project name...",className:"ew-input",style:{flexGrow:1},disabled:o||!h,"aria-label":"New project name"}),(0,t.jsxs)("button",{type:"submit",className:"ew-btn ew-btn--turq",disabled:!d.trim()||o||!h,children:[" ",o?"Creating...":"Create Project"]})]}),!h&&(0,t.jsx)("p",{className:"ew-subtle",style:{color:"orange",marginTop:"8px"},children:"Waiting for App ID configuration..."})]}),(0,t.jsxs)("div",{className:"ew-card",children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[(0,t.jsx)("h3",{className:"ew-h3",style:{margin:0},children:"Existing Projects"}),(0,t.jsxs)("button",{onClick:n,className:"ew-btn",style:{padding:"4px 8px"},disabled:r||!h,children:[" ",r?"Refreshing...":"Refresh"]})]}),h?r&&0===e.length?(0,t.jsx)("p",{className:"ew-subtle",children:"Loading projects..."}):0===e.length?(0,t.jsx)("p",{className:"ew-subtle",children:"No projects found. Create one above."}):(0,t.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:e.map(e=>(0,t.jsx)("li",{style:{marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid var(--border-color)"},children:(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"10px"},children:[(0,t.jsxs)("div",{style:{flexGrow:1,overflow:"hidden"},children:[(0,t.jsxs)("button",{onClick:()=>x(e.id),style:{background:"none",border:"none",padding:0,margin:0,color:e.id===c?"var(--text-primary)":"var(--text-accent)",textAlign:"left",cursor:"pointer",fontWeight:e.id===c?"bold":"normal",fontSize:"1em",fontFamily:"inherit",textDecoration:"underline"},title:"Load project: ".concat(e.name),disabled:!h,children:[e.name," ",e.id===c?"(Loaded)":""]}),(0,t.jsxs)("div",{className:"ew-subtle",style:{fontSize:"11px",marginTop:"2px",whiteSpace:"nowrap"},children:["Last updated: ",e.updatedAt?e.updatedAt.toLocaleString():"N/A"]})]}),(0,t.jsx)("button",{onClick:()=>x(e.id),className:"ew-btn",disabled:e.id===c||!h,style:{flexShrink:0},children:e.id===c?"Currently Loaded":"Load Project"})]})},e.id))}):(0,t.jsx)("p",{className:"ew-subtle",children:"App configuration loading..."})]})]})}function eN(){let{signIn:e,loading:l}=(0,i.useAuth)();return(0,t.jsx)("div",{className:"app-content",children:(0,t.jsxs)("div",{className:"ew-card",style:{maxWidth:"400px",margin:"auto",textAlign:"center",marginTop:"50px"},children:[(0,t.jsx)("h2",{className:"ew-h2 nova-flat-turquoise",children:"Welcome to the Inventory Estimator"}),(0,t.jsx)("p",{className:"ew-subtle",style:{margin:"15px 0"},children:"Please sign in with your Google account to create and manage your project estimates."}),(0,t.jsxs)("button",{onClick:e,className:"ew-btn ew-btn--turq",disabled:l,style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"10px 15px",fontSize:"1em"},children:[(0,t.jsx)("img",{src:"/icons/google.png",alt:"",width:18,height:18}),"Sign in with Google"]})]})})}function ey(){let[e,s]=(0,n.useLocalStorageJson)("inv:v1:ui",{collapsed:!1,active:"project",currentProjectId:null}),{collapsed:o,active:u,currentProjectId:c}=e,{user:d,loading:m}=(0,i.useAuth)(),h=(0,l.useRef)(d),[p,x]=(0,l.useState)(0),b=(0,l.useCallback)(e=>{s(t=>({...t,active:e}))},[s]);(0,l.useEffect)(()=>{!h.current&&d&&(console.log("User logged in, switching to Project view."),b("project")),h.current=d},[d,b]);let g=(0,l.useCallback)(e=>{s(t=>({...t,collapsed:!!e}))},[s]);(0,l.useCallback)(e=>{s(t=>({...t,currentProjectId:e}))},[s]);let v=(0,l.useMemo)(()=>{if(m)return(0,t.jsx)("div",{className:"app-content",children:(0,t.jsx)("div",{className:"ew-card",children:"Loading Authentication..."})});if(!d)return(0,t.jsx)(eN,{});switch(u){case"project":return(0,t.jsx)(ev,{});case"summary":return(0,t.jsx)("div",{className:"app-content",children:(0,t.jsx)(eg,{grandTotal:p})});case"wallpanels":return(0,t.jsx)(ex,{onGrandTotal:x});default:return(0,t.jsx)("div",{className:"app-content",children:(0,t.jsxs)("div",{className:"ew-card",children:[(0,t.jsx)("h2",{className:"ew-h2",style:{marginTop:0},children:{auth:"Login / Logout",trusses:"Trusses",loose:"Loose Material",labor:"Labor",takeoff:"Takeoff list",quote:"Quote (QuickBooks)",export:"Export"}[u]||"Section"}),(0,t.jsx)("div",{className:"ew-subtle",children:"Coming soon…"})]})})}},[u,p,c,d,m]);return(0,t.jsx)(a.ProjectProvider,{initialProjectId:c,children:(0,t.jsxs)("div",{className:"app-shell ".concat(o?"sb-collapsed":""),children:[(0,t.jsx)(r,{active:u,collapsed:o,onChange:b,onCollapsedChange:g}),(0,t.jsx)("main",{className:"app-main",children:v})]})})}}]);