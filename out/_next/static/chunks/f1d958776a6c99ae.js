(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6279,e=>{"use strict";e.s(["default",()=>o],6279);var t=e.i(43476),l=e.i(71645),n=e.i(21052);e.i(36180);var i=e.i(98925);async function a(){return(await (0,i.getDocs)((0,i.query)((0,i.collection)(n.db,"priceLists"),(0,i.orderBy)("displayName")))).docs.map(e=>{var t;return{id:e.id,displayName:(null==(t=e.data())?void 0:t.displayName)||e.id}})}async function s(e){let t=(0,i.collection)(n.db,"priceLists",e,"items"),l=await (0,i.getDocs)((0,i.query)(t,(0,i.orderBy)("familySlug"),(0,i.limit)(5e3))),a=new Map;l.forEach(e=>{let t=e.data()||{};t.familySlug&&a.set(t.familySlug,t.familyDisplay||t.familySlug)});let s=Array.from(a.entries()).map(e=>{let[t,l]=e;return{slug:t,label:l}});return s.sort((e,t)=>e.label.localeCompare(t.label,void 0,{numeric:!0})),s}async function u(e,t){let l=(0,i.query)((0,i.collection)(n.db,"priceLists",e,"items"),(0,i.where)("familySlug","==",t)),a=(await (0,i.getDocs)(l)).docs.map(e=>{var t,l,n;let i=e.data()||{};return{id:e.id,sizeSlug:i.sizeSlug||e.id,sizeLabel:i.sizeDisplay||i.sizeSlug||e.id,unit:i.unit||"",supplierPrice:null!=(t=i.basePrice)?t:null,markupPct:null!=(l=i.markupPct)?l:null,priceWithMarkup:null!=(n=i.priceWithMarkup)?n:null,raw:i}}),s=new Map;for(let e of a)s.has(e.sizeSlug)||s.set(e.sizeSlug,e);return Array.from(s.values()).sort((e,t)=>e.sizeLabel.localeCompare(t.sizeLabel,void 0,{numeric:!0}))}function r(e){var n;let{value:i,onChange:a,options:s=[],placeholder:u="Select…",disabled:r=!1,loading:c=!1,ariaLabel:o}=e,d=(0,l.useId)(),m="".concat(d,"-listbox"),p=(0,l.useRef)(null),h=(0,l.useRef)(null),[f,b]=(0,l.useState)(!1),[g,v]=(0,l.useState)(""),[y,x]=(0,l.useState)(0),w=(0,l.useMemo)(()=>s.find(e=>String(e.value)===String(i)),[s,i]),N=(0,l.useMemo)(()=>{let e=(g||"").trim().toLowerCase();return e?s.filter(t=>(t.label||"").toLowerCase().includes(e)):s},[s,g]),j=(0,l.useMemo)(()=>w?[{value:"__CLEAR__",label:"✖ Clear selection"},...N]:N,[N,w]);function P(e){if(e){if("__CLEAR__"===e.value){var t;null==a||a(null!=(t=null==e?void 0:e.value)?t:""),b(!1),v("");return}e.value!==i&&(null==a||a(e.value)),b(!1),v(e=>""===e?e:"")}}(0,l.useEffect)(()=>{if(!j.length)return void x(e=>-1===e?e:-1);(y<0||y>=j.length)&&x(0)},[j,y]),(0,l.useEffect)(()=>{function e(e){h.current&&(h.current.contains(e.target)||b(!1))}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,l.useEffect)(()=>{f&&!g&&(null==w?void 0:w.label)&&(v(e=>e===w.label?e:w.label),requestAnimationFrame(()=>{let e=p.current;e&&e.setSelectionRange(e.value.length,e.value.length)}))},[f,w,g]),(0,l.useEffect)(()=>{x(0),f&&v("")},[s,f]);let S=f?g:null!=(n=null==w?void 0:w.label)?n:"";return(0,t.jsxs)("div",{ref:h,className:"combo",role:"combobox","aria-expanded":f,"aria-haspopup":"listbox","aria-owns":m,"aria-controls":m,children:[(0,t.jsx)("input",{ref:p,type:"text",className:"ew-select combo-input",placeholder:c?"Loading…":u,value:S,onChange:function(e){v(e.target.value),f||b(!0)},onFocus:function(){r||b(!0)},onKeyDown:function(e){if(!f&&("ArrowDown"===e.key||"Enter"===e.key))return void b(!0);if(f)if("ArrowDown"===e.key){if(e.preventDefault(),!j.length)return;x(e=>Math.min(e+1,j.length-1))}else if("ArrowUp"===e.key){if(e.preventDefault(),!j.length)return;x(e=>Math.max(e-1,0))}else"Enter"===e.key?(e.preventDefault(),j.length&&y>=0&&P(j[y])):"Escape"===e.key&&(e.preventDefault(),b(!1),v(e=>""===e?e:""))},"aria-autocomplete":"list","aria-controls":m,"aria-label":o,disabled:r||c,autoComplete:"off",spellCheck:"false"}),(0,t.jsx)("div",{className:"combo-caret","aria-hidden":!0}),f&&(0,t.jsx)("ul",{id:m,role:"listbox",className:"combo-list",children:c?(0,t.jsx)("li",{className:"combo-empty",children:"Loading…"}):j.length?j.map((e,l)=>(0,t.jsx)("li",{role:"option","aria-selected":"__CLEAR__"!==e.value&&String(i)===String(e.value),className:"combo-option"+(l===y?" active":"")+("__CLEAR__"===e.value?" danger":""),onPointerDown:t=>{t.preventDefault(),P(e)},onMouseEnter:()=>x(l),onMouseDown:e=>{e.preventDefault()},title:e.label,children:e.label},"".concat(e.value,"-").concat(l))):(0,t.jsx)("li",{className:"combo-empty",children:"No matches"})})]})}let c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return String(e).toLowerCase().replace(/[^a-z0-9]+/g," ").trim()};function o(e){let{onSelect:n,compact:i=!1,defaultVendor:o="Gillies & Prittie Warehouse",defaultFamilyLabel:d,preferredSeries:m,defaultSizeLabel:p}=e,[h,f]=(0,l.useState)([]),[b,g]=(0,l.useState)([]),[v,y]=(0,l.useState)([]),[x,w]=(0,l.useState)(""),[N,j]=(0,l.useState)(""),[P,S]=(0,l.useState)(""),F=(0,l.useRef)(!1),L=(0,l.useRef)(""),k=(0,l.useRef)(""),C=(0,l.useRef)(""),q=(0,l.useRef)(""),R=(0,l.useRef)(!1),M=(0,l.useRef)(!1),E=(0,l.useRef)(!1),_=e=>w(t=>t===H(e)?t:H(e)),D=e=>j(t=>t===H(e)?t:H(e)),z=e=>S(t=>t===H(e)?t:H(e)),H=e=>""===e||null==e?"":String(e),I=(0,l.useRef)(""),A=(0,l.useRef)(n);(0,l.useEffect)(()=>{A.current=n},[n]),(0,l.useEffect)(()=>{let e=!0;return(async()=>{let t=await a();e&&f(t||[])})(),()=>{e=!1}},[]),(0,l.useEffect)(()=>{if(F.current||R.current||!h.length||x)return;let e=c(o),t=h.find(t=>c(t.displayName||t.id)===e),l=h.find(t=>c(t.displayName||"").includes(e)),n=h.find(e=>{let t=c(e.displayName||e.id);return t.includes("gillies")&&t.includes("prittie")}),i=t||l||n||h[0];F.current=!0,(null==i?void 0:i.id)&&_(i.id)},[h,x,o,_]),(0,l.useEffect)(()=>{let e=L.current;if(!x||x===e){L.current=x;return}let t=!!(N||P);N&&D(""),P&&z(""),g(e=>e.length?[]:e),k.current="",y(e=>e.length?[]:e),q.current="",E.current=!1,t&&A.current&&"null"!==I.current&&(I.current="null",A.current(null));let l=!0;return(async()=>{let e=await s(x);if(l&&(g(e||[]),!M.current&&C.current!==x&&(null==e?void 0:e.length))){let t=null;if(d){let l=c(d);t=e.find(e=>c(e.label)===l)||e.find(e=>c(e.label).includes(l))}t||(t=e.find(e=>{let t=c(e.label);return t.includes("spf")&&(t.includes("#2")||t.includes(" 2"))})||e[0]),C.current=x,(null==t?void 0:t.slug)&&D(t.slug)}})(),L.current=x,()=>{l=!1}},[x]),(0,l.useEffect)(()=>{if(!x||!N)return;let e="".concat(x,"::").concat(N,"::").concat(m||"");if(k.current===e)return;let t=!!P;t&&z(""),y(e=>e.length?[]:e),q.current="",E.current=!1,t&&A.current&&"null"!==I.current&&(I.current="null",A.current(null));let l=!0;return(async()=>{let t=await u(x,N);if(l&&(y(t||[]),!E.current&&q.current!==e&&(null==t?void 0:t.length))){let l=null;if(p){let e=c(p);l=t.find(t=>c(t.sizeLabel)===e)||t.find(t=>c(t.sizeLabel).includes(e))}if(!l&&m){let e=c(m).replace(/[^0-9x]/g,""),n=e=>c(String(e||"")).replace(/[^0-9x]/g,"");l=t.find(t=>n(t.sizeLabel).startsWith(e))||t.find(t=>n(t.sizeLabel).includes(e))}l||(l=t[0]),q.current=e,(null==l?void 0:l.id)&&z(l.id)}})(),k.current=e,()=>{l=!1}},[x,N,m,p]),(0,l.useEffect)(()=>{if(!P&&"null"!==I.current){var e;I.current="null",null==(e=A.current)||e.call(A,null)}},[P]);let B=(0,l.useMemo)(()=>{var e;if(!x||!N||!P)return null;let t=b.find(e=>String(e.slug)===String(N)),l=v.find(e=>String(e.id)===String(P));return t&&l?{vendorId:x,vendorName:(null==(e=h.find(e=>e.id===x))?void 0:e.displayName)||x,family:t.slug,familyLabel:t.label,item:l}:null},[x,N,P,h,b,v]);(0,l.useEffect)(()=>{let e=B?"".concat(x,"|").concat(N,"|").concat(P):"null";if(e!==I.current){var t;I.current=e,null==(t=A.current)||t.call(A,B)}},[B]);let T=(0,l.useCallback)(e=>{""===e&&(R.current=!0),_(e)},[_]),W=(0,l.useCallback)(e=>{if(""===e&&(M.current=!0,P&&z(""),y(e=>e.length?[]:e),"null"!==I.current)){var t;I.current="null",null==(t=A.current)||t.call(A,null)}D(e)},[P,z,D]),O=(0,l.useCallback)(e=>{""===e&&(E.current=!0),z(e)},[z]),U=(0,l.useMemo)(()=>h.map(e=>({value:String(e.id),label:e.displayName})),[h]),V=(0,l.useMemo)(()=>b.map(e=>({value:String(e.slug),label:e.label})),[b]),J=(0,l.useMemo)(()=>v.map(e=>({value:String(e.id),label:e.sizeLabel})),[v]),G=(0,t.jsx)(r,{ariaLabel:"Vendor",value:x,onChange:T,options:U,placeholder:"Select vendor…",disabled:!h.length}),K=(0,t.jsx)(r,{ariaLabel:"Family",value:N,onChange:W,options:V,placeholder:"Family…",disabled:!b.length}),Q=(0,t.jsx)(r,{ariaLabel:"Size",value:P,onChange:O,options:J,placeholder:"Size…",disabled:!v.length});return i?(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:6},children:[G,K,Q]}):(0,t.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[G,K,Q]})}},35492,e=>{"use strict";e.s(["useLocalStorageJson",()=>l]);var t=e.i(71645);function l(e,l){let[n,i]=(0,t.useState)(l),a=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{try{let t=localStorage.getItem(e);null!=t&&i(JSON.parse(t))}catch(e){}a.current=!0},[e]),(0,t.useEffect)(()=>{if(!a.current)return;let t=setTimeout(()=>{try{localStorage.setItem(e,JSON.stringify(n))}catch(e){}},250);return()=>clearTimeout(t)},[e,n]),[n,i]}},19439,21586,84959,40290,4071,18736,67340,53576,38873,4862,74469,58057,34336,64688,e=>{"use strict";e.s(["default",()=>T],19439);var t=e.i(43476),l=e.i(71645),n=e.i(6279),i=e.i(35492);e.s([],74469),e.s(["calcPlates",()=>c],84959),e.s(["applyWaste",()=>u,"norm",()=>a,"parseBoardLengthFt",()=>s,"unitPriceFrom",()=>r],21586);let a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return String(e).toLowerCase().replace(/[^a-z0-9# ]+/g," ").trim()};function s(e){let t=String(e||"").trim(),l="";for(let e=t.length-1;e>=0;e--){let n=t[e];if(n>="0"&&n<="9"){l=n+l;continue}if(l)break}return l?Number(l):null}function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.ceil(Number(e||0)*(1+Number(t||0)/100))}function r(e){var t,l,n,i,a,s,u,r,c,o,d;if(!e)return 0;let m=null!=(u=null!=(s=null!=(a=e.supplierPrice)?a:null==(t=e.raw)?void 0:t.basePrice)?s:null==(l=e.raw)?void 0:l.supplierPrice)?u:null,p=null!=(c=null!=(r=e.markupPct)?r:null==(n=e.raw)?void 0:n.markupPct)?c:null;return null!=m&&null!=p?Number(m)*(1+Number(p)/100):Number((null!=(d=null!=(o=e.priceWithMarkup)?o:null==(i=e.raw)?void 0:i.priceWithMarkup)?d:null)||0)}function c(e){let{lengthLF:t,boardLenFt:l,wastePct:n=0,item:i,unit:a="pcs"}=e,s=Number(t||0),c=Number(l||0),o=c>0?s/c:0,d=u(o,n),m=r(i),p=Number(m*d)||0;return{qtyRaw:o,qtyFinal:d,unit:a,unitPrice:m,subtotal:p,boardLenFt:c}}function o(e){let{lengthLF:t,spacingIn:l=16,multiplier:n=1,wastePct:i=0,item:a,unit:s="pcs"}=e,c=(Math.floor(12*Number(t||0)/Math.max(1,Number(l||16)))+1)*Math.max(1,Number(n||1)),o=u(c,i),d=r(a),m=Number(d*o)||0;return{qtyRaw:c,qtyFinal:o,unit:s,unitPrice:d,subtotal:m}}function d(e){let{lengthLF:t,heightFt:l,boardLenFt:n,wastePct:i=0,item:a,unit:s="pcs"}=e,c=Number(t||0),o=Number(l||0),d=Number(n||0),m=(d>0?c/d:0)*Math.max(0,Math.ceil(o/4)-1),p=u(m,i),h=r(a),f=Number(h*p)||0;return{qtyRaw:m,qtyFinal:p,unit:s,unitPrice:h,subtotal:f}}function m(e){let{lengthLF:t,heightFt:l,wastePct:n=0,item:i,unit:a="sheet"}=e,s=Number(t||0)*Number(l||0)/32,c=u(s,n),o=r(i),d=Number(o*c)||0;return{qtyRaw:s,qtyFinal:c,unit:a,unitPrice:o,subtotal:d}}function p(e){let{isLVL:t,headerLF:l,lvlPieces:n,lvlLength:i,boardLenFt:a,wastePct:s=5,item:c}=e,o=0,d="pcs";t?(o=Number(n||0)*Number(i||0),d="lf"):(o=Number(a||0)?Number(l||0)/Number(a):0,d="pcs");let m=u(o,s),p=r(c),h=Number(p*m)||0;return{qtyRaw:o,qtyFinal:m,unit:d,unitPrice:p,subtotal:h}}function h(e){let{isLinearLF:t,pieces:l,heightFt:n,piecesPerPost:i,numPosts:a,wastePct:s=5,item:c}=e,o=0,d="pcs";t?(o=Number(l||0)*Number(n||0),d="lf"):(o=Number(i||0)*Number(a||0),d="pcs");let m=u(o,s),p=r(c),h=Number(p*m)||0;return{qtyRaw:o,qtyFinal:m,unit:d,unitPrice:p,subtotal:h}}function f(e){let{headerLFPool:t,wastePct:l=5,item:n,unit:i="sheet"}=e,a=Number(t||0)/3/32*2,s=u(a,l),c=r(n),o=Number(c*s)||0;return{qtyRaw:a,qtyFinal:s,unit:i,unitPrice:c,subtotal:o}}function b(e){let{lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function g(e){let{lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function v(e){let{panelBandLF:t,bandHeightFt:l,item:n,unit:i="sheet",wastePct:a=10}=e;return{...m({lengthLF:t,heightFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function y(e){let{extLengthLF:t,bandHeightFt:l,item:n,unit:i="sheet",wastePct:a=10}=e;return{...m({lengthLF:t,heightFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function x(e){let{openingsLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function w(e){let{lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function N(e){let{lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function j(e){let{lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function P(e){let{lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function S(e){let{lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}function F(e){let{blockingLF:t,boardLenFt:l,item:n,unit:i,wastePct:a=10}=e;return{...c({lengthLF:t,boardLenFt:l,item:n,unit:i,wastePct:a}),wastePct:a}}new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),e.s(["calcStuds",()=>o],40290),e.s(["calcBlocking",()=>d],4071),e.s(["calcSheathing",()=>m],18736),e.s(["calcHeader",()=>p],67340),e.s(["calcPost",()=>h],53576),e.s(["calcHeadersInfill",()=>f],38873),e.s(["looseCabinetBlocking",()=>F,"looseExtBottomPlates",()=>b,"looseExtTopPlates",()=>g,"looseExtraSheathing",()=>y,"looseInt2x4PTPlates",()=>P,"looseInt2x4Plates",()=>S,"looseInt2x6PTPlates",()=>N,"looseInt2x6Plates",()=>j,"looseOpeningsBlocking",()=>x,"loosePanelBandSheathing",()=>v,"looseSecondBottomPlate",()=>w],4862),e.s(["isInfillFamily",()=>R,"isLVL",()=>L,"isLumberFamily",()=>q,"isVersaColumn",()=>k],58057);let L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a(e).includes("lvl")},k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a(e).includes("versa")},C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=a(e);return t.includes("spf#2")||t.includes("spf2")||t.includes("syp#2")||t.includes("syp2")||t.includes("syp#1")||t.includes("syp1")||"pt"===t||t.includes("treated")},q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return C(e)||a(e).includes("frt")||a(e).includes("fire rated lumber")||a(e).includes("douglas fir")||a(e).includes("pt")||a(e).includes("hem fir")||a(e).includes("hemfir")},R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=a(e);return t.includes("spf#2")||t.includes("spf2")||"pt"===t||t.includes("treated")||t.includes("hem fir")||t.includes("hemfir")||t.includes("syp#2")||t.includes("syp2")||t.includes("syp#1")||t.includes("syp1")||t.includes("frt")||t.includes("fire rated lumber")||t.includes("douglas fir")};function M(e){let{title:n,bar:i,summary:a,header:s,actions:u,defaultOpen:r=!0,open:c,onOpenChange:o,hideHeaderWhenCollapsed:d=!1,children:m,className:p=""}=e,h="boolean"==typeof c,[f,b]=(0,l.useState)(!!r),g=h?c:f,v=(0,l.useCallback)(e=>{let t="function"==typeof e?e(g):!!e;h||b(t),null==o||o(t)},[h,o,g]),y=(0,l.useCallback)(()=>v(!g),[v,g]),x=(0,l.useRef)(null),w=(0,l.useId)();(0,l.useEffect)(()=>{let e=x.current;if(!e)return;let t=e.scrollHeight;e.style.maxHeight=g?"".concat(t,"px"):"0px",e.style.opacity=g?"1":"0",e.setAttribute("aria-hidden",g?"false":"true")},[g,m]);let N=e=>"function"==typeof e?e({open:g,toggle:y,id:w}):e,j=N(i),P=N(a),S=N(s);return(0,t.jsxs)("section",{className:"acc ".concat(g?"acc--open":""," ").concat(p),children:[j?(0,t.jsx)("div",{className:"acc__summary",children:j}):(0,t.jsxs)(t.Fragment,{children:[(g||!d)&&(0,t.jsxs)("div",{className:"acc__header",style:{display:"flex",alignItems:"center",gap:8},children:[(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1},children:g&&S?S:(0,t.jsxs)("button",{type:"button",className:"acc__button","aria-expanded":g,"aria-controls":w,onClick:y,title:g?"Collapse":"Expand",children:[(0,t.jsx)("img",{src:g?"/icons/down.png":"/icons/minimize.png",alt:g?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}}),(0,t.jsx)("span",{className:"acc__title",children:n})]})}),u?(0,t.jsx)("div",{className:"acc__actions",children:u}):null]}),!g&&P?(0,t.jsx)("div",{className:"acc__summary",children:P}):null]}),(0,t.jsx)("div",{id:w,ref:x,className:"acc__body",children:(0,t.jsx)("div",{className:"acc__bodyInner",children:m})})]})}function E(e){let{onClick:l,size:n=20,title:i="Remove",label:a="Remove",src:s="/icons/trash.png",className:u="",disabled:r=!1}=e;return(0,t.jsx)("button",{type:"button",className:"ew-btn ew-icon-btn ".concat(u),onClick:l,"aria-label":a,title:i,disabled:r,children:(0,t.jsx)("img",{src:s,width:n,height:n,alt:""})})}e.s(["default",()=>M],34336),e.s(["default",()=>E],64688);let _=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),D=e=>Number.isFinite(Number(e))?_.format(Number(e)):"—",z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,l=String(e).trim().split(/\s+/),n=l.slice(0,t).join(" ");return l.length>t?"".concat(n,"…"):n||""},H=e=>e&&e.item?H(e.item):e,I=e=>H(e),A=e=>{var t,l,n;return(null==(t=H(e))?void 0:t.unit)||(null==(n=H(e))||null==(l=n.raw)?void 0:l.unit)||"pcs"},B=e=>{var t,l,n,i;return(null==(t=H(e))?void 0:t.sizeDisplay)||(null==(l=H(e))?void 0:l.sizeLabel)||(null==(i=H(e))||null==(n=i.raw)?void 0:n.sizeDisplay)||""};function T(e){var a,u,r,b,g,v,y,x;let{onStatsChange:w,title:N="Exterior walls",onRemove:j,persistKey:P="exterior-0",bottomDefaultFamily:S="SPF#2"}=e,F=(0,l.useRef)(""),[C,_]=(0,l.useState)(0),[H,T]=(0,l.useState)(String(C)),[W,O]=(0,l.useState)(12),[U,V]=(0,l.useState)(16),[J,G]=(0,l.useState)(1),[K,Q]=(0,l.useState)({bottomPlate:10,topPlate:10,studs:60,blocking:10,sheathing:20}),[X,Y]=(0,l.useState)({bottomPlate:null,topPlate:null,studs:null,blocking:null,sheathing:null}),[Z,$]=(0,i.useLocalStorageJson)("inv:v1:notes:".concat(P),{}),ee=e=>Z[e]||{plan:"",comment:"",open:!1},et=(e,t)=>$(l=>({...l,[e]:{...ee(e),...t}})),el=e=>et(e,{open:!ee(e).open}),en=s(B(X.bottomPlate)),ei=null!=en?en:12,ea=Number.isFinite(en)?en:0;(0,l.useEffect)(()=>{T(String(C))},[C]);let es=()=>{_(Number(H)||0)},eu=null!=(g=s(B(X.topPlate)))?g:12,er=null!=(v=s(B(X.blocking)))?v:12,ec=e=>e&&e.item?ec(e.item):e,eo=e=>{var t,l,n,i,a,s,u;let r=ec(e);return String(null!=(u=null!=(s=null!=(a=null!=(i=null!=(n=null==r?void 0:r.familyLabel)?n:null==r?void 0:r.familyDisplay)?i:null==r||null==(t=r.raw)?void 0:t.familyDisplay)?a:null==r||null==(l=r.raw)?void 0:l.familyLabel)?s:null==r?void 0:r.family)?u:"").toLowerCase()},ed=(0,l.useMemo)(()=>{var e,t,l,n,i,a,s,u,r,p;let h=[];{let l=c({lengthLF:C,boardLenFt:ei,wastePct:null!=(e=K.bottomPlate)?e:0,item:I(X.bottomPlate),unit:A(X.bottomPlate)});h.push({key:"bottomPlate",label:"Bottom plate",item:I(X.bottomPlate),unit:l.unit,qtyRaw:l.qtyRaw,qtyFinal:l.qtyFinal,unitPrice:l.unitPrice,subtotal:l.subtotal,wastePct:null!=(t=K.bottomPlate)?t:0})}{let e=c({lengthLF:C,boardLenFt:eu,wastePct:null!=(l=K.topPlate)?l:0,item:I(X.topPlate),unit:A(X.topPlate)});h.push({key:"topPlate",label:"Top plate",item:I(X.topPlate),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(n=K.topPlate)?n:0})}{let e=o({lengthLF:C,spacingIn:U,multiplier:J,wastePct:null!=(i=K.studs)?i:0,item:I(X.studs),unit:A(X.studs)});h.push({key:"studs",label:"Studs",item:I(X.studs),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(a=K.studs)?a:0})}{let e=d({lengthLF:C,heightFt:W,boardLenFt:er,wastePct:null!=(s=K.blocking)?s:0,item:I(X.blocking),unit:A(X.blocking)});h.push({key:"blocking",label:"Blocking",item:I(X.blocking),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(u=K.blocking)?u:0})}{let e=m({lengthLF:C,heightFt:W,wastePct:null!=(r=K.sheathing)?r:0,item:I(X.sheathing),unit:A(X.sheathing)||"sheet"});h.push({key:"sheathing",label:"Sheathing",item:I(X.sheathing),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(p=K.sheathing)?p:0})}return h},[X,K,C,W,U,J,ei,eu,er]),em=(0,l.useMemo)(()=>Object.fromEntries(ed.map(e=>[e.key,e])),[ed]),ep=(0,l.useMemo)(()=>{let e=ed.find(e=>"sheathing"===e.key);return Math.ceil(Number((null==e?void 0:e.qtyFinal)||0))},[ed]),eh=/pt/i.test(eo(X.bottomPlate))?Math.ceil(Number((null==em||null==(a=em.bottomPlate)?void 0:a.qtyFinal)||0)):0,ef=(null!=ed?ed:[]).find(e=>"sheathing"===e.key||/sheathing/i.test(e.label||"")),eb=/zip/.test(eo(null==ef?void 0:ef.item))?Math.ceil(Number((null==ef?void 0:ef.qtyFinal)||0)):0,eg=(null!=(y=null==em||null==(u=em.bottomPlate)?void 0:u.qtyFinal)?y:0)+(null!=(x=null==em||null==(r=em.topPlate)?void 0:r.qtyFinal)?x:0),ev=Number(C||0),[ey,ex]=(0,l.useState)([]),ew=(0,l.useRef)(1),eN=e=>ex(t=>[...t,{id:"x".concat(ew.current++),type:e,item:null,wastePct:5,inputs:{}}]),ej=(e,t)=>ex(l=>l.map(l=>l.id===e?{...l,...t}:l));(0,l.useEffect)(()=>{let e=ey.filter(e=>"Header"===e.type&&R(eo(e))).reduce((e,t)=>e+Number(t.inputs.headerLF||0),0),t=ey.some(e=>"Headers infill"===e.type);e>0&&!t&&ex(e=>[...e,{id:"infill",type:"Headers infill",item:null,wastePct:5,inputs:{}}]),0===e&&t&&ex(e=>e.filter(e=>"Headers infill"!==e.type))},[JSON.stringify(ey.map(e=>({t:e.type,f:eo(e),lf:e.inputs.headerLF||0})))]);let eP=(0,l.useMemo)(()=>{let e=ey.filter(e=>"Header"===e.type&&R(eo(e))).reduce((e,t)=>{var l;return e+Number((null==t||null==(l=t.inputs)?void 0:l.headerLF)||0)},0);return ey.map(t=>{var l,n,i,a,u,r,c,o,d,m,b,g;let v=eo(t),y=null!=(l=s(B(t)))?l:0;if("Header"===t.type){let e=p({isLVL:L(v),headerLF:Number((null==t||null==(n=t.inputs)?void 0:n.headerLF)||0),lvlPieces:Number((null==t||null==(i=t.inputs)?void 0:i.lvlPieces)||0),lvlLength:Number((null==t||null==(a=t.inputs)?void 0:a.lvlLength)||0),boardLenFt:y,wastePct:null!=(u=t.wastePct)?u:5,item:I(t)});return{...t,unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,boardLenFt:y}}if("Post"===t.type){let e=h({isLinearLF:L(v)||k(v),pieces:Number((null==t||null==(r=t.inputs)?void 0:r.pieces)||0),heightFt:Number(null!=(m=null==t||null==(c=t.inputs)?void 0:c.heightFt)?m:W),piecesPerPost:Number((null==t||null==(o=t.inputs)?void 0:o.piecesPerPost)||0),numPosts:Number((null==t||null==(d=t.inputs)?void 0:d.numPosts)||0),wastePct:null!=(b=t.wastePct)?b:5,item:I(t)});return{...t,unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,boardLenFt:y}}if("Headers infill"===t.type){let l=f({headerLFPool:e,wastePct:null!=(g=t.wastePct)?g:5,item:I(t)});return{...t,unit:l.unit,qtyRaw:l.qtyRaw,qtyFinal:l.qtyFinal,unitPrice:l.unitPrice,subtotal:l.subtotal,boardLenFt:null}}return t})},[ey,W]),eS=(0,l.useMemo)(()=>ed.reduce((e,t)=>e+(t.subtotal||0),0)+eP.reduce((e,t)=>e+(t.subtotal||0),0),[ed,eP]);(0,l.useEffect)(()=>{var e;let t={id:P,kind:"exterior",lengthLF:Number(C||0),zipSheetsFinal:eb,panelSheets:ep,platePieces:Math.ceil(eg),bottomPlatePiecesPanel:Math.ceil((null==(e=em.bottomPlate)?void 0:e.qtyFinal)||0),ptLF:ev,groupSubtotal:eS,bottomBoardLenFt:ea,panelPtBoards:eh},l=JSON.stringify(t);l!==F.current&&(F.current=l,null==w||w(t))},[P,C,eb,ep,eg,null==(b=em.bottomPlate)?void 0:b.qtyFinal,ev,eS,ea,eh,w]);let eF="minmax(180px,1.1fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr";return(0,t.jsx)("div",{className:"ew-card",children:(0,t.jsxs)(M,{title:N,defaultOpen:!0,summary:(0,t.jsxs)("div",{style:{textAlign:"right",fontWeight:700,color:"#f18d5b"},children:["Subtotal: ",D(eS)]}),actions:j?(0,t.jsx)(E,{onClick:j,title:"Remove section",label:"Remove section"}):null,children:[(0,t.jsxs)("div",{className:"controls4",style:{marginBottom:12},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Length (LF)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:H,onChange:e=>T(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(es(),e.target.blur())},onBlur:es})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Height (ft)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:W,onChange:e=>O(Number(e.target.value))})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Stud spacing (in)"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:U,onChange:e=>V(Number(e.target.value))})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Studs per location"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",min:1,value:J,onChange:e=>G(Number(e.target.value))})]})]}),(0,t.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":eF},children:[(0,t.jsx)("div",{children:"Item"}),(0,t.jsx)("div",{children:"Vendor · Family · Size"}),(0,t.jsx)("div",{className:"ew-right",children:"Qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,t.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit"}),(0,t.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,t.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,t.jsx)("div",{children:"Notes"}),(0,t.jsx)("div",{})]}),(0,t.jsx)("div",{className:"ew-rows",children:ed.map(e=>{let i,a="base:".concat(e.key),s=ee(a);return(0,t.jsxs)(l.Fragment,{children:[(0,t.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":eF},children:[(0,t.jsx)("div",{children:e.label}),(0,t.jsx)(n.default,{compact:!0,onSelect:(i=e.key,e=>Y(t=>({...t,[i]:e}))),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"sheathing"===e.key?"Green Zip":"bottomPlate"===e.key?S:"SPF#2",preferredSeries:"sheathing"===e.key?void 0:"2x6"}),(0,t.jsx)("div",{className:"ew-right",children:Math.ceil(e.qtyRaw)}),(0,t.jsx)("div",{className:"ew-right",children:(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:e.wastePct,onChange:t=>Q(l=>({...l,[e.key]:Number(t.target.value)})),style:{width:80,padding:6,textAlign:"right"}})}),(0,t.jsx)("div",{className:"ew-right",children:e.qtyFinal}),(0,t.jsx)("div",{className:"ew-right",children:e.unit}),(0,t.jsx)("div",{className:"ew-right ew-money",children:e.unitPrice?D(e.unitPrice):"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:e.subtotal?D(e.subtotal):"—"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"ew-subtle",style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[(0,t.jsx)("span",{className:"ew-chip",title:s.plan||"",children:s.plan||"—"}),(0,t.jsx)("button",{className:"ew-btn",style:{padding:"4px 8px"},onClick:()=>el(a),children:s.open?"Hide":"Notes"})]}),s.comment&&(0,t.jsx)("div",{className:"ew-subtle",title:s.comment,children:z(s.comment)})]}),(0,t.jsx)("div",{})]}),s.open&&(0,t.jsx)("div",{className:"ew-row",style:{padding:12},children:(0,t.jsxs)("div",{className:"controls2",style:{width:"100%"},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Plan label"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"text",placeholder:"e.g., A2.4 / S5 – Detail 03",value:ee(a).plan,onChange:e=>et(a,{plan:e.target.value})})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Comment"}),(0,t.jsx)("textarea",{className:"ew-input focus-anim",rows:3,placeholder:"Add any notes for this item…",value:ee(a).comment,onChange:e=>et(a,{comment:e.target.value})})]})]})})]},e.key)})}),(0,t.jsx)("h3",{className:"ew-h3",style:{marginTop:12,marginBottom:6},children:"Extras"}),(0,t.jsx)("div",{className:"ew-rows",children:eP.map(e=>{var i,a,s,u,r,c,o,d,m,p,h;let f="extra:".concat(e.id);return ee(f),(0,t.jsxs)(l.Fragment,{children:[(0,t.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":eF},children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontWeight:600},children:e.type}),"Headers infill"!==e.type&&(0,t.jsx)(E,{onClick:j,title:"Remove section",label:"Remove section"})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.default,{compact:!0,onSelect:t=>ej(e.id,{item:t}),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"Headers infill"===e.type?"CDX SE":"SPF#2"}),"Header"===e.type&&(L(eo(e))?(0,t.jsxs)("div",{className:"ew-inline",style:{marginTop:6},children:[(0,t.jsxs)("label",{children:["Pieces",(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(i=e.inputs)?void 0:i.lvlPieces)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,lvlPieces:Number(t.target.value)}})})]}),(0,t.jsxs)("label",{children:["Length (lf)",(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(a=e.inputs)?void 0:a.lvlLength)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,lvlLength:Number(t.target.value)}})})]})]}):(0,t.jsx)("div",{className:"ew-inline",style:{marginTop:6},children:(0,t.jsxs)("label",{children:["Total header LF",(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(s=e.inputs)?void 0:s.headerLF)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,headerLF:Number(t.target.value)}})})]})})),"Post"===e.type&&(L(eo(e))||k(eo(e))?(0,t.jsxs)("div",{className:"ew-inline",style:{marginTop:6},children:[(0,t.jsxs)("label",{children:["Pieces",(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(u=e.inputs)?void 0:u.pieces)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,pieces:Number(t.target.value)}})})]}),(0,t.jsxs)("label",{children:["Height (ft)",(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:null!=(d=null==(r=e.inputs)?void 0:r.heightFt)?d:W,onChange:t=>ej(e.id,{inputs:{...e.inputs,heightFt:Number(t.target.value)}})})]})]}):q(eo(e))?(0,t.jsxs)("div",{className:"ew-inline",style:{marginTop:6},children:[(0,t.jsxs)("label",{children:["Pieces per post",(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(c=e.inputs)?void 0:c.piecesPerPost)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,piecesPerPost:Number(t.target.value)}})})]}),(0,t.jsxs)("label",{children:["Posts (#)",(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(o=e.inputs)?void 0:o.numPosts)||"",onChange:t=>ej(e.id,{inputs:{...e.inputs,numPosts:Number(t.target.value)}})})]})]}):null),"Headers infill"===e.type&&(0,t.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:"QTY = Σ Header LF ÷ 3 ÷ 32 × 2 (then waste)"})]}),(0,t.jsx)("div",{className:"ew-right",children:Math.ceil(null!=(m=e.qtyRaw)?m:0)}),(0,t.jsx)("div",{className:"ew-right",children:(0,t.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=(p=e.wastePct)?p:0,onChange:t=>ej(e.id,{wastePct:Number(t.target.value)}),style:{width:80,textAlign:"right"}})}),(0,t.jsx)("div",{className:"ew-right",children:null!=(h=e.qtyFinal)?h:"—"}),(0,t.jsx)("div",{className:"ew-right",children:e.unit}),(0,t.jsx)("div",{className:"ew-right ew-money",children:e.unitPrice?D(e.unitPrice):"—"}),(0,t.jsx)("div",{className:"ew-right ew-money",children:e.subtotal?D(e.subtotal):"—"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"ew-subtle",style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[(0,t.jsx)("span",{className:"ew-chip",title:ee(f).plan||"",children:ee(f).plan||"—"}),(0,t.jsx)("button",{className:"ew-btn",style:{padding:"4px 8px"},onClick:()=>el(f),children:ee(f).open?"Hide":"Notes"})]}),ee(f).comment&&(0,t.jsx)("div",{className:"ew-subtle",title:ee(f).comment,children:z(ee(f).comment)})]}),(0,t.jsx)("div",{})]}),ee(f).open&&(0,t.jsx)("div",{className:"ew-row",style:{padding:12},children:(0,t.jsxs)("div",{className:"controls2",style:{width:"100%"},children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Plan label"}),(0,t.jsx)("input",{className:"ew-input focus-anim",type:"text",value:ee(f).plan,onChange:e=>et(f,{plan:e.target.value})})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("span",{className:"ew-subtle",children:"Comment"}),(0,t.jsx)("textarea",{className:"ew-input focus-anim",rows:3,value:ee(f).comment,onChange:e=>et(f,{comment:e.target.value})})]})]})})]},e.id)})}),(0,t.jsxs)("div",{className:"ew-footer",children:[(0,t.jsx)("button",{className:"ew-btn",onClick:()=>eN("Header"),children:"➕ Header"}),(0,t.jsx)("button",{className:"ew-btn",onClick:()=>eN("Post"),children:"➕ Post"}),(0,t.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",color:"#f18d5b"},children:["Group subtotal: ",D(eS)]})]})]})})}}]);