(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{400:(e,t,l)=>{"use strict";l.d(t,{B:()=>d,ProjectProvider:()=>u});var n=l(5155),a=l(2115),i=l(9708),s=l(5567),r=l(1867);let o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id-";return e+Math.random().toString(36).slice(2,9)},c=(0,a.createContext)({projectId:null,projectData:null,projectsList:[],fetchProjectsList:async()=>{},createNewProject:async e=>null,loadProject:async()=>{},saveProject:async()=>{},updateEstimateData:e=>{},isLoaded:!1,isLoading:!0,isSaving:!1,isListLoading:!1});function u(e){let{children:t,initialProjectId:l=null}=e,{user:u}=(0,r.A)(),[d,m]=(0,a.useState)(l),[h,p]=(0,a.useState)(null),[b,x]=(0,a.useState)([]),[g,v]=(0,a.useState)(!1),[N,y]=(0,a.useState)(!1),[w,j]=(0,a.useState)(!1),[f,P]=(0,a.useState)(!1),[S,k]=(0,a.useState)("default-app-id");(0,a.useEffect)(()=>{void 0!==window.__app_id?k(window.__app_id):console.warn("__app_id not found, using default for ProjectContext.")},[]);let L=(0,a.useCallback)(()=>S&&"default-app-id"!==S?"artifacts/".concat(S,"/public/projects"):(console.error("Cannot get projects collection path: Missing appId."),null),[S]),F=(0,a.useCallback)(e=>L()&&e?"artifacts/".concat(S,"/public/projects/").concat(e):null,[L]),C=(0,a.useCallback)(async()=>{let e=L();if(e&&!w){console.log("Fetching projects list:",e),j(!0);try{let t=(0,i.P)((0,i.rJ)(s.db,e),(0,i.My)("updatedAt","desc")),l=(await (0,i.GG)(t)).docs.map(e=>{var t;return{id:e.id,name:e.data().name||"Untitled",updatedAt:null==(t=e.data().updatedAt)?void 0:t.toDate()}});x(l),console.log("Projects list fetched:",l.length)}catch(e){console.error("Error fetching projects list:",e),x([])}finally{j(!1)}}},[L,w,s.db]),B=(0,a.useCallback)(async e=>{let t=L();return u&&t&&!f||console.error("Cannot create project: User not logged in path or missing."),null},[u,L,f,s.db,C]),M=(0,a.useCallback)(async e=>{if(!e||N)return;let t=F(e);if(t){console.log("Loading project:",t),y(!0),v(!1),p(null),m(e);try{let l=(0,i.H9)(s.db,t),n=await (0,i.x7)(l);if(n.exists()){let t=n.data();t.estimateData||(t.estimateData={}),t.estimateData.levels&&0!==t.estimateData.levels.length||(t.estimateData.levels=[{id:o("level-"),name:"Level 1"}]),p(t),console.log("Project loaded:",e)}else console.log("No such project document! Cannot load:",e),m(null)}catch(t){console.error("Error loading project:",e,t),m(null)}finally{y(!1),v(!0)}}},[N,F,s.db]),T=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;if(!u||!e||!t||f)return void console.error("Cannot save project: User not logged in or missing data/ID.");let l=F(e);if(l){console.log("Saving project:",l),P(!0);try{let n=(0,i.H9)(s.db,l),a={...t,updatedAt:i.Dc.now(),createdAt:t.createdAt||i.Dc.now()};await (0,i.BN)(n,a,{merge:!0}),p(a),console.log("Project saved successfully."),x(t=>t.map(t=>t.id===e?{...t,updatedAt:a.updatedAt.toDate()}:t).sort((e,t)=>t.updatedAt-e.updatedAt))}catch(e){console.error("Error saving project:",e)}finally{P(!1)}}},[u,d,h,f,F,s.db]),E=(0,a.useCallback)(e=>{p(t=>t?{...t,estimateData:{...t.estimateData,...e}}:null)},[]);(0,a.useEffect)(()=>{"default-app-id"!==S?C():(x([]),p(null),m(null))},[S,C]),(0,a.useEffect)(()=>{l&&!h&&!N&&(null==u?void 0:u.uid)&&M(l)},[l,h,N,null==u?void 0:u.uid,M]);let A=(0,a.useMemo)(()=>({projectId:d,projectData:h,projectsList:b,appId:S,fetchProjectsList:C,createNewProject:B,loadProject:M,saveProject:T,updateEstimateData:E,isLoaded:g,isLoading:N,isSaving:f,isListLoading:w}),[d,h,b,C,B,M,T,E,g,N,f,w]);return(0,n.jsx)(c.Provider,{value:A,children:t})}let d=()=>(0,a.useContext)(c)},1867:(e,t,l)=>{"use strict";l.d(t,{A:()=>c,AuthProvider:()=>o});var n=l(5155),a=l(2115),i=l(2553),s=l(5567);let r=(0,a.createContext)({user:void 0,loading:!0,signIn:async()=>{},signOutUser:async()=>{}});function o(e){let{children:t}=e,[l,o]=(0,a.useState)(void 0),c=void 0===l,u=async()=>{try{await (0,i.df)(s.j2,s.hJ)}catch(e){console.error("Error signing in with Google:",e)}},d=async()=>{try{await (0,i.CI)(s.j2)}catch(e){console.error("Error signing out:",e)}};(0,a.useEffect)(()=>{let e=(0,i.hg)(s.j2,e=>{console.log("Auth State Changed:",(null==e?void 0:e.uid)||"No user"),o(e)});return()=>e()},[]);let m=(0,a.useMemo)(()=>({user:l,loading:c,signIn:u,signOutUser:d}),[l,c]);return(0,n.jsx)(r.Provider,{value:m,children:t})}let c=()=>(0,a.useContext)(r)},7502:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>eb});var n=l(5155),a=l(2115),i=l(552),s=l(400),r=l(1867);let o=[{key:"auth",label:"Login / Logout",icon:"/icons/login.png"},{key:"project",label:"Project",icon:"/icons/files.png"},{key:"trusses",label:"Trusses",icon:"/icons/roof.png"},{key:"wallpanels",label:"Wall Panels",icon:"/icons/wood.png"},{key:"loose",label:"Loose Material",icon:"/icons/loose.png"},{key:"labor",label:"Labor",icon:"/icons/worker.png"},{key:"summary",label:"Summary",icon:"/icons/search.png"},{key:"takeoff",label:"Takeoff list",icon:"/icons/list.png"},{key:"quote",label:"Quote (QuickBooks)",icon:"/icons/dollar.png"},{key:"export",label:"Export",icon:"/icons/download.png"},{key:"items",label:"Material List",icon:"/icons/trolley.png"},{key:"save",label:"Save",icon:"/icons/save.png"},{key:"mode",label:"Light Mode",icon:"/icons/brightness.png"}];function c(e){let{active:t="wallpanels",collapsed:l=!1,onChange:i,onCollapsedChange:c}=e,{saveProject:u,isSaving:d,projectData:m,projectId:h}=(0,s.B)(),{user:p,signIn:b,signOutUser:x}=(0,r.A)(),g=(0,a.useMemo)(()=>o,[]);g.filter(e=>!["save","mode","auth"].includes(e.key)).findIndex(e=>e.key===t);let v=g.findIndex(e=>e.key===t),N=!!p&&!!h&&!!m&&!d;return(0,n.jsxs)("aside",{className:"sidebar ".concat(l?"open":""),children:[(0,n.jsx)("header",{children:(0,n.jsx)("button",{type:"button",className:"sidebar-burger",onClick:()=>null==c?void 0:c(!l),title:l?"Expand":"Collapse",children:(0,n.jsx)("img",{src:"/icons/menu.png",alt:l?"Expand sidebar":"Collapse sidebar",width:24,height:24,"aria-hidden":!0})})}),(0,n.jsx)("nav",{className:"menu",style:{"--top":"".concat(6+(v>=0?56*v:0),"px")},role:"navigation","aria-label":"Main",children:g.map((e,l)=>{let a=e.key===t&&!["save","mode","auth"].includes(e.key),s=!1;"save"===e.key?s=!N:["project","wallpanels","summary"].includes(e.key)?s=!p:["auth","mode"].includes(e.key)||(s=!0);let r=!p&&!["project","auth","mode"].includes(e.key),o="save"===e.key&&!N||s||r,c=e.label;return"save"===e.key&&d&&(c="Saving..."),"auth"===e.key&&(c=p?"Logout":"Login"),(0,n.jsxs)("button",{type:"button",className:"menu-item ".concat(a?" active":""," ").concat(s?" disabled":""),onClick:()=>!s&&(e=>{if("save"===e.key){N&&u();return}return"mode"===e.key?void console.log("Toggle theme clicked"):"auth"===e.key?void(p?x():b()):void(null==i||i(e.key))})(e),title:e.label,"aria-current":a?"page":void 0,"aria-disabled":!!o||void 0,children:[(0,n.jsx)("img",{src:e.icon,alt:"",width:20,height:20,className:"menu-ico","aria-hidden":!0}),(0,n.jsx)("p",{className:"menu-label",children:c})]},e.key)})}),(0,n.jsx)("div",{className:"side-foot",style:{marginTop:"auto",textAlign:l?"center":"left",padding:l?"10px 0":"10px"},children:p&&(0,n.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:l?"center":"flex-start",gap:"8px",padding:"0 10px"},children:!l&&(0,n.jsx)("span",{className:"ew-subtle",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:p.displayName||p.email,children:p.displayName||p.email})})})]})}var u=l(8194);function d(e){let{onClick:t,size:l=20,title:a="Add",label:i="Add",src:s="/icons/plus.png",className:r="",disabled:o=!1}=e;return(0,n.jsx)("button",{type:"button",className:"ew-btn ew-icon-btn ".concat(r),onClick:t,"aria-label":i,title:a,disabled:o,children:(0,n.jsx)("img",{src:s,width:l,height:l,alt:""})})}function m(){return"ex-"+Math.random().toString(36).slice(2,8)+"-"+Date.now().toString(36)}let h=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function p(e){let{onTotalsChange:t,title:l="Exterior walls",levelId:s="default",onLengthLFChange:r,onPanelLenFtChange:o,isLevelOne:c=!1}=e,[p,b]=(0,i.g)("inv:v1:ex:sections:".concat(s),[{id:m()}]),[x,g]=(0,a.useState)({}),v=()=>b(e=>[...e,{id:m()}]),N=(0,a.useCallback)(e=>{e&&e.id&&g(t=>{let l=t[e.id];return l&&l.lengthLF===e.lengthLF&&l.zipSheetsFinal===e.zipSheetsFinal&&l.platePieces===e.platePieces&&l.ptLF===e.ptLF&&l.groupSubtotal===e.groupSubtotal&&l.bottomBoardLenFt===e.bottomBoardLenFt?t:{...t,[e.id]:e}})},[]),y=(0,a.useMemo)(()=>{let e=Object.values(x),t=e.reduce((e,t)=>e+(Number(t.lengthLF)||0),0),l=e.reduce((e,t)=>e+(Number(t.zipSheetsFinal)||0),0),n=e.reduce((e,t)=>e+(Number(t.panelSheets)||0),0),a=e.reduce((e,t)=>e+(Number(t.platePieces)||0),0),i=e.reduce((e,t)=>e+(Number(t.bottomPlatePiecesPanel)||0),0),s=e.reduce((e,t)=>e+(Number(t.ptLF)||0),0),r=e.reduce((e,t)=>e+(Number(t.groupSubtotal)||0),0);return{extLengthSum:t,extZipSheetsSum:l,extPanelSheets:n,extZipSheetsFinal:l,extPlatePieces:a,extBottomPlatePiecesPanel:i,extPTLFSum:s,extMoneySum:r,panelsSubtotal:e.reduce((e,t)=>e+(Number(t.groupSubtotal)||0),0),extPanelPtBoards:e.reduce((e,t)=>e+(Number(t.panelPtBoards)||0),0)}},[x]),w=(0,a.useMemo)(()=>{let e=Object.values(x).map(e=>Number(e.bottomBoardLenFt)||0).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[x]),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;let l={...y,panelLenFtExterior:w};l===(e=j.current)||l&&e&&l.extLengthSum===e.extLengthSum&&l.extZipSheetsSum===e.extZipSheetsSum&&l.extPanelSheets===e.extPanelSheets&&l.extPlatePieces===e.extPlatePieces&&l.extBottomPlatePiecesPanel===e.extBottomPlatePiecesPanel&&l.extPTLFSum===e.extPTLFSum&&l.extMoneySum===e.extMoneySum&&l.panelsSubtotal===e.panelsSubtotal&&l.panelLenFtExterior===e.panelLenFtExterior&&l.extPanelPtBoards===e.extPanelPtBoards||(j.current=l,null==t||t(l),null==r||r(y.extLengthSum),null==o||o(w))},[y,w,t,r,o]);let f=y.panelsSubtotal,P={fontFamily:"'Nova Mono', monospace"};return(0,n.jsxs)("section",{className:"ew-stack",children:[(0,n.jsxs)("div",{className:"ew-card",style:{marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem"},children:[(0,n.jsx)("h2",{className:"ew-h2",style:{...P,margin:0,flexShrink:0},children:l}),(0,n.jsxs)("div",{className:"ew-right",title:"Sum of all exterior wall section subtotals for this level",style:{...P,fontWeight:700},children:["Total: ",Number.isFinite(Number(f))?h.format(Number(f)):"—"]})]}),0===p.length&&(0,n.jsxs)("div",{className:"ew-card",children:[(0,n.jsx)("div",{className:"ew-subtle",children:"No exterior wall sections yet."}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("button",{className:"ew-btn ew-btn--turq",onClick:v,children:"+ Add exterior wall section"})})]}),p.map((e,t)=>(0,n.jsx)(u.A,{persistKey:"exterior:".concat(e.id),title:"Exterior walls — section ".concat(t+1),onRemove:()=>{var t;return t=e.id,void(b(e=>e.filter(e=>e.id!==t)),g(e=>{let l={...e};return delete l[t],l}))},onStatsChange:N,bottomDefaultFamily:c?"PT":"SPF#2"},e.id)),(0,n.jsxs)("div",{className:"ew-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"1rem"},children:[(0,n.jsx)("div",{className:"ew-subtle",children:"Add another exterior wall section to this level."}),(0,n.jsx)(d,{onClick:v,title:"Add Section",label:"Add Section"})]})]})}var b=l(997),x=l(3911),g=l(1340),v=l(3688),N=l(5753),y=l(2875);let w=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),j=e=>Number.isFinite(Number(e))?w.format(Number(e)):"—",f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,l=String(e).trim().split(/\s+/),n=l.slice(0,t).join(" ");return l.length>t?"".concat(n,"…"):n||""},P=e=>e&&e.item?P(e.item):e,S=e=>P(e),k=e=>{var t,l,n;return(null==(t=P(e))?void 0:t.unit)||(null==(n=P(e))||null==(l=n.raw)?void 0:l.unit)||"pcs"},L=e=>{var t,l,n,a;return(null==(t=P(e))?void 0:t.sizeDisplay)||(null==(l=P(e))?void 0:l.sizeLabel)||(null==(a=P(e))||null==(n=a.raw)?void 0:n.sizeDisplay)||""},F=e=>{var t,l,n,a,i;return(null==(l=P(e))||null==(t=l.raw)?void 0:t.familyDisplay)||(null==(n=P(e))?void 0:n.familyDisplay)||(null==(i=P(e))||null==(a=i.raw)?void 0:a.family)||(null==e?void 0:e.familyLabel)||""};function C(e){var t,l,s,r,o,c,u,d,m;let{onStatsChange:h,title:p="Interior walls",onRemove:w,persistKey:P="interior-0",bottomDefaultFamily:C="SPF#2"}=e,[B,M]=(0,a.useState)("partition"),[T,E]=(0,a.useState)(0),[A,I]=(0,a.useState)(String(T)),[q,D]=(0,a.useState)(12),[W,O]=(0,a.useState)(16),[R,z]=(0,a.useState)(1),[_,U]=(0,a.useState)({bottomPlate:10,topPlate:10,studs:60,blocking:10,sheathing:20}),[H,G]=(0,a.useState)({bottomPlate:null,topPlate:null,studs:null,blocking:null,sheathing:null}),[V,K]=(0,i.g)("inv:v1:notes:".concat(P),{}),Q=e=>V[e]||{plan:"",comment:"",open:!1},Z=(e,t)=>K(l=>({...l,[e]:{...Q(e),...t}})),$=e=>Z(e,{open:!Q(e).open}),J=null!=(o=(0,N._3)(L(H.bottomPlate)))?o:0,X=Number.isFinite(J)?J:0,Y=null!=(c=(0,N._3)(L(H.topPlate)))?c:12,ee=null!=(u=(0,N._3)(L(H.blocking)))?u:12,et="bearing"===B,el="shear"===B;(0,a.useEffect)(()=>{I(String(T))},[T]);let en=()=>{E(Number(A)||0)},ea=(0,a.useMemo)(()=>{var e,t,l,n,a,i,s,r,o,c;let u=[];{let l=(0,v.bh)({lengthLF:T,boardLenFt:J,wastePct:null!=(e=_.bottomPlate)?e:0,item:S(H.bottomPlate),unit:k(H.bottomPlate)});u.push({key:"bottomPlate",label:"Bottom plate",item:S(H.bottomPlate),unit:l.unit,qtyRaw:l.qtyRaw,qtyFinal:l.qtyFinal,unitPrice:l.unitPrice,subtotal:l.subtotal,wastePct:null!=(t=_.bottomPlate)?t:0,boardLenFt:l.boardLenFt})}{let e=(0,v.bh)({lengthLF:T,boardLenFt:Y,wastePct:null!=(l=_.topPlate)?l:0,item:S(H.topPlate),unit:k(H.topPlate)});u.push({key:"topPlate",label:"Top plate",item:S(H.topPlate),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(n=_.topPlate)?n:0})}{let e=(0,v.FN)({lengthLF:T,spacingIn:W,multiplier:R,wastePct:null!=(a=_.studs)?a:0,item:S(H.studs),unit:k(H.studs)});u.push({key:"studs",label:"Studs",item:S(H.studs),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(i=_.studs)?i:0})}if(et){let e=(0,v.jO)({lengthLF:T,heightFt:q,boardLenFt:ee,wastePct:null!=(s=_.blocking)?s:0,item:S(H.blocking),unit:k(H.blocking)});u.push({key:"blocking",label:"Blocking",item:S(H.blocking),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(r=_.blocking)?r:0})}if(el){let e=(0,v.NH)({lengthLF:T,heightFt:q,wastePct:null!=(o=_.sheathing)?o:0,item:S(H.sheathing),unit:k(H.sheathing)||"sheet"});u.push({key:"sheathing",label:"Sheathing (4x8)",item:S(H.sheathing),unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,wastePct:null!=(c=_.sheathing)?c:0})}return u},[H,_,et,el,T,q,W,R,J,Y,ee]),ei=(0,a.useMemo)(()=>Object.fromEntries((ea||[]).map(e=>[e.key,e])),[ea]),es=(0,a.useMemo)(()=>{if(!el)return 0;let e=ea.find(e=>"sheathing"===e.key);return Math.ceil(Number((null==e?void 0:e.qtyFinal)||0))},[ea,el]),er=(0,a.useMemo)(()=>{var e;let t,l=(t=F(H.bottomPlate),/(^|\b)pt(\b|$)|pressure/i.test(String(t||""))),n=Math.ceil(Number((null==(e=ei.bottomPlate)?void 0:e.qtyFinal)||0));return l?n:0},[H.bottomPlate,null==(t=ei.bottomPlate)?void 0:t.qtyFinal]),eo=(null!=(d=null==(l=ei.bottomPlate)?void 0:l.qtyFinal)?d:0)+(null!=(m=null==(s=ei.topPlate)?void 0:s.qtyFinal)?m:0),ec=Number(T||0),eu=L(H.studs)||L(H.bottomPlate)||"",ed=/(^|\D)2\s*[x×]\s*6(\D|$)/i.test(eu)?"int-2x6":"int-2x4",[em,eh]=(0,a.useState)([]),ep=(0,a.useRef)(1),eb=e=>eh(t=>[...t,{id:"x".concat(ep.current++),type:e,item:null,wastePct:5,inputs:{}}]),ex=(e,t)=>eh(l=>l.map(l=>l.id===e?{...l,...t}:l));(0,a.useEffect)(()=>{let e=em.filter(e=>"Header"===e.type&&(0,y.vE)(F(e))).reduce((e,t)=>e+Number(t.inputs.headerLF||0),0),t=em.some(e=>"Headers infill"===e.type);e>0&&!t&&eh(e=>[...e,{id:"infill",type:"Headers infill",item:null,wastePct:5,inputs:{}}]),0===e&&t&&eh(e=>e.filter(e=>"Headers infill"!==e.type))},[JSON.stringify(em.map(e=>({t:e.type,f:F(e),lf:e.inputs.headerLF||0})))]);let eg=(0,a.useMemo)(()=>{let e=em.filter(e=>"Header"===e.type&&(0,y.vE)(F(e))).reduce((e,t)=>{var l;return e+Number((null==t||null==(l=t.inputs)?void 0:l.headerLF)||0)},0);return em.map(t=>{var l,n,a,i,s,r,o,c,u,d,m,h,p,b,x;let g=F(t),w=null!=(l=(0,N._3)(L(t)))?l:0;if("Header"===t.type){let e=(0,v.Vg)({isLVL:(0,y.DP)(g),headerLF:Number((null==t||null==(n=t.inputs)?void 0:n.headerLF)||0),lvlPieces:Number((null==t||null==(a=t.inputs)?void 0:a.lvlPieces)||0),lvlLength:Number((null==t||null==(i=t.inputs)?void 0:i.lvlLength)||0),boardLenFt:w,wastePct:null!=(s=t.wastePct)?s:5,item:S(t)});return{...t,unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,boardLenFt:w}}if("Extra blocking"===t.type){let e=Math.max(1,Number((null==t||null==(r=t.inputs)?void 0:r.rows)||1)),l=(0,v.bh)({lengthLF:Number(T||0)*e,boardLenFt:w,wastePct:null!=(o=t.wastePct)?o:10,item:S(t),unit:k(t)});return{...t,unit:l.unit,qtyRaw:l.qtyRaw,qtyFinal:l.qtyFinal,unitPrice:l.unitPrice,subtotal:l.subtotal,boardLenFt:w}}if("Extra sheathing"===t.type){let e=(0,v.NH)({lengthLF:T,heightFt:q,wastePct:null!=(c=t.wastePct)?c:5,item:S(t),unit:k(t)||"sheet"});return{...t,unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,boardLenFt:null}}if("Post"===t.type){let e=(0,v.uX)({isLinearLF:(0,y.DP)(g)||(0,y.QF)(g),pieces:Number((null==t||null==(u=t.inputs)?void 0:u.pieces)||0),heightFt:Number(null!=(p=null==t||null==(d=t.inputs)?void 0:d.heightFt)?p:q),piecesPerPost:Number((null==t||null==(m=t.inputs)?void 0:m.piecesPerPost)||0),numPosts:Number((null==t||null==(h=t.inputs)?void 0:h.numPosts)||0),wastePct:null!=(b=t.wastePct)?b:5,item:S(t)});return{...t,unit:e.unit,qtyRaw:e.qtyRaw,qtyFinal:e.qtyFinal,unitPrice:e.unitPrice,subtotal:e.subtotal,boardLenFt:w}}if("Headers infill"===t.type){let l=(0,v.y_)({headerLFPool:e,wastePct:null!=(x=t.wastePct)?x:5,item:S(t)});return{...t,unit:l.unit,qtyRaw:l.qtyRaw,qtyFinal:l.qtyFinal,unitPrice:l.unitPrice,subtotal:l.subtotal,boardLenFt:null}}return t})},[em,q,T]),ev=(0,a.useMemo)(()=>ea.reduce((e,t)=>e+(t.subtotal||0),0)+eg.reduce((e,t)=>e+(t.subtotal||0),0),[ea,eg]),eN=(0,a.useRef)("");(0,a.useEffect)(()=>{var e;let t={id:P,kind:ed,lengthLF:Number(T||0),platePieces:Math.ceil(eo),bottomPlatePiecesPanel:Math.ceil((null==(e=ei.bottomPlate)?void 0:e.qtyFinal)||0),ptLF:ec,groupSubtotal:ev,isShear:"shear"===B,isBearing:"bearing"===B,isPartition:"partition"===B,isKnee:"knee"===B,bottomBoardLenFt:X,panelPtBoards:er,panelSheets:es},l=JSON.stringify(t);l!==eN.current&&(eN.current=l,null==h||h(t))},[P,B,ed,er,es,T,eo,null==(r=ei.bottomPlate)?void 0:r.qtyFinal,ec,ev,X,h]);let ey="minmax(180px,1.1fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr";return(0,n.jsx)("div",{className:"ew-card",children:(0,n.jsxs)(x.A,{title:p,defaultOpen:!0,summary:(0,n.jsxs)("div",{style:{textAlign:"right",fontWeight:700,color:"#f18d5b"},children:["Subtotal: ",j(ev)]}),actions:w?(0,n.jsx)(g.A,{onClick:w,title:"Remove section",label:"Remove section"}):null,children:[(0,n.jsxs)("div",{className:"controls4",style:{marginBottom:8},children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Length (LF)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:A,onChange:e=>I(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(en(),e.target.blur())},onBlur:en})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Height (ft)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:q,onChange:e=>D(Number(e.target.value))})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Stud spacing (in)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:W,onChange:e=>O(Number(e.target.value))})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Studs per location"}),(0,n.jsxs)("select",{className:"ew-select focus-anim",value:R,onChange:e=>z(Number(e.target.value)),children:[(0,n.jsx)("option",{value:1,children:"Single"}),(0,n.jsx)("option",{value:2,children:"Double"}),(0,n.jsx)("option",{value:3,children:"Triple"}),(0,n.jsx)("option",{value:4,children:"Quad"})]})]})]}),(0,n.jsx)("div",{className:"controls2",style:{marginBottom:12},children:(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Wall kind"}),(0,n.jsxs)("select",{className:"ew-select focus-anim",value:B,onChange:e=>M(e.target.value),children:[(0,n.jsx)("option",{value:"partition",children:"Partition"}),(0,n.jsx)("option",{value:"bearing",children:"Bearing (adds blocking)"}),(0,n.jsx)("option",{value:"shear",children:"Shear (adds sheathing)"}),(0,n.jsx)("option",{value:"knee",children:"Knee"})]})]})}),(0,n.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":ey},children:[(0,n.jsx)("div",{children:"Item"}),(0,n.jsx)("div",{children:"Vendor \xb7 Family \xb7 Size"}),(0,n.jsx)("div",{className:"ew-right",children:"Qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,n.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,n.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,n.jsx)("div",{children:"Notes"}),(0,n.jsx)("div",{})]}),(0,n.jsx)("div",{className:"ew-rows",children:ea.map(e=>{let t,l="base:".concat(e.key),i=Q(l);return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":ey},children:[(0,n.jsx)("div",{children:e.label}),(0,n.jsx)("div",{children:(0,n.jsx)(b.A,{compact:!0,onSelect:(t=e.key,e=>G(l=>({...l,[t]:e}))),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"sheathing"===e.key?"CDX SE":"bottomPlate"===e.key?C:"SPF#2",defaultSizeLabel:"sheathing"===e.key?"4x8'-1/2\"":void 0,preferredSeries:"sheathing"===e.key?void 0:"2x6"})}),(0,n.jsx)("div",{className:"ew-right",children:Math.ceil(e.qtyRaw)}),(0,n.jsx)("div",{className:"ew-right",children:(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:e.wastePct,onChange:t=>U(l=>({...l,[e.key]:Number(t.target.value)})),style:{width:80,padding:6,textAlign:"right"}})}),(0,n.jsx)("div",{className:"ew-right",children:e.qtyFinal}),(0,n.jsx)("div",{className:"ew-right",children:e.unit}),(0,n.jsx)("div",{className:"ew-right ew-money",children:e.unitPrice?j(e.unitPrice):"—"}),(0,n.jsx)("div",{className:"ew-right ew-money",children:e.subtotal?j(e.subtotal):"—"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"ew-subtle",style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[(0,n.jsx)("span",{className:"ew-chip",title:i.plan||"",children:i.plan||"—"}),(0,n.jsx)("button",{className:"ew-btn",style:{padding:"4px 8px"},onClick:()=>$(l),children:i.open?"Hide":"Notes"})]}),i.comment&&(0,n.jsx)("div",{className:"ew-subtle",title:i.comment,children:f(i.comment)})]}),(0,n.jsx)("div",{})]}),i.open&&(0,n.jsx)("div",{className:"ew-row",style:{padding:12},children:(0,n.jsxs)("div",{className:"controls2",style:{width:"100%"},children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Plan label"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"text",placeholder:"e.g., A2.4 / S5 – Detail 03",value:Q(l).plan,onChange:e=>Z(l,{plan:e.target.value})})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Comment"}),(0,n.jsx)("textarea",{className:"ew-input focus-anim",rows:3,placeholder:"Add any notes for this item…",value:Q(l).comment,onChange:e=>Z(l,{comment:e.target.value})})]})]})})]},e.key)})}),(0,n.jsx)("h3",{className:"ew-h3",style:{marginTop:12,marginBottom:6},children:"Extras"}),(0,n.jsx)("div",{className:"ew-rows",children:eg.map(e=>{var t,l,i,s,r,o,c,u,d,m,h,p;let x="extra:".concat(e.id);return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":ey},children:[(0,n.jsx)("div",{children:(0,n.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,n.jsx)("span",{style:{fontWeight:600},children:e.type}),"Headers infill"!==e.type&&(0,n.jsx)(g.A,{onClick:()=>{let t;return t=e.id,eh(e=>e.filter(e=>e.id!==t))},title:"Remove ".concat(e.type),label:"Remove ".concat(e.type)})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(b.A,{compact:!0,onSelect:t=>ex(e.id,{item:t}),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"Headers infill"===e.type||"Extra sheathing"===e.type?"CDX SE":"SPF#2",defaultSizeLabel:"Extra sheathing"===e.type?"4x8'-1/2\"":void 0}),"Header"===e.type&&((0,y.DP)(F(e))?(0,n.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end"},children:[(0,n.jsxs)("label",{style:{minWidth:120},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Pieces"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(t=e.inputs)?void 0:t.lvlPieces)||"",onChange:t=>ex(e.id,{inputs:{...e.inputs,lvlPieces:Number(t.target.value)}})})]}),(0,n.jsxs)("label",{style:{minWidth:140},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Length (lf)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(l=e.inputs)?void 0:l.lvlLength)||"",onChange:t=>ex(e.id,{inputs:{...e.inputs,lvlLength:Number(t.target.value)}})})]})]}):(0,n.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end"},children:[(0,n.jsxs)("label",{style:{minWidth:160},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Total header LF"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(i=e.inputs)?void 0:i.headerLF)||"",onChange:t=>ex(e.id,{inputs:{...e.inputs,headerLF:Number(t.target.value)}})})]}),(0,n.jsxs)("div",{className:"ew-hint",children:["Board length from size: ",e.boardLenFt||(0,N._3)(L(e))||"—"," ft"]})]})),"Post"===e.type&&((0,y.DP)(F(e))||(0,y.QF)(F(e))?(0,n.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end"},children:[(0,n.jsxs)("label",{style:{minWidth:120},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Pieces"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(s=e.inputs)?void 0:s.pieces)||"",onChange:t=>ex(e.id,{inputs:{...e.inputs,pieces:Number(t.target.value)}})})]}),(0,n.jsxs)("label",{style:{minWidth:140},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Height (ft)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",value:null!=(d=null==(r=e.inputs)?void 0:r.heightFt)?d:q,onChange:t=>ex(e.id,{inputs:{...e.inputs,heightFt:Number(t.target.value)}})})]})]}):(0,y.O1)(F(e))?(0,n.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end"},children:[(0,n.jsxs)("label",{style:{minWidth:160},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Pieces per post"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(o=e.inputs)?void 0:o.piecesPerPost)||"",onChange:t=>ex(e.id,{inputs:{...e.inputs,piecesPerPost:Number(t.target.value)}})})]}),(0,n.jsxs)("label",{style:{minWidth:140},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Posts (#)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",value:(null==(c=e.inputs)?void 0:c.numPosts)||"",onChange:t=>ex(e.id,{inputs:{...e.inputs,numPosts:Number(t.target.value)}})})]})]}):null),"Headers infill"===e.type&&(0,n.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:"QTY = Σ Header LF \xf7 3 \xf7 32 \xd7 2 (then waste)"}),"Extra sheathing"===e.type&&(0,n.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:"Same math as regular sheathing (length \xd7 height \xf7 32), then waste."}),"Extra blocking"===e.type&&(0,n.jsxs)("div",{className:"ew-inline",style:{marginTop:6,alignItems:"end",gap:12},children:[(0,n.jsxs)("label",{style:{minWidth:140},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Rows (#)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",min:1,step:1,value:(null==(u=e.inputs)?void 0:u.rows)||1,onChange:t=>ex(e.id,{inputs:{...e.inputs||{},rows:Math.max(1,Number(t.target.value||1))}})})]}),(0,n.jsxs)("div",{className:"ew-hint",children:["Same math as plates \xd7 rows (then waste). Board length from size: ",e.boardLenFt||(0,N._3)(L(e))||"—"," ft"]})]})]}),(0,n.jsx)("div",{className:"ew-right",children:Math.ceil(null!=(m=e.qtyRaw)?m:0)}),(0,n.jsx)("div",{className:"ew-right",children:(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=(h=e.wastePct)?h:0,onChange:t=>ex(e.id,{wastePct:Number(t.target.value)}),style:{width:80,textAlign:"right"}})}),(0,n.jsx)("div",{className:"ew-right",children:null!=(p=e.qtyFinal)?p:"—"}),(0,n.jsx)("div",{className:"ew-right",children:e.unit}),(0,n.jsx)("div",{className:"ew-right ew-money",children:e.unitPrice?j(e.unitPrice):"—"}),(0,n.jsx)("div",{className:"ew-right ew-money",children:e.subtotal?j(e.subtotal):"—"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"ew-subtle",style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[(0,n.jsx)("span",{className:"ew-chip",title:Q(x).plan||"",children:Q(x).plan||"—"}),(0,n.jsx)("button",{className:"ew-btn",style:{padding:"4px 8px"},onClick:()=>$(x),children:Q(x).open?"Hide":"Notes"})]}),Q(x).comment&&(0,n.jsx)("div",{className:"ew-subtle",title:Q(x).comment,children:f(Q(x).comment)})]}),(0,n.jsx)("div",{})]}),Q(x).open&&(0,n.jsx)("div",{className:"ew-row",style:{padding:12},children:(0,n.jsxs)("div",{className:"controls2",style:{width:"100%"},children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Plan label"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"text",value:Q(x).plan,onChange:e=>Z(x,{plan:e.target.value})})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Comment"}),(0,n.jsx)("textarea",{className:"ew-input focus-anim",rows:3,value:Q(x).comment,onChange:e=>Z(x,{comment:e.target.value})})]})]})})]},e.id)})}),(0,n.jsxs)("div",{className:"ew-footer",children:[(0,n.jsx)("button",{className:"ew-btn",onClick:()=>eb("Header"),children:"➕ Header"}),(0,n.jsx)("button",{className:"ew-btn",onClick:()=>eb("Post"),children:"➕ Post"}),(0,n.jsx)("button",{className:"ew-btn",onClick:()=>eb("Extra blocking"),children:"➕ Blocking"}),el&&(0,n.jsx)("button",{className:"ew-btn",onClick:()=>eb("Extra sheathing"),children:"➕ Extra Sheathing"}),(0,n.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",color:"#f18d5b"},children:["Group subtotal: ",j(ev)]})]})]})})}let B=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),M=()=>"int-"+Math.random().toString(36).slice(2,9);function T(e){let{title:t="Interior walls",levelId:l="default",onTotalsChange:s,isLevelOne:r=!1,onBearingLFChange:o,onPartitionLFChange:c,onKneeLFChange:u}=e,[m,h]=(0,i.g)("inv:v1:int:sections:".concat(l),[{id:M()}]),[p,b]=(0,a.useState)({}),x=(0,a.useCallback)((e,t)=>{b(l=>({...l,[e]:t}))},[]),g=(0,a.useCallback)(()=>{h(e=>[...e,{id:M()}])},[h]),v=(0,a.useCallback)(e=>{h(t=>t.filter(t=>t.id!==e)),b(t=>{let l={...t};return delete l[e],l})},[h]),N=(0,a.useMemo)(()=>{let e=Object.values(p),t=e.filter(e=>(null==e?void 0:e.kind)==="int-2x6").reduce((e,t)=>e+(Number(null==t?void 0:t.lengthLF)||0),0),l=e.filter(e=>(null==e?void 0:e.kind)==="int-2x4").reduce((e,t)=>e+(Number(null==t?void 0:t.lengthLF)||0),0),n=e.reduce((e,t)=>e+(Number(null==t?void 0:t.platePieces)||0),0),a=e.reduce((e,t)=>e+(Number(null==t?void 0:t.bottomPlatePiecesPanel)||0),0),i=e.reduce((e,t)=>e+(Number(null==t?void 0:t.ptLF)||0),0),s=e.reduce((e,t)=>e+(Number(null==t?void 0:t.panelSheets)||0),0),r=e.reduce((e,t)=>e+(Number(null==t?void 0:t.groupSubtotal)||0),0),o=e.filter(e=>!!(null==e?void 0:e.isShear)),c=o.reduce((e,t)=>e+(Number(null==t?void 0:t.lengthLF)||0),0),u=e.reduce((e,t)=>e+(Number(null==t?void 0:t.panelPtBoards)||0),0),d=8;{let e=o.map(e=>Number(null==e?void 0:e.bottomBoardLenFt)||0).filter(Boolean);if(e.length){let t={};for(let l of e)t[l]=(t[l]||0)+1;d=Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])}}let m=e.filter(e=>!!(null==e?void 0:e.isPartition)).reduce((e,t)=>e+(Number(t.lengthLF)||0),0),h=e.filter(e=>!!(null==e?void 0:e.isKnee)).reduce((e,t)=>e+(Number(t.lengthLF)||0),0),b=e.filter(e=>!!(null==e?void 0:e.isBearing));return{int2x6LF:t,int2x4LF:l,intPlatePieces:n,intPTLFSum:i,panelsSubtotal:r,intPanelSheets:s,shearLengthSum:c,shearPanelLenFt:d,bearingLengthSum:b.reduce((e,t)=>e+(Number(t.lengthLF)||0),0),bearingPanelLenFt:(e=>{let t=e.filter(Boolean);if(!t.length)return 8;let l={};for(let e of t)l[e]=(l[e]||0)+1;return Number(Object.keys(l).sort((e,t)=>l[t]-l[e]||t-e)[0])})(b.map(e=>Number(e.bottomBoardLenFt)||0)),intBottomPlatePiecesPanel:a,partitionLengthSum:m,kneeLengthSum:h,intPanelPtBoards:u,intPanelSheets:s}},[p]),y=(0,a.useRef)("");(0,a.useEffect)(()=>{let e={int2x6LF:N.int2x6LF,int2x4LF:N.int2x4LF,intPlatePieces:N.intPlatePieces,intBottomPlatePiecesPanel:N.intBottomPlatePiecesPanel,intPTLFSum:N.intPTLFSum,intPanelSheets:N.intPanelSheets,panelsSubtotal:N.panelsSubtotal,shearLengthSum:N.shearLengthSum,shearPanelLenFt:N.shearPanelLenFt,bearingLengthSum:N.bearingLengthSum,bearingPanelLenFt:N.bearingPanelLenFt,partitionLengthSum:N.partitionLengthSum,kneeLengthSum:N.kneeLengthSum,intPanelPtBoards:N.intPanelPtBoards},t=JSON.stringify(e);t!==y.current&&(y.current=t,null==s||s(e),null==o||o(e.bearingLengthSum),null==c||c(e.partitionLengthSum),null==u||u(e.kneeLengthSum))},[N,s,o,c,u]);let w=N.panelsSubtotal;return(0,n.jsxs)("section",{className:"ew-stack",children:[(0,n.jsxs)("div",{className:"ew-card",style:{marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem"},children:[(0,n.jsx)("h2",{className:"ew-h2",style:{margin:0},children:t}),(0,n.jsxs)("div",{className:"ew-right",title:"Sum of all interior wall section subtotals for this level",style:{fontWeight:700},children:["Total: ",Number.isFinite(Number(w))?B.format(Number(w)):"—"]})]}),0===m.length&&(0,n.jsxs)("div",{className:"ew-card",children:[(0,n.jsx)("div",{className:"ew-subtle",children:"No interior wall sections yet."}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("button",{className:"ew-btn ew-btn--turq",onClick:g,children:"+ Add interior wall section"})})]}),m.map((e,a)=>(0,n.jsx)(C,{title:"".concat(t," — Section ").concat(a+1),persistKey:"int:".concat(l,":").concat(e.id),onRemove:()=>v(e.id),onStatsChange:t=>x(e.id,t),bottomDefaultFamily:r?"PT":"SPF#2"},e.id)),(0,n.jsxs)("div",{className:"ew-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"1rem"},children:[(0,n.jsx)("div",{className:"ew-subtle",children:"Add another interior wall section to this level."}),(0,n.jsx)(d,{onClick:g,title:"Add Section",label:"Add Section"})]})]})}let E=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),A=e=>Number.isFinite(Number(e))?E.format(Number(e)):"—",I=e=>e&&e.item?I(e.item):e,q=e=>I(e),D=e=>{var t,l,n;return(null==(t=I(e))?void 0:t.unit)||(null==(n=I(e))||null==(l=n.raw)?void 0:l.unit)||"pcs"},W=e=>{var t,l,n,a;return(null==(t=I(e))?void 0:t.sizeDisplay)||(null==(l=I(e))?void 0:l.sizeLabel)||(null==(a=I(e))||null==(n=a.raw)?void 0:n.sizeDisplay)||""},O=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,l=String(e).trim().split(/\s+/),n=l.slice(0,t).join(" ");return l.length>t?"".concat(n,"…"):n||""};function R(e){var t,l,s,r,o;let{title:c="Loose materials — Wall Panels",persistKey:u="loose-panels-0",onRemove:d,extLengthLF:m,extZipSheetsFinal:h,extZipSheetsSum:p,int2x6LF:g,int2x4LF:y,ptLFTotal:w,onTotalChange:j,onSubtotalChange:f,levelId:P,platePiecesTotal:S,onGeneralChange:k}=e,L=(0,a.useMemo)(()=>{var e;return Number(null!=(e=null!=h?h:p)?e:0)},[h,p]),F=L>0,[C,B]=(0,i.g)("inv:v1:notes:".concat(u),{}),M=e=>C[e]||{plan:"",comment:"",open:!1},T=(e,t)=>B(l=>({...l,[e]:{...M(e),...t}})),E=e=>T(e,{open:!M(e).open}),[I,O]=(0,a.useState)({lengthLF:Number(null!=m?m:0),panelBandLF:Number(null!=m?m:0),panelBandHeightFt:4,lfPerZipSheet:12,tapeRollLenFt:75,openingsBlockingLF:0}),[R,_]=(0,a.useState)(!1),[U,H]=(0,a.useState)({int2x6LF:null!=g?g:0,int2x4LF:null!=y?y:0,blockingLF:0}),[G,V]=(0,a.useState)({secondBottom:!1,extraSheathing:!1}),[K,Q]=(0,a.useState)({extBottomPT:null,extTopPlate:null,panelBandSheathing:null,zipTape:null,openingsBlocking:null,secondBottom:null,extraSheathing:null,int2x6PT:null,int2x6Plate:null,int2x4PT:null,int2x4Plate:null,intCabinetBlocking:null}),Z=e=>t=>Q(l=>({...l,[e]:t})),$=Number(null!=(s=null!=m?m:I.lengthLF)?s:0),J=Number(null!=(r=null!=g?g:U.int2x6LF)?r:0),X=Number(null!=(o=null!=y?y:U.int2x4LF)?o:0);(0,a.useEffect)(()=>{if(!R){var e;let t=Number(null!=(e=null!=m?m:I.lengthLF)?e:0);O(e=>({...e,panelBandLF:t}))}},[m,R]);let Y=(0,N._3)(W(K.extBottomPT))||16,ee=(0,N._3)(W(K.extTopPlate))||16,et=(0,N._3)(W(K.openingsBlocking))||10,el=(0,N._3)(W(K.secondBottom))||16,en=(0,N._3)(W(K.int2x6PT))||16,ea=(0,N._3)(W(K.int2x6Plate))||16,ei=(0,N._3)(W(K.int2x4PT))||16,es=(0,N._3)(W(K.int2x4Plate))||16,er=(0,a.useMemo)(()=>{let e=[];{let t=(0,v.M4)({lengthLF:Number($)||0,boardLenFt:Math.max(Number(Y)||0,1),item:q(K.extBottomPT),unit:D(K.extBottomPT)});e.push({key:"extBottomPT",label:"PT Bottom Plates – Loose",...t,item:q(K.extBottomPT),wastePct:5})}{let t=(0,v.wm)({lengthLF:Number($)||0,boardLenFt:Math.max(Number(ee)||0,1),item:q(K.extTopPlate),unit:D(K.extTopPlate)});e.push({key:"extTopPlate",label:"Top Plates – Loose",...t,item:q(K.extTopPlate),wastePct:5})}{let t=(0,v.$p)({panelBandLF:Number(I.panelBandLF||0),bandHeightFt:4,item:q(K.panelBandSheathing),unit:D(K.panelBandSheathing)||"sheet",wastePct:20});e.push({key:"panelBandSheathing",label:"Panel band sheathing",...t,item:q(K.panelBandSheathing),wastePct:20})}if(G.extraSheathing){let t=(0,v.q6)({extLengthLF:Number($)||0,bandHeightFt:Number(I.panelBandHeightFt||4),item:q(K.extraSheathing),unit:D(K.extraSheathing)||"sheet"});e.push({key:"extraSheathing",label:"Extra sheathing (optional)",...t,item:q(K.extraSheathing),wastePct:10})}if(F){var t,l;let n=Number((null==(t=e.find(e=>"panelBandSheathing"===e.key))?void 0:t.qtyFinal)||0),a=G.extraSheathing?Number((null==(l=e.find(e=>"extraSheathing"===e.key))?void 0:l.qtyFinal)||0):0,i=(Number(L)+n+a)/6,s=Math.ceil(i),r=D(K.zipTape)||"roll",o=q(K.zipTape),c=(0,N.Ed)(o),u=s*(Number(c)||0);e.push({key:"zipTape",label:"Tape – ZIP system",unit:r,qtyRaw:i,qtyFinal:s,unitPrice:c,subtotal:u,item:o,wastePct:0})}{let t=(0,v.bs)({openingsLF:Number(I.openingsBlockingLF||0),boardLenFt:Math.max(Number(et)||0,1),item:q(K.openingsBlocking),unit:D(K.openingsBlocking)});e.push({key:"openingsBlocking",label:"Blocking at openings",...t,item:q(K.openingsBlocking),wastePct:10})}if(G.secondBottom){let t=(0,v.C9)({lengthLF:Number($)||0,boardLenFt:Math.max(Number(el)||0,1),item:q(K.secondBottom),unit:D(K.secondBottom)});e.push({key:"secondBottom",label:"Second bottom plate (optional)",...t,item:q(K.secondBottom),wastePct:5})}return e},[K,G,$,L,I.panelBandLF,I.panelBandHeightFt,I.lfPerZipSheet,I.tapeRollLenFt,I.openingsBlockingLF,Y,ee,et,el,F]),eo=(0,a.useMemo)(()=>Object.fromEntries(er.map(e=>[e.key,e])),[er]),ec=Math.ceil((null==(t=eo.panelBandSheathing)?void 0:t.qtyFinal)||0),eu=G.extraSheathing?Math.ceil((null==(l=eo.extraSheathing)?void 0:l.qtyFinal)||0):0,ed=(0,a.useMemo)(()=>{var e;return Number((null==(e=er.find(e=>"panelBandSheathing"===e.key))?void 0:e.qtyFinal)||0)},[er]),em=(0,a.useMemo)(()=>{var e;return Number((null==(e=er.find(e=>"extraSheathing"===e.key))?void 0:e.qtyFinal)||0)},[er]),eh=(0,a.useMemo)(()=>Number(h||p||0),[h,p]),ep=(0,a.useMemo)(()=>{let e=[];{let t=(0,v.$8)({lengthLF:Number(J)||0,boardLenFt:Math.max(Number(en)||0,1),item:q(K.int2x6PT),unit:D(K.int2x6PT),wastePct:5});e.push({key:"int2x6PT",label:"Interior 2\xd76 — PT Plates – Loose",...t,item:q(K.int2x6PT),wastePct:5})}{let t=(0,v.TI)({lengthLF:Number(J)||0,boardLenFt:Math.max(Number(ea)||0,1),item:q(K.int2x6Plate),unit:D(K.int2x6Plate),wastePct:5});e.push({key:"int2x6Plate",label:"Interior 2\xd76 — Plates – Loose",...t,item:q(K.int2x6Plate),wastePct:5})}{let t=(0,v.d6)({lengthLF:Number(X)||0,boardLenFt:Math.max(Number(ei)||0,1),item:q(K.int2x4PT),unit:D(K.int2x4PT),wastePct:5});e.push({key:"int2x4PT",label:"Interior 2\xd74 — PT Plates – Loose",...t,item:q(K.int2x4PT),wastePct:5})}{let t=(0,v.B4)({lengthLF:Number(X)||0,boardLenFt:Math.max(Number(es)||0,1),item:q(K.int2x4Plate),unit:D(K.int2x4Plate),wastePct:5});e.push({key:"int2x4Plate",label:"Interior 2\xd74 — Plates – Loose",...t,item:q(K.int2x4Plate),wastePct:5})}{let t=(0,N._3)(W(K.intCabinetBlocking))||8,l=(0,v.oN)({blockingLF:Number(U.blockingLF||0),boardLenFt:Math.max(t,1),item:q(K.intCabinetBlocking),unit:D(K.intCabinetBlocking)});e.push({key:"intCabinetBlocking",label:"Walls (general) — Blocking for Bathroom & Kitchen",...l,item:q(K.intCabinetBlocking),wastePct:10})}return e},[K,J,X,en,ea,ei,es,U.blockingLF]),eb=(0,a.useMemo)(()=>{var e,t,l,n;let a=Math.ceil((null==(e=er.find(e=>"extTopPlate"===e.key))?void 0:e.qtyFinal)||0),i=Math.ceil((null==(t=er.find(e=>"secondBottom"===e.key))?void 0:t.qtyFinal)||0);return a+i+Math.ceil((null==(l=ep.find(e=>"int2x6Plate"===e.key))?void 0:l.qtyFinal)||0)+Math.ceil((null==(n=ep.find(e=>"int2x4Plate"===e.key))?void 0:n.qtyFinal)||0)},[er,ep]),ex=(0,a.useMemo)(()=>[{lf:Number($)||0,len:Math.max(Number(Y)||0,1)},{lf:Number(J)||0,len:Math.max(Number(en)||0,1)},{lf:Number(X)||0,len:Math.max(Number(ei)||0,1)}].reduce((e,t)=>{let{lf:l,len:n}=t;return e+Math.ceil(1.05*l/n)},0),[$,J,X,Y,en,ei]),eg=(0,a.useRef)(""),ev=(0,a.useRef)(k);(0,a.useEffect)(()=>{ev.current=k},[k]),(0,a.useEffect)(()=>{let e=[Number(eh)||0,Number(ed)||0,Number(em)||0,Number(eb)||0,String(P||""),Number(ex)||0].join("|");if(e!==eg.current){var t;eg.current=e,null==(t=ev.current)||t.call(ev,{id:P,sheetsExt:Number(eh)||0,sheetsBand:Number(ed)||0,sheetsExtra:Number(em)||0,platePiecesTotal:Number(eb)||0,ptPieces:Number(ex)||0})}},[eh,ed,em,eb,ex,P]);let eN=(0,a.useMemo)(()=>er.reduce((e,t)=>e+(t.subtotal||0),0)+ep.reduce((e,t)=>e+(t.subtotal||0),0),[er,ep]),ey="minmax(220px,1.3fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr",ew={fontFamily:"'Nova Flat', cursive",color:"#f18d5b",fontWeight:700,marginLeft:"auto"};return(0,a.useEffect)(()=>{"function"==typeof f&&f({subtotal:Number(eN)||0}),"function"==typeof j&&j(Number(eN)||0)},[eN,f,j]),(0,n.jsx)("div",{className:"ew-card",children:(0,n.jsxs)(x.A,{title:c,defaultOpen:!0,actions:d?(0,n.jsx)("button",{className:"ew-btn",onClick:d,children:"Remove section"}):null,bar:e=>{let{open:t,toggle:l}=e;return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,width:"100%"},children:[(0,n.jsx)("button",{type:"button",className:"acc__button",onClick:l,"aria-expanded":t,title:t?"Collapse":"Expand",children:(0,n.jsx)("img",{src:t?"/icons/minimize.png":"/icons/down.png",alt:t?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}})}),(0,n.jsx)("span",{className:"ew-head",children:c}),(0,n.jsxs)("div",{style:ew,children:["Subtotal: ",A(eN)]}),d&&(0,n.jsx)("div",{style:{marginLeft:"8px"},children:(0,n.jsx)("button",{className:"ew-btn",onClick:d,children:"Remove section"})})]})},children:[(0,n.jsx)("h3",{className:"ew-h3",style:{marginTop:0,marginBottom:6},children:"Exterior walls"}),(0,n.jsxs)("div",{className:"controls4",style:{marginBottom:12},children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Exterior wall length (LF)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=m?m:I.lengthLF,onChange:e=>O(t=>({...t,lengthLF:Number(e.target.value)})),disabled:"number"==typeof m,title:"number"==typeof m?"Provided by context":"Manual"})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Panel band LF"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:I.panelBandLF,onChange:e=>{let t=Number(e.target.value);_(!0),O(e=>({...e,panelBandLF:Number.isFinite(t)?t:0}))},style:{width:140,textAlign:"right"}}),(0,n.jsx)("button",{type:"button",className:"ew-btn-secondary",onClick:()=>{_(!1),O(e=>{var t;return{...e,panelBandLF:Number(null!=(t=null!=m?m:e.lengthLF)?t:0)}})},title:"Use Exterior LF",children:"↺ use exterior LF"})]})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Band height (ft)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:I.panelBandHeightFt,onChange:e=>O(t=>({...t,panelBandHeightFt:Number(e.target.value)}))})]})]}),(0,n.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":ey},children:[(0,n.jsx)("div",{children:"Item"}),(0,n.jsx)("div",{children:"Vendor \xb7 Family \xb7 Size"}),(0,n.jsx)("div",{className:"ew-right",children:"Qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,n.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,n.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,n.jsx)("div",{children:"Notes"}),(0,n.jsx)("div",{})]}),(0,n.jsxs)("div",{className:"ew-rows",children:[(0,n.jsx)(z,{gridCols:ey,label:"PT Bottom Plates – Loose",noteKey:"loose:extBottomPT",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsx)(b.A,{compact:!0,onSelect:Z("extBottomPT"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"PT",defaultSizeLabel:"2x6\"-16'"}),row:er.find(e=>"extBottomPT"===e.key)}),(0,n.jsx)(z,{gridCols:ey,label:"Top Plates – Loose",noteKey:"loose:extTopPlate",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsx)(b.A,{compact:!0,onSelect:Z("extTopPlate"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x6\"-16'"}),row:er.find(e=>"extTopPlate"===e.key)}),(0,n.jsx)(z,{gridCols:ey,label:"Panel band sheathing",noteKey:"loose:panelBandSheathing",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsxs)("div",{className:"ew-inline",style:{alignItems:"end"},children:[(0,n.jsx)(b.A,{compact:!0,onSelect:Z("panelBandSheathing"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"Green Zip"}),(0,n.jsx)("div",{className:"ew-hint",children:"Here: 4′ band ⇒ sheets ≈ (Exterior LF \xf7 8) + waste"})]}),row:er.find(e=>"panelBandSheathing"===e.key)}),F&&(0,n.jsx)(z,{gridCols:ey,label:"Tape – ZIP system",noteKey:"loose:zipTape",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsxs)("div",{className:"ew-inline",style:{alignItems:"end"},children:[(0,n.jsx)(b.A,{compact:!0,onSelect:Z("zipTape"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"ZIP Flashing Tape"}),(0,n.jsxs)("div",{className:"ew-hint",children:["ZIP sheets = (ext: ",L,") + (band: ",ec,")",G.extraSheathing?" + (extra: ".concat(eu,")"):""]})]}),row:er.find(e=>"zipTape"===e.key)}),(0,n.jsx)(z,{gridCols:ey,label:"Blocking at openings",noteKey:"loose:openingsBlocking",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsxs)("div",{className:"ew-inline",style:{alignItems:"end"},children:[(0,n.jsx)(b.A,{compact:!0,onSelect:Z("openingsBlocking"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2"}),(0,n.jsxs)("label",{style:{minWidth:170},children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Openings blocking (LF)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",value:I.openingsBlockingLF,onChange:e=>O(t=>({...t,openingsBlockingLF:Number(e.target.value)}))})]})]}),row:er.find(e=>"openingsBlocking"===e.key)}),G.extraSheathing&&(0,n.jsx)(z,{gridCols:ey,label:"Extra sheathing (optional)",noteKey:"loose:extraSheathing",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsxs)("div",{className:"ew-inline",style:{alignItems:"end",gap:8},children:[(0,n.jsx)(b.A,{compact:!0,onSelect:Z("extraSheathing"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"CDX SE"}),(0,n.jsx)("button",{type:"button",className:"ew-btn",onClick:()=>V(e=>({...e,extraSheathing:!1})),title:"Remove this row",children:"Remove"})]}),row:er.find(e=>"extraSheathing"===e.key)}),G.secondBottom&&(0,n.jsx)(z,{gridCols:ey,label:"Second bottom plate (optional)",noteKey:"loose:secondBottom",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsxs)("div",{className:"ew-inline",style:{alignItems:"end",gap:8},children:[(0,n.jsx)(b.A,{compact:!0,onSelect:Z("secondBottom"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2"}),(0,n.jsx)("button",{type:"button",className:"ew-btn",onClick:()=>V(e=>({...e,secondBottom:!1})),title:"Remove this row",children:"Remove"})]}),row:er.find(e=>"secondBottom"===e.key)})]}),(0,n.jsxs)("div",{className:"ew-footer",style:{display:"flex",alignItems:"center",gap:12},children:[(0,n.jsx)("button",{className:"ew-btn",onClick:()=>V(e=>({...e,extraSheathing:!0})),disabled:G.extraSheathing,title:G.extraSheathing?"Already added":"Add extra sheathing row",children:"➕ Extra sheathing"}),(0,n.jsx)("button",{className:"ew-btn",onClick:()=>V(e=>({...e,secondBottom:!0})),disabled:G.secondBottom,title:G.secondBottom?"Already added":"Add second bottom plate row",children:"➕ Second bottom plate"}),(0,n.jsx)("div",{style:{flex:1}})]}),(0,n.jsx)("h3",{className:"ew-h3",style:{marginTop:16,marginBottom:6},children:"Interior walls"}),(0,n.jsxs)("div",{className:"controls4",style:{marginBottom:12},children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Interior 2\xd76 LF"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=g?g:U.int2x6LF,onChange:e=>H(t=>({...t,int2x6LF:Number(e.target.value)})),disabled:"number"==typeof g,title:"number"==typeof g?"Provided by context":"Manual"})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Interior 2\xd74 LF"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:null!=y?y:U.int2x4LF,onChange:e=>H(t=>({...t,int2x4LF:Number(e.target.value)})),disabled:"number"==typeof y,title:"number"==typeof y?"Provided by context":"Manual"})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Blocking LF (bath/kitchen)"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:U.blockingLF||0,onChange:e=>H(t=>({...t,blockingLF:Number(e.target.value)}))})]}),(0,n.jsx)("div",{})]}),(0,n.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":ey},children:[(0,n.jsx)("div",{children:"Item"}),(0,n.jsx)("div",{children:"Vendor \xb7 Family \xb7 Size"}),(0,n.jsx)("div",{className:"ew-right",children:"Qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,n.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,n.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,n.jsx)("div",{children:"Notes"}),(0,n.jsx)("div",{})]}),(0,n.jsxs)("div",{className:"ew-rows",children:[(0,n.jsx)(z,{gridCols:ey,label:"Interior 2\xd76 — PT Plates – Loose",noteKey:"loose:int2x6PT",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsx)(b.A,{compact:!0,onSelect:Z("int2x6PT"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"PT",defaultSizeLabel:"2x6\"-16'"}),row:ep.find(e=>"int2x6PT"===e.key)}),(0,n.jsx)(z,{gridCols:ey,label:"Interior 2\xd76 — Plates – Loose",noteKey:"loose:int2x6Plate",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsx)(b.A,{compact:!0,onSelect:Z("int2x6Plate"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x6\"-16'"}),row:ep.find(e=>"int2x6Plate"===e.key)}),(0,n.jsx)(z,{gridCols:ey,label:"Interior 2\xd74 — PT Plates – Loose",noteKey:"loose:int2x4PT",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsx)(b.A,{compact:!0,onSelect:Z("int2x4PT"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"PT",defaultSizeLabel:"2x4\"-16'"}),row:ep.find(e=>"int2x4PT"===e.key)}),(0,n.jsx)(z,{gridCols:ey,label:"Interior 2\xd74 — Plates – Loose",noteKey:"loose:int2x4Plate",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsx)(b.A,{compact:!0,onSelect:Z("int2x4Plate"),defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x4\"-16'"}),row:ep.find(e=>"int2x4Plate"===e.key)}),(0,n.jsx)(z,{gridCols:ey,label:"Walls (general) — Blocking for Bathroom & Kitchen",noteKey:"loose:intCabinetBlocking",noteApi:{getNote:M,toggleOpen:E,setNote:T},picker:(0,n.jsx)(b.A,{compact:!0,onSelect:Z("intCabinetBlocking"),defaultVendor:"Fairway Lumber",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x10\"-16'"}),row:ep.find(e=>"intCabinetBlocking"===e.key)})]})]})})}function z(e){var t,l,i;let{gridCols:s,label:r,picker:o,row:c,noteKey:u,noteApi:d,includeControl:m}=e,{getNote:h,toggleOpen:p,setNote:b}=d,x=h(u);return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":s},children:[(0,n.jsx)("div",{children:r}),(0,n.jsxs)("div",{children:[o,m&&(0,n.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",gap:8},children:(0,n.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,n.jsx)("input",{type:"checkbox",checked:m.checked,onChange:e=>m.onChange(e.target.checked)}),m.label]})})]}),(0,n.jsx)("div",{className:"ew-right",children:c?Math.ceil(c.qtyRaw||0):"—"}),(0,n.jsx)("div",{className:"ew-right",children:c?null!=(t=c.wastePct)?t:0:"—"}),(0,n.jsx)("div",{className:"ew-right",children:null!=(l=null==c?void 0:c.qtyFinal)?l:"—"}),(0,n.jsx)("div",{className:"ew-right",children:null!=(i=null==c?void 0:c.unit)?i:"—"}),(0,n.jsx)("div",{className:"ew-right ew-money",children:(null==c?void 0:c.unitPrice)?A(c.unitPrice):"—"}),(0,n.jsx)("div",{className:"ew-right ew-money",children:(null==c?void 0:c.subtotal)?A(c.subtotal):"—"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"ew-subtle",style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[(0,n.jsx)("span",{className:"ew-chip",title:x.plan||"",children:x.plan||"—"}),(0,n.jsx)("button",{className:"ew-btn",style:{padding:"4px 8px"},onClick:()=>p(u),children:x.open?"Hide":"Notes"})]}),x.comment&&(0,n.jsx)("div",{className:"ew-subtle",title:x.comment,children:O(x.comment)})]}),(0,n.jsx)("div",{})]}),x.open&&(0,n.jsx)("div",{className:"ew-row",style:{padding:12},children:(0,n.jsxs)("div",{className:"controls2",style:{width:"100%"},children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Plan label"}),(0,n.jsx)("input",{className:"ew-input focus-anim",type:"text",value:h(u).plan,onChange:e=>b(u,{plan:e.target.value})})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{className:"ew-subtle",children:"Comment"}),(0,n.jsx)("textarea",{className:"ew-input focus-anim",rows:3,value:h(u).comment,onChange:e=>b(u,{comment:e.target.value})})]})]})})]})}let _=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),U=e=>_.format(Number(e)||0),H=e=>e&&e.item?H(e.item):e,G=e=>H(e),V=e=>{var t,l,n;return(null==(t=H(e))?void 0:t.unit)||(null==(n=H(e))||null==(l=n.raw)?void 0:l.unit)||"box"},K=(0,a.memo)(function(e){var t;let{label:l,picker:i,row:s,hint:r,wasteEditor:o}=e;return(0,n.jsx)(a.Fragment,{children:(0,n.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":"minmax(220px,1.3fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr"},children:[(0,n.jsx)("div",{children:l}),(0,n.jsxs)("div",{children:[i,r?(0,n.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:r}):null]}),(0,n.jsx)("div",{className:"ew-right",children:Math.ceil(s.qtyRaw||0)}),(0,n.jsx)("div",{className:"ew-right",children:null!=o?o:s.wastePct}),(0,n.jsx)("div",{className:"ew-right",children:null!=(t=s.qtyFinal)?t:"—"}),(0,n.jsx)("div",{className:"ew-right",children:s.unit||"—"}),(0,n.jsx)("div",{className:"ew-right ew-money",children:s.unitPrice?U(s.unitPrice):"—"}),(0,n.jsx)("div",{className:"ew-right ew-money",children:s.subtotal?U(s.subtotal):"—"}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{})]})})},(e,t)=>{let l=e.row||{},n=t.row||{};return e.label===t.label&&e.hint===t.hint&&e.picker===t.picker&&l.qtyRaw===n.qtyRaw&&l.qtyFinal===n.qtyFinal&&l.unit===n.unit&&l.unitPrice===n.unitPrice&&l.subtotal===n.subtotal&&l.wastePct===n.wastePct}),Q=(0,a.memo)(function(e){let{title:t="Panels — Nails (this level)",persistKey:l="panel-nails-default",totalPanelSheets:s=0,totalBottomPlatePiecesPanel:r=0,ptPlatePiecesPanels:o,panelPtBoards:c,onTotalChange:u}=e,[d,m]=(0,i.g)("inv:v1:".concat(l,":ui"),{collapsed:!0}),h=!!d.collapsed,p=(0,a.useCallback)(e=>{m(t=>({...t,collapsed:!!e}))},[m]),g=(0,a.useMemo)(()=>{var e;return Number(null!=(e=null!=o?o:c)?e:0)},[o,c]),[v,y]=(0,a.useState)({nailsSheath:null,nailsFrame8d:null,nailsFrame12d:null}),w=(0,a.useCallback)(e=>t=>{y(l=>l[e]===t?l:{...l,[e]:t})},[]),[j,f]=(0,a.useState)({sheath:40,frame8d:40,frame12d:40});(0,a.useMemo)(()=>Number(s||0),[s]);let P=(0,a.useMemo)(()=>{var e;let t=80*(Number(s)||0)/2700,l=Number(null!=(e=j.sheath)?e:40),n=Math.ceil(t*(1+l/100)),a=V(v.nailsSheath),i=G(v.nailsSheath),r=(0,N.Ed)(i),o=n*(Number(r)||0);return{qtyRaw:t,qtyFinal:n,unit:a,item:i,unitPrice:r,subtotal:o,wastePct:l}},[s,v.nailsSheath,j.sheath]),S=(0,a.useMemo)(()=>{var e;let t=25*g/2700,l=Number(null!=(e=j.frame8d)?e:40),n=Math.ceil(t*(1+l/100)),a=V(v.nailsFrame8d),i=G(v.nailsFrame8d),s=(0,N.Ed)(i),r=n*(Number(s)||0);return{boards:g,qtyRaw:t,qtyFinal:n,unit:a,item:i,unitPrice:s,subtotal:r,wastePct:l}},[g,v.nailsFrame8d,j.frame8d]),k=(0,a.useMemo)(()=>{var e;let t=Number(r)||0,l=80*t/2500,n=Number(null!=(e=j.frame12d)?e:40),a=Math.ceil(l*(1+n/100)),i=V(v.nailsFrame12d),s=G(v.nailsFrame12d),o=(0,N.Ed)(s),c=a*(Number(o)||0);return{boards:t,qtyRaw:l,qtyFinal:a,unit:i,item:s,unitPrice:o,subtotal:c,wastePct:n}},[r,v.nailsFrame12d,j.frame12d]),L=(0,a.useMemo)(()=>(P.subtotal||0)+(S.subtotal||0)+(k.subtotal||0),[P.subtotal,S.subtotal,k.subtotal]),F=(0,a.useRef)(u);(0,a.useEffect)(()=>{F.current=u},[u]);let C=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=Number(L)||0;if(e!==C.current){var t;C.current=e,null==(t=F.current)||t.call(F,{total:e})}},[L]);let B=(0,a.useMemo)(()=>(0,n.jsx)(b.A,{compact:!0,onSelect:w("nailsSheath"),defaultVendor:"Concord",defaultFamilyLabel:"Bright Ring Coil",defaultSizeLabel:"8D-2-3/8x.113-2.7M"}),[w]),M=(0,a.useMemo)(()=>(0,n.jsx)(b.A,{compact:!0,onSelect:w("nailsFrame8d"),defaultVendor:"Concord",defaultFamilyLabel:"Galvanized Ring Coil",defaultSizeLabel:'8D-2-3/8"'}),[w]),T=(0,a.useMemo)(()=>(0,n.jsx)(b.A,{compact:!0,onSelect:w("nailsFrame12d"),defaultVendor:"Concord",defaultFamilyLabel:"Bright Common Coil",defaultSizeLabel:"12D-3-1/4x.120-2.5M"}),[w]),E=(0,a.useMemo)(()=>"Panel sheets (Ext + Int Shear): ".concat(s," → boxes = ceil(((sheets \xd7 80) / 2700) \xd7 (1 + waste%))"),[s]),A=(0,a.useMemo)(()=>"PT plate boards (panels): ".concat(g," → boxes = ceil(((boards \xd7 25) / 2700) \xd7 (1 + waste%))"),[g]),I=(0,a.useMemo)(()=>"Bottom plate boards (panels): ".concat(r," → boxes = ceil(((boards \xd7 80) / 2500) \xd7 (1 + waste%))"),[r]);return(0,n.jsx)("div",{className:"ew-card",children:(0,n.jsxs)(x.A,{open:!h,onOpenChange:e=>p(!e),bar:e=>{let{open:l,toggle:a}=e;return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,width:"100%"},children:[(0,n.jsx)("button",{type:"button",className:"acc__button",onClick:a,"aria-expanded":l,title:l?"Collapse":"Expand",children:(0,n.jsx)("img",{src:l?"/icons/minimize.png":"/icons/down.png",alt:l?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}})}),(0,n.jsx)("span",{className:"ew-head",children:t})," ",(0,n.jsx)("div",{style:{marginLeft:"auto"}}),(0,n.jsxs)("div",{className:"ew-right",style:{color:"#f18d5b",fontWeight:700},children:[" ","Subtotal: ",U(L)]})]})},children:[(0,n.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":"minmax(220px,1.3fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr"},children:[(0,n.jsx)("div",{children:"Item"}),(0,n.jsx)("div",{children:"Vendor \xb7 Family \xb7 Size"}),(0,n.jsx)("div",{className:"ew-right",children:"Qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,n.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,n.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{})]}),(0,n.jsxs)("div",{className:"ew-rows",children:[(0,n.jsx)(K,{label:"Framing nails (8D)",row:S,picker:M,hint:A,wasteEditor:(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:j.frame8d,onChange:e=>f(t=>({...t,frame8d:Number(e.target.value)||0})),style:{width:80,padding:6,textAlign:"right"},title:"Waste %"})}),(0,n.jsx)(K,{label:"Sheathing nails",row:P,picker:B,hint:E,wasteEditor:(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:j.sheath,onChange:e=>f(t=>({...t,sheath:Number(e.target.value)||0})),style:{width:80,padding:6,textAlign:"right"},title:"Waste %"})}),(0,n.jsx)(K,{label:"Framing nails (12D)",row:k,picker:T,hint:I,wasteEditor:(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",inputMode:"decimal",value:j.frame12d,onChange:e=>f(t=>({...t,frame12d:Number(e.target.value)||0})),style:{width:80,padding:6,textAlign:"right"},title:"Waste %"})})]})]})})},(e,t)=>{var l,n,a,i;return e.totalPanelSheets===t.totalPanelSheets&&e.totalBottomPlatePiecesPanel===t.totalBottomPlatePiecesPanel&&(null!=(n=null!=(l=e.ptPlatePiecesPanels)?l:e.panelPtBoards)?n:0)===(null!=(i=null!=(a=t.ptPlatePiecesPanels)?a:t.panelPtBoards)?i:0)&&e.title===t.title&&e.persistKey===t.persistKey});function Z(e){var t,l;let{id:s,name:r,onRemove:o,onLooseTotal:c=()=>{},onLevelTotal:u=()=>{},onExteriorPanelLenChange:d,onExteriorLF:m,onInteriorShearLF:h,onInteriorShearPanelLenChange:b,onInteriorBearingLF:v,onInteriorNonLoadLF:N,onKneeWallLF:y,levelsCount:w,panelsTotalAllSections:j,onLooseGeneralChange:f}=e,[P,S]=(0,i.g)("inv:v1:level-ui:".concat(s),{collapsed:!1}),k=!!P.collapsed,[L,F]=(0,a.useState)(null),[C,B]=(0,a.useState)({int2x6LF:0,int2x4LF:0,intPlatePieces:0,intPTLFSum:0,panelsSubtotal:0}),[M,E]=(0,a.useState)(0),A=(0,a.useMemo)(()=>Math.ceil(Number((null==L?void 0:L.extPanelPtBoards)||0))+Math.ceil(Number((null==C?void 0:C.intPanelPtBoards)||0)),[null==L?void 0:L.extPanelPtBoards,null==C?void 0:C.intPanelPtBoards]),I=(0,a.useMemo)(()=>Math.ceil(Number((null==L?void 0:L.extBottomPlatePiecesPanel)||0))+Math.ceil(Number((null==C?void 0:C.intBottomPlatePiecesPanel)||0)),[null==L?void 0:L.extBottomPlatePiecesPanel,null==C?void 0:C.intBottomPlatePiecesPanel]),[q,D]=(0,a.useState)(0),[W,O]=(0,a.useState)(0),z=(0,a.useCallback)(e=>{let t=Number(e)||16;O(t),null==d||d({id:s,len:t})},[s,d]),_=(0,a.useCallback)(e=>{B(e||null),e&&(null==h||h({id:s,lf:Number(e.shearLengthSum)||0}),null==b||b({id:s,len:Number(e.shearPanelLenFt)||8}),null==v||v({id:s,lf:Number(e.bearingLengthSum)||0}),null==N||N({id:s,lf:Number(e.partitionLengthSum)||0}),null==y||y({id:s,lf:Number(e.kneeLengthSum)||0}))},[s,h,b,v,N,y]),U=(0,a.useCallback)(e=>{let t=Number(null==e?void 0:e.subtotal)||0;D(t),null==c||c({id:s,subtotal:t})},[s,c]),H=(0,a.useCallback)(e=>{E(Number(null==e?void 0:e.total)||0)},[]),G=(0,a.useMemo)(()=>{let e=Number(null==L?void 0:L.panelsSubtotal)||0,t=Number(null==C?void 0:C.panelsSubtotal)||0;return e+t+(Number(q)||0)+(Number(M)||0)},[null==L?void 0:L.panelsSubtotal,null==C?void 0:C.panelsSubtotal,q,M]),V=(0,a.useMemo)(()=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),[]);(0,a.useEffect)(()=>{null==u||u({id:s,total:G})},[s,G,u]),null==L||L.extPlatePieces,null==C||C.intPlatePieces;let K=(0,a.useMemo)(()=>Number((null==L?void 0:L.extPanelSheets)||0)+Number((null==C?void 0:C.intPanelSheets)||0),[null==L?void 0:L.extPanelSheets,null==C?void 0:C.intPanelSheets]),Z={fontFamily:"'Nova Mono', monospace"};return(0,n.jsx)("section",{className:"ew-stack",children:(0,n.jsxs)(x.A,{open:!k,onOpenChange:e=>{let t;return t=!e,S(e=>({...e,collapsed:!!t}))},bar:e=>{let{open:t,toggle:l}=e;return(0,n.jsxs)("div",{style:{...Z,display:"flex",alignItems:"center",gap:8},children:[(0,n.jsxs)("button",{type:"button",className:"acc__button",onClick:l,title:t?"Collapse":"Expand","aria-label":"".concat(t?"Collapse":"Expand"," ").concat(r),children:[(0,n.jsx)("img",{src:t?"/icons/down.png":"/icons/minimize.png",alt:t?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}}),(0,n.jsx)("span",{className:"ew-head",children:r})]}),(0,n.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",fontWeight:800,fontSize:16,color:"#f18d5b"},title:"Level total (Panels + Loose)",children:["Level total: ",V.format(Number(G)||0)]}),o?(0,n.jsx)(g.A,{onClick:o,title:"Remove level",label:"Remove level"}):null]})},children:[(0,n.jsx)(p,{levelId:s,onTotalsChange:e=>F(e),title:"".concat(r," — Exterior walls"),onLengthLFChange:e=>null==m?void 0:m({id:s,lf:e}),onPanelLenFtChange:z,isLevelOne:/(\b|^)level\s*1(\b|$)/i.test(String(r||""))}),(0,n.jsx)(T,{levelId:s,onTotalsChange:_,title:"".concat(r," — Interior walls"),isLevelOne:/(\b|^)level\s*1(\b|$)/i.test(String(r||"")),onInteriorBearingLF:v,onBearingLFChange:e=>null==v?void 0:v({id:s,lf:Number(e)||0}),onPartitionLFChange:e=>null==N?void 0:N({id:s,lf:Number(e)||0}),onKneeLFChange:e=>null==y?void 0:y({id:s,lf:Number(e)||0})}),(0,n.jsx)(Q,{title:"".concat(r," — Panel nails"),persistKey:"panel-nails:".concat(s),platePiecesPanels:Number(((null==L?void 0:L.extPlatePieces)||0)+((null==C?void 0:C.intPlatePieces)||0))-I,ptPlatePiecesPanels:A,totalPanelSheets:K,totalBottomPlatePiecesPanel:I,onTotalChange:H}),(0,n.jsx)(R,{title:"".concat(r," — Loose materials (wall panels)"),persistKey:"loose:".concat(s),onSubtotalChange:U,extLengthLF:Number((null==L?void 0:L.extLengthSum)||0),extZipSheetsFinal:Number(null!=(l=null!=(t=null==L?void 0:L.extZipSheetsFinal)?t:null==L?void 0:L.extZipSheetsSum)?l:0),extZipSheetsSum:null==L?void 0:L.extZipSheetsSum,int2x6LF:Number((null==C?void 0:C.int2x6LF)||0),int2x4LF:Number((null==C?void 0:C.int2x4LF)||0),ptLFTotal:Number((null==L?void 0:L.extPTLFSum)||0)+Number((null==C?void 0:C.intPTLFSum)||0),platePiecesTotal:Number((null==L?void 0:L.extPlatePieces)||0)+Number((null==C?void 0:C.intPlatePieces)||0),totalPanelsAllLevels:Number(j||0),levelsCount:Number(w||1),levelId:s,onGeneralChange:f})]})})}let $={exteriorWalls:{ratePerLF:10.5,ratePerPanel:84},interiorShear:{ratePerLF:10.25,ratePerPanel:82},interiorBlocking:{ratePerLF:6.5,ratePerPanel:52},interiorNonLoad:{ratePerLF:6,ratePerPanel:48},kneeWall:{ratePerLF:4.5,ratePerPanel:36},windows:{each:20.05},exteriorDoors:{each:15.19},blocking2x10:{each:.6}},J=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),X=e=>J.format(Number(e||0)),Y=e=>Number(e||0).toLocaleString("en-US");function ee(e){let{rows:t={},panelLenFt:l=8,panelLenFtInterior:s=8,panelLenFtExterior:r,panelLenFtInteriorBlocking:o=8,rates:c=$,persistKey:u="inv:v1:pme:ui",onTotalChange:d,exteriorLF:m=0,interiorShearLF:h=0,interiorBlockingLF:p=0,interiorNonLoadLF:b,kneeWallLF:g}=e,[v,N]=(0,i.g)(u,{collapsed:!1}),y=!!v.collapsed,w=(0,a.useCallback)(e=>{N(t=>({...t,collapsed:!!e}))},[N]),j=(0,a.useMemo)(()=>({exteriorWalls:t.exteriorWalls||{lf:0,panels:0},interiorShear:t.interiorShear||{lf:0,panels:0},interiorBlockingOnly:t.interiorBlockingOnly||{lf:0,panels:0},interiorNonLoad:t.interiorNonLoad||{lf:0,panels:0},kneeWall:t.kneeWall||{lf:0,panels:0},windows:t.windows||{qty:0},exteriorDoors:t.exteriorDoors||{qty:0},blocking2x10:t.blocking2x10||{rows:0}}),[t]),[f,P]=(0,a.useState)(()=>{var e,t,l,n,a,i,s,r,o,u,d,m,h,p,b,x;return{exteriorWalls:null!=(o=null==(e=c.exteriorWalls)?void 0:e.ratePerLF)?o:0,interiorShear:null!=(u=null==(t=c.interiorShear)?void 0:t.ratePerLF)?u:0,interiorBlockingOnly:null!=(d=null==(l=c.interiorBlocking)?void 0:l.ratePerLF)?d:0,interiorNonLoad:null!=(m=null==(n=c.interiorNonLoad)?void 0:n.ratePerLF)?m:0,kneeWall:null!=(h=null==(a=c.kneeWall)?void 0:a.ratePerLF)?h:0,windows:null!=(p=null==(i=c.windows)?void 0:i.each)?p:0,exteriorDoors:null!=(b=null==(s=c.exteriorDoors)?void 0:s.each)?b:0,blocking2x10:null!=(x=null==(r=c.blocking2x10)?void 0:r.each)?x:0}}),[S,k]=(0,a.useState)({});(0,a.useEffect)(()=>{P(e=>{var t,l,n,a,i,s,r,o,u,d,m,h,p,b,x,g,v,N,y,w,j,f,P,k;return{exteriorWalls:S.exteriorWalls?e.exteriorWalls:null!=(d=null!=(u=null==(t=c.exteriorWalls)?void 0:t.ratePerLF)?u:e.exteriorWalls)?d:0,interiorShear:S.interiorShear?e.interiorShear:null!=(h=null!=(m=null==(l=c.interiorShear)?void 0:l.ratePerLF)?m:e.interiorShear)?h:0,interiorBlockingOnly:S.interiorBlockingOnly?e.interiorBlockingOnly:null!=(b=null!=(p=null==(n=c.interiorBlocking)?void 0:n.ratePerLF)?p:e.interiorBlockingOnly)?b:0,interiorNonLoad:S.interiorNonLoad?e.interiorNonLoad:null!=(g=null!=(x=null==(a=c.interiorNonLoad)?void 0:a.ratePerLF)?x:e.interiorNonLoad)?g:0,kneeWall:S.kneeWall?e.kneeWall:null!=(N=null!=(v=null==(i=c.kneeWall)?void 0:i.ratePerLF)?v:e.kneeWall)?N:0,windows:S.windows?e.windows:null!=(w=null!=(y=null==(s=c.windows)?void 0:s.each)?y:e.windows)?w:0,exteriorDoors:S.exteriorDoors?e.exteriorDoors:null!=(f=null!=(j=null==(r=c.exteriorDoors)?void 0:r.each)?j:e.exteriorDoors)?f:0,blocking2x10:S.blocking2x10?e.blocking2x10:null!=(k=null!=(P=null==(o=c.blocking2x10)?void 0:o.each)?P:e.blocking2x10)?k:0}})},[c,S]);let[L,F]=(0,a.useState)(()=>({exteriorWalls:Number(null!=r?r:l)||8,interiorShear:Number(null!=s?s:8)||8,interiorBlockingOnly:Number(null!=o?o:8)||8,interiorNonLoad:Number(null!=s?s:8)||8,kneeWall:Number(null!=s?s:8)||8})),[C,B]=(0,a.useState)({});(0,a.useEffect)(()=>{F(e=>({exteriorWalls:C.exteriorWalls?e.exteriorWalls:Number(null!=r?r:l)||8,interiorShear:C.interiorShear?e.interiorShear:Number(s)||8,interiorBlockingOnly:C.interiorBlockingOnly?e.interiorBlockingOnly:Number(o)||8,interiorNonLoad:C.interiorNonLoad?e.interiorNonLoad:Number(s)||8,kneeWall:C.kneeWall?e.kneeWall:Number(s)||8}))},[r,s,o,l,C]),(0,a.useMemo)(()=>new Set(["windows","exteriorDoors","blocking2x10"]),[]);let[M,T]=(0,a.useState)(()=>{var e,t,l,n,a,i;return{windows:null!=(n=null==(e=j.windows)?void 0:e.qty)?n:0,exteriorDoors:null!=(a=null==(t=j.exteriorDoors)?void 0:t.qty)?a:0,blocking2x10:null!=(i=null==(l=j.blocking2x10)?void 0:l.rows)?i:0}}),[E,A]=(0,a.useState)({});(0,a.useEffect)(()=>{T(e=>{var t,l,n,a,i,s;return{windows:E.windows?e.windows:null!=(a=null==(t=j.windows)?void 0:t.qty)?a:0,exteriorDoors:E.exteriorDoors?e.exteriorDoors:null!=(i=null==(l=j.exteriorDoors)?void 0:l.qty)?i:0,blocking2x10:E.blocking2x10?e.blocking2x10:null!=(s=null==(n=j.blocking2x10)?void 0:n.rows)?s:0}})},[j,E]);let I=(0,a.useMemo)(()=>{let e=[],t=(t,l,n)=>{var a,i,s;let r="exteriorWalls"===l?Number(m||0):"interiorShear"===l?Number(h||0):"interiorBlockingOnly"===l?Number(p||0):"interiorNonLoad"===l?Number(b||0):"kneeWall"===l?Number(g||0):0,o=Number(L[l])||8,c=Math.ceil(r/Math.max(1,o)*1.1),u=Number(null!=(i=null!=(a=f[l])?a:null==n?void 0:n.ratePerLF)?i:0),d=Number(null!=(s=null==n?void 0:n.ratePerPanel)?s:0);e.push({label:t,key:l,lf:r,panelLenFt:o,panels:c,ratePerLF:u,ratePerPanel:d,total:r*u,isQtyBased:!1})},l=(t,l,n)=>{var a,i,s;let r=Number(null!=(a=M[l])?a:0),o=Number(null!=(s=null!=(i=f[l])?i:null==n?void 0:n.each)?s:0);e.push({label:t,key:l,qty:r,lf:0,panelLenFt:"—",panels:"—",ratePerLF:o,ratePerPanel:"n/a",total:r*o,isQtyBased:!0})};return t("Exterior Walls","exteriorWalls",c.exteriorWalls),t("Interior Shear walls","interiorShear",c.interiorShear),t("Interior wall with blocking only","interiorBlockingOnly",c.interiorBlocking),t("Interior Non-load bearing walls","interiorNonLoad",c.interiorNonLoad),t("Knee wall","kneeWall",c.kneeWall),l("Windows","windows",c.windows),l("Exterior Doors","exteriorDoors",c.exteriorDoors),l("2x10 blocking rows","blocking2x10",c.blocking2x10),e},[c,L,f,M,m,h,p,b,g]),q=(0,a.useMemo)(()=>{let e=I.reduce((e,t)=>e+(Number(t.lf)||0),0);return{lf:e,panels:I.filter(e=>!e.isQtyBased).reduce((e,t)=>e+(Number(t.panels)||0),0),total:I.reduce((e,t)=>e+(Number(t.total)||0),0)}},[I]);(0,a.useEffect)(()=>{null==d||d({total:q.total,panels:q.panels})},[q.total,q.panels,d]);let D=(0,a.useCallback)(e=>t=>{let l=Number(t.target.value)||0;F(t=>({...t,[e]:Math.max(1,l)})),B(t=>({...t,[e]:!0}))},[]),W=(0,a.useCallback)(e=>t=>{let l=t.target.value;P(t=>({...t,[e]:l}))},[]),O=(0,a.useCallback)(e=>t=>{let l=parseFloat(t.target.value),n=Number.isFinite(l)?l:0;P(t=>({...t,[e]:n})),k(t=>({...t,[e]:!0}))},[]),R=(0,a.useCallback)(e=>t=>{let l=t.target.value;T(t=>({...t,[e]:l}))},[]),z=(0,a.useCallback)(e=>t=>{let l=parseInt(t.target.value,10),n=Number.isFinite(l)&&l>=0?l:0;T(t=>({...t,[e]:n})),A(t=>({...t,[e]:!0}))},[]);return(0,n.jsx)(x.A,{open:!y,onOpenChange:e=>w(!e),bar:e=>{let{open:t,toggle:l}=e;return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,width:"100%"},children:[(0,n.jsx)("button",{type:"button",className:"acc__button",onClick:l,"aria-expanded":t,title:t?"Collapse":"Expand",children:(0,n.jsx)("img",{src:t?"/icons/minimize.png":"/icons/down.png",alt:t?"Collapse section":"Expand section",width:16,height:16,className:"acc__chev",style:{display:"inline-block",verticalAlign:"middle"}})}),(0,n.jsx)("h2",{className:"ew-h2",style:{margin:0},children:"Panels Manufacture Estimate"}),(0,n.jsx)("div",{style:{marginLeft:"auto"}}),(0,n.jsx)("div",{className:"ew-right",title:"Panels manufacture subtotal",style:{fontWeight:800},children:X(q.total)})]})},children:(0,n.jsx)("div",{className:"table-wrap",children:(0,n.jsxs)("table",{className:"tbl",style:{width:"100%",tableLayout:"fixed"},children:[(0,n.jsxs)("colgroup",{children:[(0,n.jsx)("col",{style:{width:"26%"}}),(0,n.jsx)("col",{style:{width:"13%"}}),(0,n.jsx)("col",{style:{width:"13%"}}),(0,n.jsx)("col",{style:{width:"13%"}}),(0,n.jsx)("col",{style:{width:"12%"}}),(0,n.jsx)("col",{style:{width:"12%"}}),(0,n.jsx)("col",{style:{width:"11%"}})]}),(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Wall type"}),(0,n.jsx)("th",{className:"num",children:"LF / Qty"}),(0,n.jsx)("th",{className:"num",children:"Panel Length (ft)"}),(0,n.jsx)("th",{className:"num",children:"# Panels"}),(0,n.jsx)("th",{className:"num",children:"Rate per LF / $ Each"}),(0,n.jsx)("th",{className:"num",children:"Rate per Panel $"}),(0,n.jsx)("th",{className:"num",children:"Subtotal"})]})}),(0,n.jsx)("tbody",{children:I.map(e=>{var t,l,a;let i="exteriorWalls"===e.key||"interiorShear"===e.key||"interiorBlockingOnly"===e.key||"interiorNonLoad"===e.key||"kneeWall"===e.key;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.label}),(0,n.jsx)("td",{className:"num",children:e.isQtyBased?(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",min:"0",step:"1",value:null!=(t=M[e.key])?t:"",onChange:R(e.key),onBlur:z(e.key),style:{width:110,textAlign:"right",padding:"4px 8px"}}):(0,n.jsx)("span",{children:Number(e.lf||0).toLocaleString()})}),(0,n.jsx)("td",{className:"num",children:e.isQtyBased?"—":i?(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",min:"1",step:"0.01",value:null!=(l=L[e.key])?l:"",onChange:D(e.key),style:{width:90,textAlign:"right",padding:"4px 8px"}}):e.panelLenFt}),(0,n.jsx)("td",{className:"num",children:e.isQtyBased?"—":Y(e.panels)}),(0,n.jsx)("td",{className:"num",children:(0,n.jsx)("input",{className:"ew-input focus-anim",type:"number",step:"0.01",min:"0",value:null!=(a=f[e.key])?a:"",onChange:W(e.key),onBlur:O(e.key),style:{width:110,textAlign:"right",padding:"4px 8px"}})}),(0,n.jsx)("td",{className:"num",children:"n/a"===e.ratePerPanel?"n/a":X(e.ratePerPanel)}),(0,n.jsx)("td",{className:"num ew-money",children:X(e.total)})]},e.key)})}),(0,n.jsx)("tfoot",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{colSpan:3,style:{textAlign:"right"},children:"TOTALS"}),(0,n.jsx)("th",{className:"num ew-total-panels",children:Y(q.panels)}),(0,n.jsx)("th",{colSpan:2}),(0,n.jsx)("th",{className:"num ew-total-panels",children:X(q.total)})]})})]})})})}let et=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),el=e=>et.format(Number(e)||0),en=e=>e&&e.item?en(e.item):e,ea=e=>en(e),ei=e=>{var t,l,n;return(null==(t=en(e))?void 0:t.unit)||(null==(n=en(e))||null==(l=n.raw)?void 0:l.unit)||"box"},es="minmax(220px,1.3fr) 3.7fr 0.6fr 0.6fr 0.7fr 0.6fr 0.9fr 1fr 1.6fr 0.8fr",er=(0,a.memo)(function(e){var t,l;let{label:i,picker:s,row:r,hint:o}=e;return(0,n.jsx)(a.Fragment,{children:(0,n.jsxs)("div",{className:"ew-grid ew-row",style:{"--cols":es},children:[(0,n.jsx)("div",{children:i}),(0,n.jsxs)("div",{children:[s,o?(0,n.jsx)("div",{className:"ew-hint",style:{marginTop:6},children:o}):null]}),(0,n.jsx)("div",{className:"ew-right",children:Math.ceil(r.qtyRaw||0)}),(0,n.jsx)("div",{className:"ew-right",children:null!=(t=r.wastePct)?t:0}),(0,n.jsx)("div",{className:"ew-right",children:null!=(l=r.qtyFinal)?l:"—"}),(0,n.jsx)("div",{className:"ew-right",children:r.unit||"—"}),(0,n.jsx)("div",{className:"ew-right ew-money",children:r.unitPrice?el(r.unitPrice):"—"}),(0,n.jsx)("div",{className:"ew-right ew-money",children:r.subtotal?el(r.subtotal):"—"}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{})]})})},(e,t)=>{let l=e.row||{},n=t.row||{};return e.label===t.label&&e.hint===t.hint&&e.picker===t.picker&&l.qtyRaw===n.qtyRaw&&l.qtyFinal===n.qtyFinal&&l.unit===n.unit&&l.unitPrice===n.unitPrice&&l.subtotal===n.subtotal&&l.wastePct===n.wastePct});function eo(e){let{title:t="General — Nails & bracing (all levels)",totals:l={},onTotalChange:i}=e,{panelsAll:s=0,platePiecesAll:r=0,ptPiecesAll:o=null,sheetsExtAll:c=0,sheetsBandAll:u=0,sheetsExtraAll:d=0}=l,[m,h]=(0,a.useState)({nailsConcrete:null,nailsSheathing:null,nailsFraming:null,tempBracing:null}),p=(0,a.useCallback)(e=>h(t=>t.nailsConcrete===e?t:{...t,nailsConcrete:e}),[]),g=(0,a.useCallback)(e=>h(t=>t.nailsSheathing===e?t:{...t,nailsSheathing:e}),[]),v=(0,a.useCallback)(e=>h(t=>t.nailsFraming===e?t:{...t,nailsFraming:e}),[]),y=(0,a.useCallback)(e=>h(t=>t.tempBracing===e?t:{...t,tempBracing:e}),[]),w=(0,a.useMemo)(()=>Number(u)+Number(d),[c,u,d]),j=(0,a.useMemo)(()=>{let e=25*(Number(o)||0)/100,t=Math.ceil(1.4*e),l=ei(m.nailsConcrete)||"box",n=ea(m.nailsConcrete),a=(0,N.Ed)(n),i=t*(Number(a)||0);return{qtyRaw:e,qtyFinal:t,unit:l,item:n,unitPrice:a,subtotal:i,wastePct:40}},[o,m.nailsConcrete]),f=(0,a.useMemo)(()=>{let e=80*(Number(w)||0)/2700,t=Math.ceil(1.4*e),l=ei(m.nailsSheathing)||"box",n=ea(m.nailsSheathing),a=(0,N.Ed)(n),i=t*(Number(a)||0);return{qtyRaw:e,qtyFinal:t,unit:l,item:n,unitPrice:a,subtotal:i,wastePct:40}},[w,m.nailsSheathing]),P=(0,a.useMemo)(()=>{let e=25*(Number(r)||0)/2500,t=Math.ceil(1.4*e),l=ei(m.nailsFraming)||"box",n=ea(m.nailsFraming),a=(0,N.Ed)(n),i=t*(Number(a)||0);return{qtyRaw:e,qtyFinal:t,unit:l,item:n,unitPrice:a,subtotal:i,wastePct:40}},[r,m.nailsFraming]),S=(0,a.useMemo)(()=>{let e=3*Math.max(0,Number(s)||0),t=Math.ceil(e),l=ei(m.tempBracing)||"pcs",n=ea(m.tempBracing),a=(0,N.Ed)(n),i=t*(Number(a)||0);return{qtyRaw:e,qtyFinal:t,unit:l,item:n,unitPrice:a,subtotal:i,wastePct:0}},[s,m.tempBracing]),k=(0,a.useMemo)(()=>(j.subtotal||0)+(f.subtotal||0)+(P.subtotal||0)+(S.subtotal||0),[j.subtotal,f.subtotal,P.subtotal,S.subtotal]),L=(0,a.useRef)(i);(0,a.useEffect)(()=>{L.current=i},[i]);let F=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=Number(k)||0;if(e!==F.current){var t;F.current=e,null==(t=L.current)||t.call(L,{total:e})}},[k]);let C=(0,a.useMemo)(()=>(0,n.jsx)(b.A,{compact:!0,onSelect:p,defaultVendor:"Home Depot",defaultFamilyLabel:"Drive Pins with Washers (HD)",defaultSizeLabel:'3"-100s'}),[p]),B=(0,a.useMemo)(()=>(0,n.jsx)(b.A,{compact:!0,onSelect:g,defaultVendor:"Concord",defaultFamilyLabel:"Bright Ring Coil",defaultSizeLabel:"8D-2-3/8x.113-2.7M"}),[g]),M=(0,a.useMemo)(()=>(0,n.jsx)(b.A,{compact:!0,onSelect:v,defaultVendor:"Concord",defaultFamilyLabel:"Bright Common Coil",defaultSizeLabel:"12D-3-1/4x.120-2.5M"}),[v]),T=(0,a.useMemo)(()=>(0,n.jsx)(b.A,{compact:!0,onSelect:y,defaultVendor:"Gillies & Prittie Warehouse",defaultFamilyLabel:"SPF#2",defaultSizeLabel:"2x4\"-16'"}),[y]),E=(0,a.useMemo)(()=>{let e=Number(o)||0,t=new Intl.NumberFormat("en-US").format(e);return"PT pieces: ".concat(t," → boxes = pt pieces \xd7 25 / 100 + 40% waste")},[o]),A=(0,a.useMemo)(()=>"Loose sheets = (band: ".concat(u,")")+(d?" + (extra: ".concat(d,")"):""),[u,d]),I=(0,a.useMemo)(()=>"Loose non-PT boards = ".concat(r," → boxes = ceil((boards \xd7 25 / 2500) \xd7 1.4)"),[r]),q=(0,a.useMemo)(()=>"Bracing pieces = panels \xd7 3 (panels: ".concat(s,")"),[r]);return(0,n.jsx)("div",{className:"ew-card",children:(0,n.jsxs)(x.A,{title:t,defaultOpen:!0,summary:(0,n.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",color:"#f18d5b"},children:["Nails & Bracing subtotal: ",el(k)]}),children:[(0,n.jsxs)("div",{className:"ew-grid ew-head",style:{"--cols":es},children:[(0,n.jsx)("div",{children:"Item"}),(0,n.jsx)("div",{children:"Vendor \xb7 Family \xb7 Size"}),(0,n.jsx)("div",{className:"ew-right",children:"Qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Waste %"}),(0,n.jsx)("div",{className:"ew-right",children:"Final qty"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit"}),(0,n.jsx)("div",{className:"ew-right",children:"Unit price"}),(0,n.jsx)("div",{className:"ew-right",children:"Subtotal"}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{})]}),(0,n.jsxs)("div",{className:"ew-rows",children:[(0,n.jsx)(er,{label:"Concrete nails",row:j,picker:C,hint:E}),(0,n.jsx)(er,{label:"Sheathing nails",row:f,picker:B,hint:A}),(0,n.jsx)(er,{label:"Framing nails",row:P,picker:M,hint:I}),(0,n.jsx)(er,{label:"Temporary Bracing",row:S,picker:T,hint:q})]}),(0,n.jsx)("div",{className:"ew-footer",children:(0,n.jsxs)("div",{className:"ew-right",style:{marginLeft:"auto",color:"#f18d5b"},children:["Section subtotal: ",el(k)]})})]})})}function ec(){var e,t;return{id:(null==(t=crypto)||null==(e=t.randomUUID)?void 0:e.call(t))||"lvl-"+Math.random().toString(36).slice(2,8),name:""}}function eu(e){let{onGrandTotal:t}=e,[l,s]=(0,a.useState)({}),r=(0,a.useCallback)(e=>{let{id:t,sheetsExt:l=0,sheetsBand:n=0,sheetsExtra:a=0,platePiecesTotal:i=0,ptPieces:r=0}=e,o={sheetsExt:Number(l)||0,sheetsBand:Number(n)||0,sheetsExtra:Number(a)||0,platePiecesTotal:Number(i)||0,ptPieces:Number(r)||0};s(e=>{let l=e[t];return l&&l.sheetsExt===o.sheetsExt&&l.sheetsBand===o.sheetsBand&&l.sheetsExtra===o.sheetsExtra&&l.platePiecesTotal===o.platePiecesTotal&&l.ptPieces===o.ptPieces?e:{...e,[t]:o}})},[]),[o,c]=(0,a.useState)(0),[u,m]=(0,a.useState)(0),[h,p]=(0,a.useState)({}),b=(0,a.useCallback)(e=>{let{id:t,lf:l}=e;p(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),x=(0,a.useMemo)(()=>Object.values(h).reduce((e,t)=>e+(Number(t)||0),0),[h]),[g,v]=(0,a.useState)({}),N=(0,a.useCallback)(e=>{let{id:t,len:l}=e;v(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),y=(0,a.useMemo)(()=>{let e=Object.values(g).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[g]),[w,j]=(0,i.g)("inv:v1:levels",[{id:"level-1",name:"Level 1"}]);(0,a.useEffect)(()=>{if(!Array.isArray(w)||0===w.length)return void j([{id:ec().id,name:"Level 1"}]);let e=new Set,t=w.map(e=>({id:(null==e?void 0:e.id)||ec().id,name:(null==e?void 0:e.name)||""})).filter(t=>!e.has(t.id)&&(e.add(t.id),!0)).map((e,t)=>({...e,name:e.name||"Level ".concat(t+1)}));t.length===w.length&&t.every((e,t)=>e.id===w[t].id&&e.name===w[t].name)||j(t)},[]);let[f,P]=(0,a.useState)({}),[S,k]=(0,a.useState)({}),L=(0,a.useCallback)(()=>{let e=w.length+1,t=ec();t.name="Level ".concat(e),j(e=>[...e,t])},[w,j]),F=(0,a.useCallback)(e=>{j(t=>t.filter(t=>t.id!==e)),s(t=>{let l={...t};return delete l[e],l}),k(t=>{let l={...t};return delete l[e],l}),P(t=>{let l={...t};return delete l[e],l}),p(t=>{let l={...t};return delete l[e],l}),v(t=>{let l={...t};return delete l[e],l}),O(t=>{let l={...t};return delete l[e],l}),U(t=>{let l={...t};return delete l[e],l}),X(t=>{let l={...t};return delete l[e],l})},[j]),C=(0,a.useCallback)(e=>{let{id:t,subtotal:l}=e;k(e=>e[t]===l?e:{...e,[t]:l})},[]),B=(0,a.useCallback)(e=>{let{id:t,total:l}=e;P(e=>e[t]===l?e:{...e,[t]:l})},[]),M=(0,a.useMemo)(()=>Object.values(S).reduce((e,t)=>e+(Number(t)||0),0),[S]),T=(0,a.useMemo)(()=>Object.values(f).reduce((e,t)=>e+(Number(t)||0),0)+M+Number(o||0),[f,M,o]);(0,a.useEffect)(()=>{"function"==typeof t&&t(T)},[T,t]);let E=(0,a.useMemo)(()=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),[]),[A,I]=(0,a.useState)({exteriorWalls:{lf:0,panels:0},interiorShear:{lf:0,panels:0},interiorBlockingOnly:{lf:0,panels:0},interiorNonLoad:{lf:0,panels:0},kneeWall:{lf:0,panels:0},windows:{qty:0},exteriorDoors:{qty:0},blocking2x10:{rows:0}}),[q,D]=(0,a.useState)({}),[W,O]=(0,a.useState)({}),R=(0,a.useCallback)(e=>{let{id:t,lf:l}=e;O(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),z=(0,a.useMemo)(()=>Object.values(W).reduce((e,t)=>e+(Number(t)||0),0),[W]),[_,U]=(0,a.useState)({}),H=(0,a.useCallback)(e=>{let{id:t,len:l}=e;U(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),G=(0,a.useMemo)(()=>{let e=Object.values(_).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[_]);(0,a.useMemo)(()=>{let e=Object.values(q).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[q]);let[V,K]=(0,a.useState)({}),Q=(0,a.useCallback)(e=>{let{id:t,len:l}=e;K(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),$=(0,a.useMemo)(()=>{let e=Object.values(V).filter(Boolean);if(!e.length)return 8;let t={};for(let l of e)t[l]=(t[l]||0)+1;return Number(Object.keys(t).sort((e,l)=>t[l]-t[e]||l-e)[0])},[V]),[J,X]=(0,a.useState)({}),Y=(0,a.useCallback)(e=>{let{id:t,lf:l}=e;X(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),et=(0,a.useMemo)(()=>Object.values(J).reduce((e,t)=>e+(Number(t)||0),0),[J]),[el,en]=(0,a.useState)({}),ea=(0,a.useCallback)(e=>{let{id:t,lf:l}=e;en(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),ei=(0,a.useMemo)(()=>Object.values(el).reduce((e,t)=>e+(Number(t)||0),0),[el]),[es,er]=(0,a.useState)({}),eu=(0,a.useCallback)(e=>{let{id:t,lf:l}=e;er(e=>e[t]===l?e:{...e,[t]:Number(l)||0})},[]),ed=(0,a.useMemo)(()=>Object.values(es).reduce((e,t)=>e+(Number(t)||0),0),[es]),em=(0,a.useMemo)(()=>Object.values(l).reduce((e,t)=>e+(Number(null==t?void 0:t.sheetsExt)||0),0),[l]),eh=(0,a.useMemo)(()=>Object.values(l).reduce((e,t)=>e+(Number(null==t?void 0:t.sheetsBand)||0),0),[l]),ep=(0,a.useMemo)(()=>Object.values(l).reduce((e,t)=>e+(Number(null==t?void 0:t.sheetsExtra)||0),0),[l]),eb=(0,a.useMemo)(()=>Object.values(l).reduce((e,t)=>e+(Number(null==t?void 0:t.platePiecesTotal)||0),0),[l]),ex=(0,a.useMemo)(()=>Object.values(l).reduce((e,t)=>e+(Number(null==t?void 0:t.ptPieces)||0),0),[l]),eg=(0,a.useMemo)(()=>({panelsAll:Number(u||0),platePiecesAll:eb,ptPiecesAll:ex,sheetsExtAll:em,sheetsBandAll:eh,sheetsExtraAll:ep}),[u,eb,em,eh,ep,ex]);return(0,n.jsxs)("div",{className:"app-content",children:[(0,n.jsxs)("div",{className:"ew-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)("h1",{className:"ew-h2 nova-flat-turquoise",style:{margin:0,flexShrink:0},children:"Wall Panels"}),(0,n.jsxs)("div",{className:"ew-right nova-flat-turquoise",style:{fontSize:"1.25rem"},title:"Sum of all levels (panels + loose)",children:["Grand total: ",E.format(Number(T)||0)]})]}),w.map((e,t)=>(0,n.jsx)(Z,{id:e.id,name:e.name||"Level ".concat(t+1),onRemove:w.length>1?()=>F(e.id):void 0,onLooseTotal:C,onLevelTotal:B,onExteriorLF:b,onExteriorPanelLenChange:N,onInteriorShearLF:R,onInteriorShearPanelLenChange:H,onInteriorBearingLF:Y,onInteriorBearingPanelLenChange:Q,onInteriorNonLoadLF:ea,onKneeWallLF:eu,levelsCount:w.length,panelsTotalAllSections:u,onLooseGeneralChange:r},e.id)),(0,n.jsxs)("div",{className:"ew-card",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)("div",{className:"ew-subtle",children:"Add another floor (mirrors functionality; you can input different quantities)"}),(0,n.jsx)(d,{onClick:L,title:"Add wall",label:"Add wall"})]}),(0,n.jsx)("div",{children:(0,n.jsx)(eo,{title:"General — Nails & Bracing (all levels)",totals:eg})}),(0,n.jsx)(ee,{rows:A,panelLenFt:8,panelLenFtExterior:y,panelLenFtInterior:G,exteriorLF:x,interiorShearLF:z,onInteriorBearingLF:Y,interiorBlockingLF:et,interiorNonLoadLF:ei,kneeWallLF:ed,onTotalChange:e=>{let{total:t,panels:l}=e;c(Number(t)||0),m(Number(l)||0)},panelLenFtInteriorBlocking:$})]})}let ed="summary:project";function em(e){let{grandTotal:t=0}=e,[l,i]=(0,a.useState)({projectName:"",address:"",drawingsDate:"",estimateDate:""});(0,a.useEffect)(()=>{try{let e=localStorage.getItem(ed);e&&i(JSON.parse(e))}catch(e){}},[]),(0,a.useEffect)(()=>{if(!l.estimateDate){let e=new Date,t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())).toISOString().slice(0,10);i(e=>({...e,estimateDate:t}))}},[l.estimateDate]),(0,a.useEffect)(()=>{try{localStorage.setItem(ed,JSON.stringify(l))}catch(e){}},[l]);let s=(0,a.useMemo)(()=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",currencyDisplay:"narrowSymbol"}),[]),r=e=>i(t=>({...t,[e.target.name]:e.target.value}));return(0,n.jsxs)("section",{className:"card",children:[(0,n.jsx)("h2",{className:"card-title",children:"Summary"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,n.jsxs)("label",{className:"fld",children:[(0,n.jsx)("span",{children:"Project name"}),(0,n.jsx)("input",{name:"projectName",value:l.projectName,onChange:r})]}),(0,n.jsxs)("label",{className:"fld",children:[(0,n.jsx)("span",{children:"Address"}),(0,n.jsx)("input",{name:"address",value:l.address,onChange:r})]}),(0,n.jsxs)("label",{className:"fld",children:[(0,n.jsx)("span",{children:"Drawings date"}),(0,n.jsx)("input",{type:"date",name:"drawingsDate",value:l.drawingsDate,onChange:r})]}),(0,n.jsxs)("label",{className:"fld",children:[(0,n.jsx)("span",{children:"Estimate date"}),(0,n.jsx)("input",{type:"date",name:"estimateDate",value:l.estimateDate,onChange:r})]})]}),(0,n.jsxs)("div",{className:"sum-row",children:[(0,n.jsx)("div",{className:"sum-label",children:"Wall panels grand total"}),(0,n.jsx)("div",{className:"sum-value",children:s.format(Number(t||0))})]})]})}function eh(){let{projectsList:e,fetchProjectsList:t,createNewProject:l,loadProject:i,isListLoading:r,isSaving:o,appId:c,projectId:u}=(0,s.B)(),[d,m]=(0,a.useState)(""),h=c&&"default-app-id"!==c;(0,a.useEffect)(()=>{},[t,r,h]);let p=async e=>{if(e.preventDefault(),!d.trim()||o||!h)return;let t=await l(d);t?(m(""),i(t),console.log("Created and loading project:",t)):console.error("Failed to create project")},b=e=>{e!==u&&h&&(console.log("Load project clicked:",e),i(e))};return(0,n.jsxs)("div",{className:"app-content",children:[(0,n.jsx)("div",{className:"ew-card",children:(0,n.jsx)("h2",{className:"ew-h2 nova-flat-turquoise",style:{margin:0},children:"Projects Management"})}),(0,n.jsxs)("div",{className:"ew-card",children:[(0,n.jsx)("h3",{className:"ew-h3",children:"Create New Project"}),(0,n.jsxs)("form",{onSubmit:p,className:"ew-inline",style:{alignItems:"stretch",gap:"8px"},children:[(0,n.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"New project name...",className:"ew-input",style:{flexGrow:1},disabled:o||!h,"aria-label":"New project name"}),(0,n.jsxs)("button",{type:"submit",className:"ew-btn ew-btn--turq",disabled:!d.trim()||o||!h,children:[" ",o?"Creating...":"Create Project"]})]}),!h&&(0,n.jsx)("p",{className:"ew-subtle",style:{color:"orange",marginTop:"8px"},children:"Waiting for App ID configuration..."})]}),(0,n.jsxs)("div",{className:"ew-card",children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[(0,n.jsx)("h3",{className:"ew-h3",style:{margin:0},children:"Existing Projects"}),(0,n.jsxs)("button",{onClick:t,className:"ew-btn",style:{padding:"4px 8px"},disabled:r||!h,children:[" ",r?"Refreshing...":"Refresh"]})]}),h?r&&0===e.length?(0,n.jsx)("p",{className:"ew-subtle",children:"Loading projects..."}):0===e.length?(0,n.jsx)("p",{className:"ew-subtle",children:"No projects found. Create one above."}):(0,n.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:e.map(e=>(0,n.jsx)("li",{style:{marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid var(--border-color)"},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"10px"},children:[(0,n.jsxs)("div",{style:{flexGrow:1,overflow:"hidden"},children:[(0,n.jsxs)("button",{onClick:()=>b(e.id),style:{background:"none",border:"none",padding:0,margin:0,color:e.id===u?"var(--text-primary)":"var(--text-accent)",textAlign:"left",cursor:"pointer",fontWeight:e.id===u?"bold":"normal",fontSize:"1em",fontFamily:"inherit",textDecoration:"underline"},title:"Load project: ".concat(e.name),disabled:!h,children:[e.name," ",e.id===u?"(Loaded)":""]}),(0,n.jsxs)("div",{className:"ew-subtle",style:{fontSize:"11px",marginTop:"2px",whiteSpace:"nowrap"},children:["Last updated: ",e.updatedAt?e.updatedAt.toLocaleString():"N/A"]})]}),(0,n.jsx)("button",{onClick:()=>b(e.id),className:"ew-btn",disabled:e.id===u||!h,style:{flexShrink:0},children:e.id===u?"Currently Loaded":"Load Project"})]})},e.id))}):(0,n.jsx)("p",{className:"ew-subtle",children:"App configuration loading..."})]})]})}function ep(){let{signIn:e,loading:t}=(0,r.A)();return(0,n.jsx)("div",{className:"app-content",children:(0,n.jsxs)("div",{className:"ew-card",style:{maxWidth:"400px",margin:"auto",textAlign:"center",marginTop:"50px"},children:[(0,n.jsx)("h2",{className:"ew-h2 nova-flat-turquoise",children:"Welcome to the Inventory Estimator"}),(0,n.jsx)("p",{className:"ew-subtle",style:{margin:"15px 0"},children:"Please sign in with your Google account to create and manage your project estimates."}),(0,n.jsxs)("button",{onClick:e,className:"ew-btn ew-btn--turq",disabled:t,style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"10px 15px",fontSize:"1em"},children:[(0,n.jsx)("img",{src:"/icons/google.png",alt:"",width:18,height:18}),"Sign in with Google"]})]})})}function eb(){let[e,t]=(0,i.g)("inv:v1:ui",{collapsed:!1,active:"project",currentProjectId:null}),{collapsed:l,active:o,currentProjectId:u}=e,{user:d,loading:m}=(0,r.A)(),h=(0,a.useRef)(d),[p,b]=(0,a.useState)(0),x=(0,a.useCallback)(e=>{t(t=>({...t,active:e}))},[t]);(0,a.useEffect)(()=>{!h.current&&d&&(console.log("User logged in, switching to Project view."),x("project")),h.current=d},[d,x]);let g=(0,a.useCallback)(e=>{t(t=>({...t,collapsed:!!e}))},[t]);(0,a.useCallback)(e=>{t(t=>({...t,currentProjectId:e}))},[t]);let v=(0,a.useMemo)(()=>{if(m)return(0,n.jsx)("div",{className:"app-content",children:(0,n.jsx)("div",{className:"ew-card",children:"Loading Authentication..."})});if(!d)return(0,n.jsx)(ep,{});switch(o){case"project":return(0,n.jsx)(eh,{});case"summary":return(0,n.jsx)("div",{className:"app-content",children:(0,n.jsx)(em,{grandTotal:p})});case"wallpanels":return(0,n.jsx)(eu,{onGrandTotal:b});default:return(0,n.jsx)("div",{className:"app-content",children:(0,n.jsxs)("div",{className:"ew-card",children:[(0,n.jsx)("h2",{className:"ew-h2",style:{marginTop:0},children:{auth:"Login / Logout",trusses:"Trusses",loose:"Loose Material",labor:"Labor",takeoff:"Takeoff list",quote:"Quote (QuickBooks)",export:"Export"}[o]||"Section"}),(0,n.jsx)("div",{className:"ew-subtle",children:"Coming soon…"})]})})}},[o,p,u,d,m]);return(0,n.jsx)(s.ProjectProvider,{initialProjectId:u,children:(0,n.jsxs)("div",{className:"app-shell ".concat(l?"sb-collapsed":""),children:[(0,n.jsx)(c,{active:o,collapsed:l,onChange:x,onCollapsedChange:g}),(0,n.jsx)("main",{className:"app-main",children:v})]})})}},8723:(e,t,l)=>{Promise.resolve().then(l.bind(l,7502))}},e=>{e.O(0,[135,965,240,194,441,255,358],()=>e(e.s=8723)),_N_E=e.O()}]);